
<!DOCTYPE html>


<html lang="en" data-content_root="../../../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />
    <link href="../../../../_static/favicon-16x16.png" sizes="16x16" rel="icon" type="image/png">
    <link href="../../../../_static/favicon-124x124.png" sizes="124x124" rel="icon" type="image/png">
    <link href="../../../../_static/favicon-128x128.png" sizes="128x128" rel="icon" type="image/png">
    <link href="../../../../_static/favicon-192x192.png" sizes="192x192" rel="icon" type="image/png">
    <link href="../../../../_static/icon.svg" rel="icon" type="image/svg+xml">
    <title>Get distances &#8212; MolSysMT 0.9.8 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../../_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="../../../../_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../../../../_static/pygments.css?v=b86133f3" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/sphinx_tabs.css?v=f45e19d3" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/custom.css?v=d5ef24d1" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/tabs.css?v=a5c4661c" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/custom.css?v=d5ef24d1" />
  
  <!-- So that users can add custom icons -->
  <script src="../../../../_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="../../../../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="../../../../_static/documentation_options.js?v=1a282f62"></script>
    <script src="../../../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../../../_static/copybutton.js?v=f281be69"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/nglview-js-widgets@3.1.0/dist/index.js"></script>
    <script src="../../../../_static/design-tabs.js?v=f930bc37"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script type="application/vnd.jupyter.widget-state+json">{"state": {"b5a342cb77f74b399095692973d6cdd8": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "858eaf72838943a0b01e597c5f608b0e": {"model_name": "ColormakerRegistryModel", "model_module": "nglview-js-widgets", "model_module_version": "3.1.4", "state": {"_dom_classes": [], "_model_module": "nglview-js-widgets", "_model_module_version": "3.1.4", "_model_name": "ColormakerRegistryModel", "_msg_ar": [], "_msg_q": [], "_ready": false, "_view_count": null, "_view_module": "nglview-js-widgets", "_view_module_version": "3.1.4", "_view_name": "ColormakerRegistryView", "layout": "IPY_MODEL_b5a342cb77f74b399095692973d6cdd8", "tabbable": null, "tooltip": null}}}, "version_major": 2, "version_minor": 0}</script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script crossorigin="anonymous" data-jupyter-widgets-cdn="https://cdn.jsdelivr.net/npm/" src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@1.0.6/dist/embed-amd.js"></script>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
    <link rel="next" title="Get least RMSD" href="get_least_rmsd.html" />
    <link rel="prev" title="Get dihedral angles" href="get_dihedral_angles.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="0.9.8" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../../../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="../../../../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../../../_static/logo.svg" class="logo__image only-light" alt="MolSysMT 0.9.8 documentation - Home"/>
    <img src="../../../../_static/logo.svg" class="logo__image only-dark pst-js-only" alt="MolSysMT 0.9.8 documentation - Home"/>
  
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../about/index.html">
    About
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../showcase/index.html">
    Showcase
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="../../index.html">
    User guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../developer/index.html">
    Developer guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../../api/index.html">
    API documentation
  </a>
</li>

  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
        </div>
      
      
        <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/uibcdf/MolSysMT" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../about/index.html">
    About
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../showcase/index.html">
    Showcase
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="../../index.html">
    User guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../developer/index.html">
    Developer guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../../../api/index.html">
    API documentation
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/uibcdf/MolSysMT" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="current nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../intro/index.html"><strong>Introduction</strong></a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../intro/molsysmt.html">What’s MolSysMT?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../intro/installation.html">Installation</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../intro/molecular_systems/index.html">Molecular systems</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../intro/molecular_systems/description.html">Description</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../intro/molecular_systems/items.html">Items and forms</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../intro/molecular_systems/forms.html">Forms</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../intro/molecular_systems/elements.html">Elements</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../intro/molecular_systems/attributes.html">Attributes</a></li>
</ul>
</details></li>
<li class="toctree-l2"><a class="reference internal" href="../../intro/demo_systems.html">Demo systems</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../intro/native_forms/index.html">Native forms</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../intro/native_forms/file_h5msm.html">file:h5msm</a></li>
</ul>
</details></li>
<li class="toctree-l2"><a class="reference internal" href="../../intro/selection_syntaxes.html">Selection syntaxes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../intro/tools.html">Tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../intro/viewers.html">Viewers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../intro/supported.html">Supported</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../intro/memory_management.html">Memory management</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../intro/quantities_and_units.html">Quantities and units</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../intro/configuration_options.html">Configuration options</a></li>
</ul>
</details></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../index.html"><strong>Tools</strong></a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2 has-children"><a class="reference internal" href="../basic/index.html">Basic</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../basic/add.html">Add</a></li>
<li class="toctree-l3"><a class="reference internal" href="../basic/append_structures.html">Append structures</a></li>
<li class="toctree-l3"><a class="reference internal" href="../basic/are_multiple_molecular_systems.html">Are multiple molecular systems</a></li>
<li class="toctree-l3"><a class="reference internal" href="../basic/compare.html">Compare</a></li>
<li class="toctree-l3"><a class="reference internal" href="../basic/concatenate_structures.html">Concatenate structures</a></li>
<li class="toctree-l3"><a class="reference internal" href="../basic/contains.html">Contains</a></li>
<li class="toctree-l3"><a class="reference internal" href="../basic/convert.html">Convert</a></li>
<li class="toctree-l3"><a class="reference internal" href="../basic/copy.html">Copy</a></li>
<li class="toctree-l3"><a class="reference internal" href="../basic/extract.html">Extract</a></li>
<li class="toctree-l3"><a class="reference internal" href="../basic/get_attributes.html">Get attributes</a></li>
<li class="toctree-l3"><a class="reference internal" href="../basic/get_form.html">Get form</a></li>
<li class="toctree-l3"><a class="reference internal" href="../basic/get_label.html">Get label</a></li>
<li class="toctree-l3"><a class="reference internal" href="../basic/get.html">Get</a></li>
<li class="toctree-l3"><a class="reference internal" href="../basic/has_attribute.html">Has attribute</a></li>
<li class="toctree-l3"><a class="reference internal" href="../basic/info.html">Info</a></li>
<li class="toctree-l3"><a class="reference internal" href="../basic/is_a_molecular_system.html">Is a molecular system</a></li>
<li class="toctree-l3"><a class="reference internal" href="../basic/is_composed_of.html">Is composed of</a></li>
<li class="toctree-l3"><a class="reference internal" href="../basic/iterator.html">Iterator</a></li>
<li class="toctree-l3"><a class="reference internal" href="../basic/merge.html">Merge</a></li>
<li class="toctree-l3"><a class="reference internal" href="../basic/remove.html">Remove</a></li>
<li class="toctree-l3"><a class="reference internal" href="../basic/select.html">Select</a></li>
<li class="toctree-l3"><a class="reference internal" href="../basic/set.html">Set</a></li>
<li class="toctree-l3"><a class="reference internal" href="../basic/view.html">View</a></li>
<li class="toctree-l3"><a class="reference internal" href="../basic/where_is_attribute.html">Where is attribute</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../build/index.html">Build</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../build/add_missing_bonds.html">Add missing bonds</a></li>
<li class="toctree-l3"><a class="reference internal" href="../build/add_missing_heavy_atoms.html">Add missing heavy atoms</a></li>
<li class="toctree-l3"><a class="reference internal" href="../build/add_missing_hydrogens.html">Add missing hydrogens</a></li>
<li class="toctree-l3"><a class="reference internal" href="../build/add_missing_terminal_cappings.html">Add missing terminal cappings</a></li>
<li class="toctree-l3"><a class="reference internal" href="../build/build_peptide.html">Build peptide</a></li>
<li class="toctree-l3"><a class="reference internal" href="../build/define_new_chain.html">Define new chain</a></li>
<li class="toctree-l3"><a class="reference internal" href="../build/get_disulfide_bonds.html">Get disulfide bonds</a></li>
<li class="toctree-l3"><a class="reference internal" href="../build/get_missing_bonds.html">Get missing bonds</a></li>
<li class="toctree-l3"><a class="reference internal" href="../build/get_missing_heavy_atoms.html">Get missing heavy atoms</a></li>
<li class="toctree-l3"><a class="reference internal" href="../build/get_missing_residues.html">Get missing residues</a></li>
<li class="toctree-l3"><a class="reference internal" href="../build/get_missing_terminal_cappings.html">Get missing terminals</a></li>
<li class="toctree-l3"><a class="reference internal" href="../build/get_non_standard_residues.html">Get non standard residues</a></li>
<li class="toctree-l3"><a class="reference internal" href="../build/is_solvated.html">Is solvated</a></li>
<li class="toctree-l3"><a class="reference internal" href="../build/make_bioassembly.html">Make bioassembly</a></li>
<li class="toctree-l3"><a class="reference internal" href="../build/make_water_box.html">Make water box</a></li>
<li class="toctree-l3"><a class="reference internal" href="../build/mutate.html">Mutate</a></li>
<li class="toctree-l3"><a class="reference internal" href="../build/remove_overlapping_molecules.html">Remove overlapping molecules</a></li>
<li class="toctree-l3"><a class="reference internal" href="../build/solvate.html">Solvate</a></li>
<li class="toctree-l3"><a class="reference internal" href="../build/solve_atoms_with_alternate_locations.html">Solve atoms with alternate locations</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../topology/index.html">Topology</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../topology/get_bondgraph.html">Get bondgraph</a></li>
<li class="toctree-l3"><a class="reference internal" href="../topology/get_covalent_blocks.html">Get covalent blocks</a></li>
<li class="toctree-l3"><a class="reference internal" href="../topology/get_covalent_chains.html">Get covalent chains</a></li>
<li class="toctree-l3"><a class="reference internal" href="../topology/get_dihedral_quartets.html">Get dihedral quartets</a></li>
<li class="toctree-l3"><a class="reference internal" href="../topology/get_sequence_alignment.html">Get sequence alignment</a></li>
<li class="toctree-l3"><a class="reference internal" href="../topology/get_sequence_identity.html">Get sequence identity</a></li>
</ul>
</details></li>
<li class="toctree-l2 current active has-children"><a class="reference internal" href="index.html">Structure</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="center.html">Center</a></li>
<li class="toctree-l3"><a class="reference internal" href="flip.html">Flip</a></li>
<li class="toctree-l3"><a class="reference internal" href="get_angles.html">Get angles</a></li>
<li class="toctree-l3"><a class="reference internal" href="get_center.html">Get center</a></li>
<li class="toctree-l3"><a class="reference internal" href="get_contacts.html">Get contacts</a></li>
<li class="toctree-l3"><a class="reference internal" href="get_dihedral_angles.html">Get dihedral angles</a></li>
<li class="toctree-l3 current active"><a class="current reference internal" href="#">Get distances</a></li>
<li class="toctree-l3"><a class="reference internal" href="get_least_rmsd.html">Get least RMSD</a></li>
<li class="toctree-l3"><a class="reference internal" href="get_maximum_distances.html">Get maximum distances</a></li>
<li class="toctree-l3"><a class="reference internal" href="get_minimum_distances.html">Get minimum distances</a></li>
<li class="toctree-l3"><a class="reference internal" href="get_neighbors.html">Get neighbors</a></li>
<li class="toctree-l3"><a class="reference internal" href="get_principal_axes.html">Get geometric axis</a></li>
<li class="toctree-l3"><a class="reference internal" href="get_radius_of_gyration.html">Get radius of gyration</a></li>
<li class="toctree-l3"><a class="reference internal" href="get_rmsd.html">Get RMSD</a></li>
<li class="toctree-l3"><a class="reference internal" href="least_rmsd_align.html">Least RMSD align</a></li>
<li class="toctree-l3"><a class="reference internal" href="least_rmsd_fit.html">Least RMSD fit</a></li>
<li class="toctree-l3"><a class="reference internal" href="move_away.html">Move away</a></li>
<li class="toctree-l3"><a class="reference internal" href="principal_component_analysis.html">Principal component analysis</a></li>
<li class="toctree-l3"><a class="reference internal" href="rotate.html">Rotate</a></li>
<li class="toctree-l3"><a class="reference internal" href="set_dihedral_angles.html">Set dihedral angles</a></li>
<li class="toctree-l3"><a class="reference internal" href="shift_dihedral_angles.html">Shift dihedral angles</a></li>
<li class="toctree-l3"><a class="reference internal" href="show_contacts.html">Show contacts</a></li>
<li class="toctree-l3"><a class="reference internal" href="translate.html">Translate</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../pbc/index.html">Periodic boundary conditions</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../pbc/get_angles_from_box.html">Get angles from vectors</a></li>
<li class="toctree-l3"><a class="reference internal" href="../pbc/get_box_from_lengths_and_angles.html">Get boxfrom lengths and angles</a></li>
<li class="toctree-l3"><a class="reference internal" href="../pbc/get_lengths_and_angles_from_box.html">Get lengths and angles from box</a></li>
<li class="toctree-l3"><a class="reference internal" href="../pbc/get_lengths_from_box.html">Get lengths from box</a></li>
<li class="toctree-l3"><a class="reference internal" href="../pbc/get_shape_from_box.html">Get shape from box</a></li>
<li class="toctree-l3"><a class="reference internal" href="../pbc/get_shape_from_angles.html">Shape from angles</a></li>
<li class="toctree-l3"><a class="reference internal" href="../pbc/get_volume_from_box.html">Angles from vectors</a></li>
<li class="toctree-l3"><a class="reference internal" href="../pbc/get_volume_from_lengths_and_angles.html">Get volume from box</a></li>
<li class="toctree-l3"><a class="reference internal" href="../pbc/has_pbc.html">Has PBC</a></li>
<li class="toctree-l3"><a class="reference internal" href="../pbc/unwrap.html">Unwrap</a></li>
<li class="toctree-l3"><a class="reference internal" href="../pbc/wrap_to_mic.html">Wrap to MIC</a></li>
<li class="toctree-l3"><a class="reference internal" href="../pbc/wrap_to_pbc.html">Wrap to PBC</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../physchem/index.html">Physical and chemical properties</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../physchem/get_area_buried.html">Get area buried</a></li>
<li class="toctree-l3"><a class="reference internal" href="../physchem/get_atomic_radius.html">Get atomic radius</a></li>
<li class="toctree-l3"><a class="reference internal" href="../physchem/get_buried_fraction.html">Get buried fraction</a></li>
<li class="toctree-l3"><a class="reference internal" href="../physchem/get_charge.html">Get charge</a></li>
<li class="toctree-l3"><a class="reference internal" href="../physchem/get_hydrophobicity.html">Get hydrophobicity</a></li>
<li class="toctree-l3"><a class="reference internal" href="../physchem/get_mass.html">Get mass</a></li>
<li class="toctree-l3"><a class="reference internal" href="../physchem/get_polarity.html">Get polarity</a></li>
<li class="toctree-l3"><a class="reference internal" href="../physchem/get_sasa.html">Get SASA</a></li>
<li class="toctree-l3"><a class="reference internal" href="../physchem/get_surface_area.html">Get surface area</a></li>
<li class="toctree-l3"><a class="reference internal" href="../physchem/get_transmembrane_tendency.html">Get transmembrane tendency</a></li>
<li class="toctree-l3"><a class="reference internal" href="../physchem/get_volume.html">Get volume</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../molecular_mechanics/index.html">Molecular mechanics</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../molecular_mechanics/get_forces.html">Get forces</a></li>
<li class="toctree-l3"><a class="reference internal" href="../molecular_mechanics/potential_energy_minimization.html">Potential energy minimization</a></li>
<li class="toctree-l3"><a class="reference internal" href="../molecular_mechanics/get_non_bonded_potential_energy.html">Get non bonded potential energy</a></li>
<li class="toctree-l3"><a class="reference internal" href="../molecular_mechanics/get_potential_energy.html">Get potential energy</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../element/index.html">Element</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../element/atom/index.html">Atom</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../element/atom/get_atom_type_from_atom_name.html">Get atom type from atom name</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../element/group/index.html">Molecule</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../element/group/get_bonded_atom_pairs.html">Get bonded atom pairs</a></li>
<li class="toctree-l4"><a class="reference internal" href="../element/group/get_group_type.html">Get group type</a></li>
<li class="toctree-l4"><a class="reference internal" href="../element/group/is_group_type.html">Is group type</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../element/component/index.html">Component</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../element/component/get_component_id.html">Get component id</a></li>
<li class="toctree-l4"><a class="reference internal" href="../element/component/get_component_index.html">Get component index</a></li>
<li class="toctree-l4"><a class="reference internal" href="../element/component/get_component_name.html">Get component name</a></li>
<li class="toctree-l4"><a class="reference internal" href="../element/component/get_component_type.html">Get component type</a></li>
<li class="toctree-l4"><a class="reference internal" href="../element/component/get_n_components.html">Get number of components</a></li>
<li class="toctree-l4"><a class="reference internal" href="../element/component/is_component_type.html">Is component type</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../element/molecule/index.html">Molecule</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../element/molecule/get_molecule_id.html">Get molecule id</a></li>
<li class="toctree-l4"><a class="reference internal" href="../element/molecule/get_molecule_index.html">Get molecule index</a></li>
<li class="toctree-l4"><a class="reference internal" href="../element/molecule/get_molecule_name.html">Get molecule name</a></li>
<li class="toctree-l4"><a class="reference internal" href="../element/molecule/get_molecule_type.html">Get molecule type</a></li>
<li class="toctree-l4"><a class="reference internal" href="../element/molecule/get_n_molecules.html">Get number of molecules</a></li>
<li class="toctree-l4"><a class="reference internal" href="../element/molecule/is_molecule_type.html">Is component type</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../element/entity/index.html">Entity</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../element/entity/get_entity_id.html">Get entity id</a></li>
<li class="toctree-l4"><a class="reference internal" href="../element/entity/get_entity_index.html">Get entity index</a></li>
<li class="toctree-l4"><a class="reference internal" href="../element/entity/get_entity_name.html">Get entity name</a></li>
<li class="toctree-l4"><a class="reference internal" href="../element/entity/get_entity_type.html">Get entity type</a></li>
<li class="toctree-l4"><a class="reference internal" href="../element/entity/get_n_entities.html">Get number of components</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../element/chain/index.html">Chain</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../element/chain/get_chain_type.html">Get chain type</a></li>
</ul>
</details></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../form/index.html">Form</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../form/get_attributes.html">Get attributes</a></li>
<li class="toctree-l3"><a class="reference internal" href="../form/has_attribute.html">Has attribute</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../thirds/index.html">Thirds</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../thirds/nglview/index.html">NGLView</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../thirds/nglview/add_arrows.html">Add arrows</a></li>
<li class="toctree-l4"><a class="reference internal" href="../thirds/nglview/add_contacts.html">Add contacts</a></li>
<li class="toctree-l4"><a class="reference internal" href="../thirds/nglview/add_cylinders.html">Add cylinders</a></li>
<li class="toctree-l4"><a class="reference internal" href="../thirds/nglview/add_hbonds.html">Add hbonds</a></li>
</ul>
</details></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../thirds/openmm/index.html">OpenMM</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../thirds/openmm/forces/index.html">Custom External Forces</a></li>
<li class="toctree-l4"><a class="reference internal" href="../thirds/openmm/reporters/index.html">Reporters</a></li>
</ul>
</details></li>
</ul>
</details></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../cookbook/index.html"><strong>Cookbook</strong></a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../cookbook/Barnase_Barstar.html">Barnase-Barstar</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../cookbook/OpenMM.html">Working with OpenMM</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../cookbook/NGLView.html">Working with NGLView</a></li>
</ul>
</details></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">

<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../../../../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="../../index.html" class="nav-link">User guide</a></li>
    
    
    <li class="breadcrumb-item"><a href="../index.html" class="nav-link"><strong>Tools</strong></a></li>
    
    
    <li class="breadcrumb-item"><a href="index.html" class="nav-link">Structure</a></li>
    
    <li class="breadcrumb-item active" aria-current="page"><span class="ellipsis">Get distances</span></li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <div class="cell tag_remove-input docutils container">
</div>
<section class="tex2jax_ignore mathjax_ignore" id="get-distances">
<span id="userguide-tools-structure-getdistances"></span><h1>Get distances<a class="headerlink" href="#get-distances" title="Link to this heading">#</a></h1>
<p>MolSysMT includes a very versatile function to calculate distances between atoms of molecular systems, and/or centers of groups of atoms, and/or points in the coordinates space. The <a class="reference internal" href="../../../../molsysmt.structure.html#module-molsysmt.structure.get_distances" title="molsysmt.structure.get_distances"><code class="xref py py-func docutils literal notranslate"><span class="pre">molsysmt.structure.get_distances()</span></code></a> has many possibilities, that’s why one of the longest sections in MolSysMT documentation. But let’s go step by step.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">molsysmt</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">msm</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">molsysmt</span><span class="w"> </span><span class="kn">import</span> <span class="n">pyunitwizard</span> <span class="k">as</span> <span class="n">puw</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"version_major": 2, "version_minor": 0, "model_id": "858eaf72838943a0b01e597c5f608b0e"}</script></div>
</div>
<section id="the-xyz-molecular-system-form">
<h2>The XYZ molecular system form<a class="headerlink" href="#the-xyz-molecular-system-form" title="Link to this heading">#</a></h2>
<p>The first case, and the most simple one, is getting distances from a points distribution in space. MolSysMT accepts a molecular system form where only spatial coordinates are described, with out topological information: the <code class="docutils literal notranslate"><span class="pre">XYZ</span></code> form.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">molecular_system</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="mi">6</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span> <span class="o">*</span> <span class="n">puw</span><span class="o">.</span><span class="n">unit</span><span class="p">(</span><span class="s1">&#39;nm&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">msm</span><span class="o">.</span><span class="n">get_form</span><span class="p">(</span><span class="n">molecular_system</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;XYZ&#39;
</pre></div>
</div>
</div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">XYZ</span></code> form accepts numpy arrays with length units of the shape <span class="math notranslate nohighlight">\([n\_structures, n\_atoms, 3]\)</span> or <span class="math notranslate nohighlight">\([n\_atoms, 3]\)</span>. In case of having an array of rank 2, MolSysMT always understands <span class="math notranslate nohighlight">\(n\_structures=1\)</span> and the first rank as the number of atoms:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">msm</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">molecular_system</span><span class="p">,</span> <span class="n">n_structures</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">n_atoms</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1, 6]
</pre></div>
</div>
</div>
</div>
<p>Lets create a couple of <code class="docutils literal notranslate"><span class="pre">XYZ</span></code> molecular systems with more than a frame. These two systems will help us illustrate the firts distance calculations:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Molecular system with three atoms and three structures.</span>

<span class="n">molecular_system</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;float64&#39;</span><span class="p">)</span> <span class="o">*</span> <span class="n">puw</span><span class="o">.</span><span class="n">unit</span><span class="p">(</span><span class="s1">&#39;nm&#39;</span><span class="p">)</span>

<span class="c1">## First atom</span>
<span class="n">molecular_system</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,:]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">puw</span><span class="o">.</span><span class="n">unit</span><span class="p">(</span><span class="s1">&#39;nm&#39;</span><span class="p">)</span>
<span class="n">molecular_system</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,:]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">puw</span><span class="o">.</span><span class="n">unit</span><span class="p">(</span><span class="s1">&#39;nm&#39;</span><span class="p">)</span>
<span class="n">molecular_system</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,:]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">puw</span><span class="o">.</span><span class="n">unit</span><span class="p">(</span><span class="s1">&#39;nm&#39;</span><span class="p">)</span>

<span class="c1">## Second atom</span>
<span class="n">molecular_system</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,:]</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">puw</span><span class="o">.</span><span class="n">unit</span><span class="p">(</span><span class="s1">&#39;nm&#39;</span><span class="p">)</span>
<span class="n">molecular_system</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,:]</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">puw</span><span class="o">.</span><span class="n">unit</span><span class="p">(</span><span class="s1">&#39;nm&#39;</span><span class="p">)</span>
<span class="n">molecular_system</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,:]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">puw</span><span class="o">.</span><span class="n">unit</span><span class="p">(</span><span class="s1">&#39;nm&#39;</span><span class="p">)</span>

<span class="c1">## Third atom</span>
<span class="n">molecular_system</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,:]</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">puw</span><span class="o">.</span><span class="n">unit</span><span class="p">(</span><span class="s1">&#39;nm&#39;</span><span class="p">)</span>
<span class="n">molecular_system</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,:]</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">puw</span><span class="o">.</span><span class="n">unit</span><span class="p">(</span><span class="s1">&#39;nm&#39;</span><span class="p">)</span>
<span class="n">molecular_system</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,:]</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">puw</span><span class="o">.</span><span class="n">unit</span><span class="p">(</span><span class="s1">&#39;nm&#39;</span><span class="p">)</span>

<span class="c1">## Fourth atom</span>
<span class="n">molecular_system</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">,:]</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="o">*</span> <span class="n">puw</span><span class="o">.</span><span class="n">unit</span><span class="p">(</span><span class="s1">&#39;nm&#39;</span><span class="p">)</span>
<span class="n">molecular_system</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,:]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">puw</span><span class="o">.</span><span class="n">unit</span><span class="p">(</span><span class="s1">&#39;nm&#39;</span><span class="p">)</span>
<span class="n">molecular_system</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,:]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span> <span class="o">*</span> <span class="n">puw</span><span class="o">.</span><span class="n">unit</span><span class="p">(</span><span class="s1">&#39;nm&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">molecular_system</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table><tbody><tr><th>Magnitude</th><td style='text-align:left;'><pre>[[[0.0 2.0 -1.0]  [-1.0 1.0 1.0]  [-2.0 0.0 1.0]  [-2.0 -2.0 -2.0]] [[1.0 2.0 -1.0]  [-1.0 0.0 1.0]  [-2.0 0.0 0.0]  [0.0 0.0 0.0]] [[0.0 2.0 -1.0]  [0.0 0.0 1.0]  [-1.0 1.0 0.0]  [2.0 2.0 2.0]]]</pre></td></tr><tr><th>Units</th><td style='text-align:left;'>nanometer</td></tr></tbody></table></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">msm</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">molecular_system</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style type="text/css">
</style>
<table id="T_2e994">
  <thead>
    <tr>
      <th id="T_2e994_level0_col0" class="col_heading level0 col0" >form</th>
      <th id="T_2e994_level0_col1" class="col_heading level0 col1" >n_atoms</th>
      <th id="T_2e994_level0_col2" class="col_heading level0 col2" >n_groups</th>
      <th id="T_2e994_level0_col3" class="col_heading level0 col3" >n_components</th>
      <th id="T_2e994_level0_col4" class="col_heading level0 col4" >n_chains</th>
      <th id="T_2e994_level0_col5" class="col_heading level0 col5" >n_molecules</th>
      <th id="T_2e994_level0_col6" class="col_heading level0 col6" >n_entities</th>
      <th id="T_2e994_level0_col7" class="col_heading level0 col7" >n_structures</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td id="T_2e994_row0_col0" class="data row0 col0" >XYZ</td>
      <td id="T_2e994_row0_col1" class="data row0 col1" >4</td>
      <td id="T_2e994_row0_col2" class="data row0 col2" >None</td>
      <td id="T_2e994_row0_col3" class="data row0 col3" >None</td>
      <td id="T_2e994_row0_col4" class="data row0 col4" >None</td>
      <td id="T_2e994_row0_col5" class="data row0 col5" >None</td>
      <td id="T_2e994_row0_col6" class="data row0 col6" >None</td>
      <td id="T_2e994_row0_col7" class="data row0 col7" >3</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
</section>
<section id="distance-between-atoms-in-space">
<h2>Distance between atoms in space<a class="headerlink" href="#distance-between-atoms-in-space" title="Link to this heading">#</a></h2>
<section id="distance-between-atoms-of-a-system">
<h3>Distance between atoms of a system<a class="headerlink" href="#distance-between-atoms-of-a-system" title="Link to this heading">#</a></h3>
<p>The first case shows how to get the distance between all points of a system at every frame</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">distances</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">structure</span><span class="o">.</span><span class="n">get_distances</span><span class="p">(</span><span class="n">molecular_system</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>The result is an array of rank 3. Where the first axe or rank corresponds to the number of structures and the other two, the second and third axe, accounts for the point or atom indices:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">distances</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(3, 4, 4)
</pre></div>
</div>
</div>
</div>
<p>This way every distance between atoms at each frame is stored. Lets print out the distance between the 0-th and the 2-th atom at frame 1-th:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Distance at frame 1-th between atoms 0-th and 2-th: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">distances</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Distance at frame 1-th between atoms 0-th and 2-th: 3.7416573867739413 nanometer
</pre></div>
</div>
</div>
</div>
<p>If only the distance between atoms 0-th and 2-th at every frame is required, there is no need to compute <span class="math notranslate nohighlight">\(n\_atoms x n\_atoms\)</span> distances. The input arguments <code class="docutils literal notranslate"><span class="pre">selection</span></code> and <code class="docutils literal notranslate"><span class="pre">selection_2</span></code> help us to define the range of elements of the output distance matrix:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">distances</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">structure</span><span class="o">.</span><span class="n">get_distances</span><span class="p">(</span><span class="n">molecular_system</span><span class="p">,</span> <span class="n">selection</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">selection_2</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>This time the output is an array of rank 3 with shape <span class="math notranslate nohighlight">\([3,1,1]\)</span>. The distance for just a pair of atoms was computed for three structures:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">distances</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(3, 1, 1)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Distance at frame </span><span class="si">{}</span><span class="s1">-th between atoms 0-th and 2-th: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ii</span><span class="p">,</span><span class="n">distances</span><span class="p">[</span><span class="n">ii</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Distance at frame 0-th between atoms 0-th and 2-th: 3.4641016151377544 nanometer
Distance at frame 1-th between atoms 0-th and 2-th: 3.7416573867739413 nanometer
Distance at frame 2-th between atoms 0-th and 2-th: 1.7320508075688772 nanometer
</pre></div>
</div>
</div>
</div>
<p>Lets try now to get the distance between the atom 1-th and the atoms 0-th and 2-th at every frame:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">distances</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">structure</span><span class="o">.</span><span class="n">get_distances</span><span class="p">(</span><span class="n">molecular_system</span><span class="p">,</span> <span class="n">selection</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">selection_2</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<p>As you will guess, the output matrix is an array of rank three this time with shape <span class="math notranslate nohighlight">\([3,1,2]\)</span>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">distances</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(3, 1, 2)
</pre></div>
</div>
</div>
</div>
<p>If we want now to print out the distance between atoms 1-th and 2-th for frame 0-th:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Distance at frame 0-th between atoms 1-th and 2-th: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">distances</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Distance at frame 0-th between atoms 1-th and 2-th: 1.4142135623730951 nanometer
</pre></div>
</div>
</div>
</div>
<p>The position of each atom in lists <code class="docutils literal notranslate"><span class="pre">selection</span></code> and <code class="docutils literal notranslate"><span class="pre">selection_2</span></code> is used to locate the corresponding distance in the output array. If instead, you want to use the original atom indices to locate a distance, the input argument <code class="docutils literal notranslate"><span class="pre">output_form='dict'</span></code> can help:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">distances</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">structure</span><span class="o">.</span><span class="n">get_distances</span><span class="p">(</span><span class="n">molecular_system</span><span class="p">,</span> <span class="n">selection</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">selection_2</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="n">output_type</span><span class="o">=</span><span class="s1">&#39;dictionary&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>This way the output is no longer a numpy array of rank 3, the output object is now a dictionary of dictionaries of dictionaries. Where the set keys of the first dictionary corresponds to the atom indices of <code class="docutils literal notranslate"><span class="pre">selection_1</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">distances</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{1: {0: &lt;Quantity([2.44948974 3.46410162 2.82842712], &#39;nanometer&#39;)&gt;,
  2: &lt;Quantity([1.41421356 1.41421356 1.73205081], &#39;nanometer&#39;)&gt;}}
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">distances</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>dict_keys([1])
</pre></div>
</div>
</div>
</div>
<p>The second nested dictionary has the atom indices of <code class="docutils literal notranslate"><span class="pre">selection_2</span></code> as keys:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">distances</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>dict_keys([0, 2])
</pre></div>
</div>
</div>
</div>
<p>And the third and last nested dictionary is defined with the frame indices as keys:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">distances</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table><tbody><tr><th>Magnitude</th><td style='text-align:left;'><pre>[1.4142135623730951 1.4142135623730951 1.7320508075688772]</pre></td></tr><tr><th>Units</th><td style='text-align:left;'>nanometer</td></tr></tbody></table></div></div>
</div>
<p>Thus, the distance now between atoms 0-th and 2-th in frame 1-th is:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Distance at frame 0-th between atoms 1-th and 2-th: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">distances</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Distance at frame 0-th between atoms 1-th and 2-th: 1.4142135623730951 nanometer
</pre></div>
</div>
</div>
</div>
<p>Just like <code class="docutils literal notranslate"><span class="pre">selection</span></code> and <code class="docutils literal notranslate"><span class="pre">selection_2</span></code> can limit the range of atom indices of the calculation, <code class="docutils literal notranslate"><span class="pre">structure_indices</span></code> can be used to define the list of structures where the method applies:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">distances</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">structure</span><span class="o">.</span><span class="n">get_distances</span><span class="p">(</span><span class="n">molecular_system</span><span class="p">,</span> <span class="n">selection</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">selection_2</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="n">structure_indices</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Distance at frame 2-th between atoms 1-th and 2-th: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">distances</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Distance at frame 2-th between atoms 1-th and 2-th: 1.7320508075688772 nanometer
</pre></div>
</div>
</div>
</div>
<p>You can check again that with <code class="docutils literal notranslate"><span class="pre">output_form='dictionary'</span></code> the original indics for atoms and structures work to locate a distance:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">distances</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">structure</span><span class="o">.</span><span class="n">get_distances</span><span class="p">(</span><span class="n">molecular_system</span><span class="p">,</span> <span class="n">selection</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">selection_2</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="n">structure_indices</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span>
                                        <span class="n">output_type</span><span class="o">=</span><span class="s1">&#39;dictionary&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">distances</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{0: &lt;Quantity([3.46410162 2.82842712], &#39;nanometer&#39;)&gt;,
 2: &lt;Quantity([1.41421356 1.73205081], &#39;nanometer&#39;)&gt;}
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Distance at frame 2-th between atoms 1-th and 2-th: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">distances</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">][</span><span class="mi">1</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Distance at frame 2-th between atoms 1-th and 2-th: 1.7320508075688772 nanometer
</pre></div>
</div>
</div>
</div>
</section>
<section id="distances-between-atoms-positions-in-different-structures">
<h3>Distances between atoms positions in different structures<a class="headerlink" href="#distances-between-atoms-positions-in-different-structures" title="Link to this heading">#</a></h3>
<p>At the end of last subsection we saw how, in addition to the input arguments <code class="docutils literal notranslate"><span class="pre">selection</span></code> and <code class="docutils literal notranslate"><span class="pre">selection_2</span></code>, the input arguments <code class="docutils literal notranslate"><span class="pre">structure_indices</span></code> and <code class="docutils literal notranslate"><span class="pre">structure_indices_2</span></code> alter the way distances are computed. Lets use the four arguments in the next example to revisit their function:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">distances</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">structure</span><span class="o">.</span><span class="n">get_distances</span><span class="p">(</span><span class="n">molecular_system</span><span class="p">,</span> <span class="n">selection</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="n">structure_indices</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span>
                         <span class="n">selection_2</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">structure_indices_2</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<p>The distance between atoms 1-th and 2-th, and atom 1-th are computed. But, these distances are not between spatial positions in the same frame index. When two frame indices lists are provided by means of <code class="docutils literal notranslate"><span class="pre">structure_indices</span></code> and <code class="docutils literal notranslate"><span class="pre">structure_indices_2</span></code>, pairs of structures are taken sequentially. In this case positions of <code class="docutils literal notranslate"><span class="pre">selection</span></code> at frame 0-th are confronted againts positions of <code class="docutils literal notranslate"><span class="pre">selection_2</span></code> at frame 1-th, and the results are stored in the first frame of the distances output. Then, according to the last cell frame indices, positions of <code class="docutils literal notranslate"><span class="pre">selection</span></code> at frame 1-th are confronted againts positions of <code class="docutils literal notranslate"><span class="pre">selection_2</span></code> at frame 2-th. Thus, lets print out for example the distance between the position of atom 2-th of <code class="docutils literal notranslate"><span class="pre">selection</span></code> in frame 1-th and the position of atom 1-th of <code class="docutils literal notranslate"><span class="pre">selection_2</span></code> in frame 2-th:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The distance between atom 2-th of selection at frame 1-th and atom 1-th of selection_2 at frame 2-th is: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">distances</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The distance between atom 2-th of selection at frame 1-th and atom 1-th of selection_2 at frame 2-th is: 2.23606797749979 nanometer
</pre></div>
</div>
</div>
</div>
<p>In this case, when the output object is a dictionary of dictionaries of dictionaries, the last nested keys correspond to the frame indices in <code class="docutils literal notranslate"><span class="pre">structure_indices</span></code>. Lets compute de same distances as before printing out the same specific distance:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">distances</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">structure</span><span class="o">.</span><span class="n">get_distances</span><span class="p">(</span><span class="n">molecular_system</span><span class="p">,</span> <span class="n">selection</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="n">structure_indices</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span>
                         <span class="n">selection_2</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">structure_indices_2</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="n">output_type</span><span class="o">=</span><span class="s1">&#39;dictionary&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The distance between atom 2-th of selection at frame 1-th and atom 1-th of selection_2 at frame 2-th is: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">distances</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">1</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The distance between atom 2-th of selection at frame 1-th and atom 1-th of selection_2 at frame 2-th is: [1.0 2.23606797749979] nanometer
</pre></div>
</div>
</div>
</div>
<p>The possibility to calculate distances between crossing frame indices opens the door to get displacement lengths as it is shown in next subsection.</p>
</section>
<section id="displacement-distances-of-atoms">
<h3>Displacement distances of atoms<a class="headerlink" href="#displacement-distances-of-atoms" title="Link to this heading">#</a></h3>
<p>When both input arguments <code class="docutils literal notranslate"><span class="pre">structure_indices</span></code> and <code class="docutils literal notranslate"><span class="pre">structure_indices_2</span></code> are used over a unique set of atoms of the same molecular system, the distances computed acquired a simple physical meaning: displacements. Lets see the following case:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">distances</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">structure</span><span class="o">.</span><span class="n">get_distances</span><span class="p">(</span><span class="n">molecular_system</span><span class="p">,</span> <span class="n">selection</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                                        <span class="n">structure_indices</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">structure_indices_2</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<p>The shape of the output object is:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">distances</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(2, 1, 1)
</pre></div>
</div>
</div>
</div>
<p>The length of the distance walked by atom 1-th between structures 0-th and 1-th is:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The displacement length of atom 1-th between structures 0-th and 1th is: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">distances</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The displacement length of atom 1-th between structures 0-th and 1th is: 1.0 nanometer
</pre></div>
</div>
</div>
</div>
<p>While the displacement length of the same atom between the next two consecutive structures is:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The displacement length of atom 1-th between structures 1-th and 2-th is: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">distances</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The displacement length of atom 1-th between structures 1-th and 2-th is: 1.0 nanometer
</pre></div>
</div>
</div>
</div>
<p>If we want to get the length distance an atom moves between a fixed frame, 0-th for instance, and the rest of structures we can invoke the command <code class="docutils literal notranslate"><span class="pre">molsysmt.distance()</span></code> this way:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">distances</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">structure</span><span class="o">.</span><span class="n">get_distances</span><span class="p">(</span><span class="n">molecular_system</span><span class="p">,</span> <span class="n">selection</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">structure_indices</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span>
                                        <span class="n">structure_indices_2</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">output_type</span><span class="o">=</span><span class="s1">&#39;dictionary&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>The displacement length of atom 1-th between its position at frame 0-th and all other structures is:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The displacement length of atom 1-th between structures 0-th and </span><span class="si">{}</span><span class="s1">-th is: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ii</span><span class="p">,</span> <span class="n">distances</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="n">ii</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The displacement length of atom 1-th between structures 0-th and 0-th is: 0.0 nanometer
The displacement length of atom 1-th between structures 0-th and 1-th is: 1.0 nanometer
The displacement length of atom 1-th between structures 0-th and 2-th is: 1.4142135623730951 nanometer
</pre></div>
</div>
</div>
</div>
</section>
<section id="distance-between-atoms-pairs">
<h3>Distance between atoms pairs<a class="headerlink" href="#distance-between-atoms-pairs" title="Link to this heading">#</a></h3>
<p>When the method <code class="docutils literal notranslate"><span class="pre">molsysmt.distance()</span></code> is invoked to calculate the distances between a set of <span class="math notranslate nohighlight">\(N\)</span> atoms of <code class="docutils literal notranslate"><span class="pre">selection</span></code> and a set of <span class="math notranslate nohighlight">\(M\)</span> atoms of <code class="docutils literal notranslate"><span class="pre">selection_2</span></code>, the result is an object, a numpy array or a dictionary, with <span class="math notranslate nohighlight">\(N x M\)</span> distances per frame. Sometimes all these different distances are not needed, but only those between specific atom pairs. These atom pairs can be given by the elements in <code class="docutils literal notranslate"><span class="pre">selection</span></code> and <code class="docutils literal notranslate"><span class="pre">selection_2</span></code> coupled sequantially one to one. This option is activated when the input argument <code class="docutils literal notranslate"><span class="pre">pairs=True</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">distances</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">structure</span><span class="o">.</span><span class="n">get_distances</span><span class="p">(</span><span class="n">molecular_system</span><span class="p">,</span> <span class="n">selection</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">selection_2</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span>
                         <span class="n">structure_indices</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="n">pairs</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>When <code class="docutils literal notranslate"><span class="pre">pairs=True</span></code> the shape of the output numpy array is <span class="math notranslate nohighlight">\([n\_structures, N]\)</span>, where <span class="math notranslate nohighlight">\(N\)</span> is the number of pairs: [0,1], [0,2] and [1,2], in this case.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">distances</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(2, 3)
</pre></div>
</div>
</div>
</div>
<p>Lets print out the distance between atoms 0-th and 2-th in frame 1-th:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The distance between the pair of atoms 0-th and 2-th in frame 1-th: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">distances</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The distance between the pair of atoms 0-th and 2-th in frame 1-th: 3.7416573867739413 nanometer
</pre></div>
</div>
</div>
</div>
<p>The pairs list can also be define using only <code class="docutils literal notranslate"><span class="pre">selection</span></code>, and the result is the same:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">distances</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">structure</span><span class="o">.</span><span class="n">get_distances</span><span class="p">(</span><span class="n">molecular_system</span><span class="p">,</span> <span class="n">selection</span><span class="o">=</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]],</span> <span class="n">structure_indices</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="n">pairs</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The distance between the pair of atoms 0-th and 2-th in frame 1-th: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">distances</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The distance between the pair of atoms 0-th and 2-th in frame 1-th: 3.7416573867739413 nanometer
</pre></div>
</div>
</div>
</div>
<p>The dictionary output form also works for atom pairs in the same way as with <code class="docutils literal notranslate"><span class="pre">pairs=False</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">distances</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">structure</span><span class="o">.</span><span class="n">get_distances</span><span class="p">(</span><span class="n">molecular_system</span><span class="p">,</span> <span class="n">selection</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">selection_2</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span>
                         <span class="n">structure_indices</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="n">pairs</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">output_type</span><span class="o">=</span><span class="s1">&#39;dictionary&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The distance between the pair of atoms 0-th and 2-th in frame 1-th: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">distances</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">][</span><span class="mi">1</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The distance between the pair of atoms 0-th and 2-th in frame 1-th: 1.7320508075688772 nanometer
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="distance-between-atom-groups-in-space">
<h2>Distance between atom groups in space<a class="headerlink" href="#distance-between-atom-groups-in-space" title="Link to this heading">#</a></h2>
<p>Imagine the distance between geometric centers of atoms groups needs to be obtained. There is no reason why MolSysMT should have new functions to do that. Every method introduced in the previous section, about getting distances between atoms, has the possibility to do it over groups of atoms.</p>
<section id="distance-between-atom-groups-of-a-system">
<h3>Distance between atom groups of a system<a class="headerlink" href="#distance-between-atom-groups-of-a-system" title="Link to this heading">#</a></h3>
<p>Lets load a new molecular system to illustrate how <code class="docutils literal notranslate"><span class="pre">molsysmt.distance()</span></code> can get distances between atom groups:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">molecular_system</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span><span class="s1">&#39;1TCD&#39;</span><span class="p">,</span> <span class="s1">&#39;molsysmt.MolSys&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">msm</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">molecular_system</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style type="text/css">
</style>
<table id="T_12898">
  <thead>
    <tr>
      <th id="T_12898_level0_col0" class="col_heading level0 col0" >form</th>
      <th id="T_12898_level0_col1" class="col_heading level0 col1" >n_atoms</th>
      <th id="T_12898_level0_col2" class="col_heading level0 col2" >n_groups</th>
      <th id="T_12898_level0_col3" class="col_heading level0 col3" >n_components</th>
      <th id="T_12898_level0_col4" class="col_heading level0 col4" >n_chains</th>
      <th id="T_12898_level0_col5" class="col_heading level0 col5" >n_molecules</th>
      <th id="T_12898_level0_col6" class="col_heading level0 col6" >n_entities</th>
      <th id="T_12898_level0_col7" class="col_heading level0 col7" >n_waters</th>
      <th id="T_12898_level0_col8" class="col_heading level0 col8" >n_proteins</th>
      <th id="T_12898_level0_col9" class="col_heading level0 col9" >n_structures</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td id="T_12898_row0_col0" class="data row0 col0" >molsysmt.MolSys</td>
      <td id="T_12898_row0_col1" class="data row0 col1" >3983</td>
      <td id="T_12898_row0_col2" class="data row0 col2" >662</td>
      <td id="T_12898_row0_col3" class="data row0 col3" >167</td>
      <td id="T_12898_row0_col4" class="data row0 col4" >4</td>
      <td id="T_12898_row0_col5" class="data row0 col5" >167</td>
      <td id="T_12898_row0_col6" class="data row0 col6" >2</td>
      <td id="T_12898_row0_col7" class="data row0 col7" >165</td>
      <td id="T_12898_row0_col8" class="data row0 col8" >2</td>
      <td id="T_12898_row0_col9" class="data row0 col9" >1</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>Lets revisit how to get the distances between two atoms selections to start with, then the effect of input arguments <code class="docutils literal notranslate"><span class="pre">group_behavior</span></code> and <code class="docutils literal notranslate"><span class="pre">group_behavior_2</span></code> will be shown:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">distances</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">structure</span><span class="o">.</span><span class="n">get_distances</span><span class="p">(</span><span class="n">molecular_system</span><span class="p">,</span> <span class="n">selection</span><span class="o">=</span><span class="s2">&quot;group_index==0&quot;</span><span class="p">,</span> <span class="n">selection_2</span><span class="o">=</span><span class="s2">&quot;group_index==1&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>This molecular system has onle a single frame, so the shape of the output array is <span class="math notranslate nohighlight">\([1, n\_atoms\_1, n\_atoms\_2]\)</span> where <span class="math notranslate nohighlight">\(n\_atoms\_1\)</span> and <span class="math notranslate nohighlight">\(n\_atoms\_2\)</span> is the number of atoms in <code class="docutils literal notranslate"><span class="pre">selection</span></code> and <code class="docutils literal notranslate"><span class="pre">selection_2</span></code>, respectively:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">n_atoms_1</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">molecular_system</span><span class="p">,</span> <span class="n">element</span><span class="o">=</span><span class="s1">&#39;atom&#39;</span><span class="p">,</span> <span class="n">selection</span><span class="o">=</span><span class="s2">&quot;group_index==0&quot;</span><span class="p">,</span> <span class="n">n_atoms</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">n_atoms_2</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">molecular_system</span><span class="p">,</span> <span class="n">element</span><span class="o">=</span><span class="s1">&#39;atom&#39;</span><span class="p">,</span> <span class="n">selection</span><span class="o">=</span><span class="s2">&quot;group_index==1&quot;</span><span class="p">,</span> <span class="n">n_atoms</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">n_atoms_1</span><span class="p">,</span> <span class="n">n_atoms_2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>9 7
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">distances</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(1, 9, 7)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">distances</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">0.5271685214426218 nanometer</div></div>
</div>
<p>Now, lets use <code class="docutils literal notranslate"><span class="pre">group_behavior=&quot;geometric_center&quot;</span></code> to obtain the distance between the geometric center of the set of atoms in <code class="docutils literal notranslate"><span class="pre">selection</span></code> to every atom in <code class="docutils literal notranslate"><span class="pre">selection_2</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">distances</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">structure</span><span class="o">.</span><span class="n">get_distances</span><span class="p">(</span><span class="n">molecular_system</span><span class="p">,</span> <span class="n">selection</span><span class="o">=</span><span class="s2">&quot;group_index==0&quot;</span><span class="p">,</span>
                         <span class="n">center_of_atoms</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>                         
                         <span class="n">selection_2</span><span class="o">=</span><span class="s2">&quot;group_index==1&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">distances</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(1, 1, 7)
</pre></div>
</div>
</div>
</div>
<p>And with <code class="docutils literal notranslate"><span class="pre">group_behavior_2=&quot;geometric_center&quot;</span></code> the distance between both geometric centers can be obtain:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">distances</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">structure</span><span class="o">.</span><span class="n">get_distances</span><span class="p">(</span><span class="n">molecular_system</span><span class="p">,</span> <span class="n">selection</span><span class="o">=</span><span class="s2">&quot;group_index==0&quot;</span><span class="p">,</span> <span class="n">center_of_atoms</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                         <span class="n">selection_2</span><span class="o">=</span><span class="s2">&quot;group_index==1&quot;</span><span class="p">,</span> <span class="n">center_of_atoms_2</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">distances</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(1, 1, 1)
</pre></div>
</div>
</div>
</div>
<p>The input arguments <code class="docutils literal notranslate"><span class="pre">group_behavior</span></code> and <code class="docutils literal notranslate"><span class="pre">group_behavior_2</span></code> allow us to work with a unique position of a group of atoms, either the geometric center or the center of mass. But what happens then if we have several groups of atoms? The arguments <code class="docutils literal notranslate"><span class="pre">selection</span></code> and <code class="docutils literal notranslate"><span class="pre">selection_2</span></code> do work with just a list of atom indices or a selection sentence. Thats why we have to use two new input arguments: <code class="docutils literal notranslate"><span class="pre">groups_of_atoms</span></code> and <code class="docutils literal notranslate"><span class="pre">groups_of_atoms_2</span></code>. Lets define a couple of list of lists of atom indices to illustrate their use.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">list_groups_1</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">molecular_system</span><span class="p">,</span> <span class="n">element</span><span class="o">=</span><span class="s2">&quot;group&quot;</span><span class="p">,</span>
                        <span class="n">selection</span><span class="o">=</span><span class="s2">&quot;group_index in [0,1,2,3]&quot;</span><span class="p">,</span> <span class="n">atom_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">list_groups_2</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">molecular_system</span><span class="p">,</span> <span class="n">element</span><span class="o">=</span><span class="s2">&quot;group&quot;</span><span class="p">,</span>
                        <span class="n">selection</span><span class="o">=</span><span class="s2">&quot;group_index in [4,5,6,7,8]&quot;</span><span class="p">,</span> <span class="n">atom_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">list_groups_1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[0, 1, 2, 3, 4, 5, 6, 7, 8], [9, 10, 11, 12, 13, 14, 15], [16, 17, 18, 19, 20, 21, 22, 23, 24], [25, 26, 27, 28, 29, 30, 31]]
</pre></div>
</div>
</div>
</div>
<p>First, lets compute the distance between every single atom in <code class="docutils literal notranslate"><span class="pre">selection</span></code> to the geometric center of the atoms groups defined in <code class="docutils literal notranslate"><span class="pre">list_groups_2</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">distances</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">structure</span><span class="o">.</span><span class="n">get_distances</span><span class="p">(</span><span class="n">molecular_system</span><span class="p">,</span> <span class="n">selection</span><span class="o">=</span><span class="s2">&quot;group_index==0&quot;</span><span class="p">,</span>
                         <span class="n">selection_2</span><span class="o">=</span><span class="n">list_groups_2</span><span class="p">,</span> <span class="n">center_of_atoms_2</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">distances</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(1, 9, 5)
</pre></div>
</div>
</div>
</div>
<p>Now, the distance between the geometric center of the set of atoms in <code class="docutils literal notranslate"><span class="pre">selection</span></code> and every geometric center of the atoms groups given by <code class="docutils literal notranslate"><span class="pre">list_groups_2</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">distances</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">structure</span><span class="o">.</span><span class="n">get_distances</span><span class="p">(</span><span class="n">molecular_system</span><span class="p">,</span> <span class="n">selection</span><span class="o">=</span><span class="s2">&quot;group_index==0&quot;</span><span class="p">,</span>
                                        <span class="n">center_of_atoms</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">selection_2</span><span class="o">=</span><span class="n">list_groups_2</span><span class="p">,</span>
                                        <span class="n">center_of_atoms_2</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">distances</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(1, 1, 5)
</pre></div>
</div>
</div>
</div>
<p>And finnally, the distance between every geometric center of the atoms groups in <code class="docutils literal notranslate"><span class="pre">list_groups_1</span></code> to every geometric center of the atoms groups defined in <code class="docutils literal notranslate"><span class="pre">list_groups_2</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">distances</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">structure</span><span class="o">.</span><span class="n">get_distances</span><span class="p">(</span><span class="n">molecular_system</span><span class="p">,</span> <span class="n">selection</span><span class="o">=</span><span class="n">list_groups_1</span><span class="p">,</span> <span class="n">center_of_atoms</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                        <span class="n">selection_2</span><span class="o">=</span><span class="n">list_groups_2</span><span class="p">,</span> <span class="n">center_of_atoms_2</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">distances</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(1, 4, 5)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">distances</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">1.2406698330486778 nanometer</div></div>
</div>
<p>Just like with atoms, if only a list of atoms groups is used, the distance between its centers is obtained:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">distances</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">structure</span><span class="o">.</span><span class="n">get_distances</span><span class="p">(</span><span class="n">molecular_system</span><span class="p">,</span> <span class="n">selection</span><span class="o">=</span><span class="n">list_groups_1</span><span class="p">,</span> <span class="n">center_of_atoms</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">distances</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(1, 4, 4)
</pre></div>
</div>
</div>
</div>
<p>Finnally, lets proof that the distance between groups can be computed all along a trajectory as well as only at specific structures. Lets load the whole trajectory ‘pentalanine.h5’:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">molecular_system</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">systems</span><span class="p">[</span><span class="s1">&#39;pentalanine&#39;</span><span class="p">][</span><span class="s1">&#39;traj_pentalanine.h5&#39;</span><span class="p">]</span>
<span class="n">molecular_system</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span><span class="n">molecular_system</span><span class="p">,</span> <span class="n">to_form</span><span class="o">=</span><span class="s1">&#39;molsysmt.MolSys&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">msm</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">molecular_system</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style type="text/css">
</style>
<table id="T_3e83d">
  <thead>
    <tr>
      <th id="T_3e83d_level0_col0" class="col_heading level0 col0" >form</th>
      <th id="T_3e83d_level0_col1" class="col_heading level0 col1" >n_atoms</th>
      <th id="T_3e83d_level0_col2" class="col_heading level0 col2" >n_groups</th>
      <th id="T_3e83d_level0_col3" class="col_heading level0 col3" >n_components</th>
      <th id="T_3e83d_level0_col4" class="col_heading level0 col4" >n_chains</th>
      <th id="T_3e83d_level0_col5" class="col_heading level0 col5" >n_molecules</th>
      <th id="T_3e83d_level0_col6" class="col_heading level0 col6" >n_entities</th>
      <th id="T_3e83d_level0_col7" class="col_heading level0 col7" >n_peptides</th>
      <th id="T_3e83d_level0_col8" class="col_heading level0 col8" >n_structures</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td id="T_3e83d_row0_col0" class="data row0 col0" >molsysmt.MolSys</td>
      <td id="T_3e83d_row0_col1" class="data row0 col1" >62</td>
      <td id="T_3e83d_row0_col2" class="data row0 col2" >7</td>
      <td id="T_3e83d_row0_col3" class="data row0 col3" >1</td>
      <td id="T_3e83d_row0_col4" class="data row0 col4" >1</td>
      <td id="T_3e83d_row0_col5" class="data row0 col5" >1</td>
      <td id="T_3e83d_row0_col6" class="data row0 col6" >1</td>
      <td id="T_3e83d_row0_col7" class="data row0 col7" >1</td>
      <td id="T_3e83d_row0_col8" class="data row0 col8" >5000</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">msm</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">molecular_system</span><span class="p">,</span> <span class="n">element</span><span class="o">=</span><span class="s1">&#39;group&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style type="text/css">
</style>
<table id="T_b522a">
  <thead>
    <tr>
      <th id="T_b522a_level0_col0" class="col_heading level0 col0" >index</th>
      <th id="T_b522a_level0_col1" class="col_heading level0 col1" >id</th>
      <th id="T_b522a_level0_col2" class="col_heading level0 col2" >name</th>
      <th id="T_b522a_level0_col3" class="col_heading level0 col3" >type</th>
      <th id="T_b522a_level0_col4" class="col_heading level0 col4" >n atoms</th>
      <th id="T_b522a_level0_col5" class="col_heading level0 col5" >component index</th>
      <th id="T_b522a_level0_col6" class="col_heading level0 col6" >chain index</th>
      <th id="T_b522a_level0_col7" class="col_heading level0 col7" >molecule index</th>
      <th id="T_b522a_level0_col8" class="col_heading level0 col8" >molecule type</th>
      <th id="T_b522a_level0_col9" class="col_heading level0 col9" >entity index</th>
      <th id="T_b522a_level0_col10" class="col_heading level0 col10" >entity name</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td id="T_b522a_row0_col0" class="data row0 col0" >0</td>
      <td id="T_b522a_row0_col1" class="data row0 col1" >1</td>
      <td id="T_b522a_row0_col2" class="data row0 col2" >ACE</td>
      <td id="T_b522a_row0_col3" class="data row0 col3" >terminal capping</td>
      <td id="T_b522a_row0_col4" class="data row0 col4" >6</td>
      <td id="T_b522a_row0_col5" class="data row0 col5" >0</td>
      <td id="T_b522a_row0_col6" class="data row0 col6" >0</td>
      <td id="T_b522a_row0_col7" class="data row0 col7" >0</td>
      <td id="T_b522a_row0_col8" class="data row0 col8" >peptide</td>
      <td id="T_b522a_row0_col9" class="data row0 col9" >0</td>
      <td id="T_b522a_row0_col10" class="data row0 col10" >peptide 0</td>
    </tr>
    <tr>
      <td id="T_b522a_row1_col0" class="data row1 col0" >1</td>
      <td id="T_b522a_row1_col1" class="data row1 col1" >2</td>
      <td id="T_b522a_row1_col2" class="data row1 col2" >ALA</td>
      <td id="T_b522a_row1_col3" class="data row1 col3" >amino acid</td>
      <td id="T_b522a_row1_col4" class="data row1 col4" >10</td>
      <td id="T_b522a_row1_col5" class="data row1 col5" >0</td>
      <td id="T_b522a_row1_col6" class="data row1 col6" >0</td>
      <td id="T_b522a_row1_col7" class="data row1 col7" >0</td>
      <td id="T_b522a_row1_col8" class="data row1 col8" >peptide</td>
      <td id="T_b522a_row1_col9" class="data row1 col9" >0</td>
      <td id="T_b522a_row1_col10" class="data row1 col10" >peptide 0</td>
    </tr>
    <tr>
      <td id="T_b522a_row2_col0" class="data row2 col0" >2</td>
      <td id="T_b522a_row2_col1" class="data row2 col1" >3</td>
      <td id="T_b522a_row2_col2" class="data row2 col2" >ALA</td>
      <td id="T_b522a_row2_col3" class="data row2 col3" >amino acid</td>
      <td id="T_b522a_row2_col4" class="data row2 col4" >10</td>
      <td id="T_b522a_row2_col5" class="data row2 col5" >0</td>
      <td id="T_b522a_row2_col6" class="data row2 col6" >0</td>
      <td id="T_b522a_row2_col7" class="data row2 col7" >0</td>
      <td id="T_b522a_row2_col8" class="data row2 col8" >peptide</td>
      <td id="T_b522a_row2_col9" class="data row2 col9" >0</td>
      <td id="T_b522a_row2_col10" class="data row2 col10" >peptide 0</td>
    </tr>
    <tr>
      <td id="T_b522a_row3_col0" class="data row3 col0" >3</td>
      <td id="T_b522a_row3_col1" class="data row3 col1" >4</td>
      <td id="T_b522a_row3_col2" class="data row3 col2" >ALA</td>
      <td id="T_b522a_row3_col3" class="data row3 col3" >amino acid</td>
      <td id="T_b522a_row3_col4" class="data row3 col4" >10</td>
      <td id="T_b522a_row3_col5" class="data row3 col5" >0</td>
      <td id="T_b522a_row3_col6" class="data row3 col6" >0</td>
      <td id="T_b522a_row3_col7" class="data row3 col7" >0</td>
      <td id="T_b522a_row3_col8" class="data row3 col8" >peptide</td>
      <td id="T_b522a_row3_col9" class="data row3 col9" >0</td>
      <td id="T_b522a_row3_col10" class="data row3 col10" >peptide 0</td>
    </tr>
    <tr>
      <td id="T_b522a_row4_col0" class="data row4 col0" >4</td>
      <td id="T_b522a_row4_col1" class="data row4 col1" >5</td>
      <td id="T_b522a_row4_col2" class="data row4 col2" >ALA</td>
      <td id="T_b522a_row4_col3" class="data row4 col3" >amino acid</td>
      <td id="T_b522a_row4_col4" class="data row4 col4" >10</td>
      <td id="T_b522a_row4_col5" class="data row4 col5" >0</td>
      <td id="T_b522a_row4_col6" class="data row4 col6" >0</td>
      <td id="T_b522a_row4_col7" class="data row4 col7" >0</td>
      <td id="T_b522a_row4_col8" class="data row4 col8" >peptide</td>
      <td id="T_b522a_row4_col9" class="data row4 col9" >0</td>
      <td id="T_b522a_row4_col10" class="data row4 col10" >peptide 0</td>
    </tr>
    <tr>
      <td id="T_b522a_row5_col0" class="data row5 col0" >5</td>
      <td id="T_b522a_row5_col1" class="data row5 col1" >6</td>
      <td id="T_b522a_row5_col2" class="data row5 col2" >ALA</td>
      <td id="T_b522a_row5_col3" class="data row5 col3" >amino acid</td>
      <td id="T_b522a_row5_col4" class="data row5 col4" >10</td>
      <td id="T_b522a_row5_col5" class="data row5 col5" >0</td>
      <td id="T_b522a_row5_col6" class="data row5 col6" >0</td>
      <td id="T_b522a_row5_col7" class="data row5 col7" >0</td>
      <td id="T_b522a_row5_col8" class="data row5 col8" >peptide</td>
      <td id="T_b522a_row5_col9" class="data row5 col9" >0</td>
      <td id="T_b522a_row5_col10" class="data row5 col10" >peptide 0</td>
    </tr>
    <tr>
      <td id="T_b522a_row6_col0" class="data row6 col0" >6</td>
      <td id="T_b522a_row6_col1" class="data row6 col1" >7</td>
      <td id="T_b522a_row6_col2" class="data row6 col2" >NME</td>
      <td id="T_b522a_row6_col3" class="data row6 col3" >terminal capping</td>
      <td id="T_b522a_row6_col4" class="data row6 col4" >6</td>
      <td id="T_b522a_row6_col5" class="data row6 col5" >0</td>
      <td id="T_b522a_row6_col6" class="data row6 col6" >0</td>
      <td id="T_b522a_row6_col7" class="data row6 col7" >0</td>
      <td id="T_b522a_row6_col8" class="data row6 col8" >peptide</td>
      <td id="T_b522a_row6_col9" class="data row6 col9" >0</td>
      <td id="T_b522a_row6_col10" class="data row6 col10" >peptide 0</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>Lets represent the distance between the geometric center of the terminal groups vs. the simulation time:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">distances</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">structure</span><span class="o">.</span><span class="n">get_distances</span><span class="p">(</span><span class="n">molecular_system</span><span class="p">,</span> <span class="n">selection</span><span class="o">=</span><span class="s2">&quot;group_index==0&quot;</span><span class="p">,</span> <span class="n">center_of_atoms</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                         <span class="n">selection_2</span><span class="o">=</span><span class="s2">&quot;group_index==6&quot;</span><span class="p">,</span> <span class="n">center_of_atoms_2</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">times</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">molecular_system</span><span class="p">,</span> <span class="n">element</span><span class="o">=</span><span class="s2">&quot;system&quot;</span><span class="p">,</span> <span class="n">time</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">puw</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span><span class="n">times</span><span class="p">,</span> <span class="s1">&#39;nanoseconds&#39;</span><span class="p">),</span> <span class="n">distances</span><span class="p">[:,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/home/runner/micromamba/envs/docs/lib/python3.12/site-packages/matplotlib/cbook.py:1345: UnitStrippedWarning: The unit of the quantity is stripped when downcasting to ndarray.
  return np.asarray(x, float)
</pre></div>
</div>
<img alt="../../../../_images/34cc25cda07390c109b786cc03ce5b8771c96d268fd9a7726e5baf59a433cc2b.png" src="../../../../_images/34cc25cda07390c109b786cc03ce5b8771c96d268fd9a7726e5baf59a433cc2b.png" />
</div>
</div>
<p>Or lets just get the distance between the geometric centers of all residues at the 3000-th frame:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">list_groups_1</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">molecular_system</span><span class="p">,</span> <span class="n">element</span><span class="o">=</span><span class="s2">&quot;group&quot;</span><span class="p">,</span> <span class="n">selection</span><span class="o">=</span><span class="s2">&quot;all&quot;</span><span class="p">,</span> <span class="n">atom_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">distances</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">structure</span><span class="o">.</span><span class="n">get_distances</span><span class="p">(</span><span class="n">molecular_system</span><span class="p">,</span> <span class="n">selection</span><span class="o">=</span><span class="n">list_groups_1</span><span class="p">,</span> <span class="n">center_of_atoms</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                         <span class="n">structure_indices</span><span class="o">=</span><span class="mi">3000</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">distances</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(1, 7, 7)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The distance between geometric_center of group 2-th and group 4-th at frame 3000-th is: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">distances</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The distance between geometric_center of group 2-th and group 4-th at frame 3000-th is: 0.6818505282832528 nanometer
</pre></div>
</div>
</div>
</div>
</section>
<section id="distances-between-atom-groups-positions-in-different-structures">
<h3>Distances between atom groups positions in different structures<a class="headerlink" href="#distances-between-atom-groups-positions-in-different-structures" title="Link to this heading">#</a></h3>
<p>The method <code class="docutils literal notranslate"><span class="pre">molsysmt.distance()</span></code> works with atom groups just like with only atoms. There are two input arguments to select the coordinates of a set of atoms at two different structures:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">molecular_system</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">systems</span><span class="p">[</span><span class="s1">&#39;pentalanine&#39;</span><span class="p">][</span><span class="s1">&#39;traj_pentalanine.h5&#39;</span><span class="p">]</span>
<span class="n">molecular_system</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span><span class="n">molecular_system</span><span class="p">,</span> <span class="n">to_form</span><span class="o">=</span><span class="s1">&#39;molsysmt.MolSys&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">msm</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">molecular_system</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style type="text/css">
</style>
<table id="T_8d5fd">
  <thead>
    <tr>
      <th id="T_8d5fd_level0_col0" class="col_heading level0 col0" >form</th>
      <th id="T_8d5fd_level0_col1" class="col_heading level0 col1" >n_atoms</th>
      <th id="T_8d5fd_level0_col2" class="col_heading level0 col2" >n_groups</th>
      <th id="T_8d5fd_level0_col3" class="col_heading level0 col3" >n_components</th>
      <th id="T_8d5fd_level0_col4" class="col_heading level0 col4" >n_chains</th>
      <th id="T_8d5fd_level0_col5" class="col_heading level0 col5" >n_molecules</th>
      <th id="T_8d5fd_level0_col6" class="col_heading level0 col6" >n_entities</th>
      <th id="T_8d5fd_level0_col7" class="col_heading level0 col7" >n_peptides</th>
      <th id="T_8d5fd_level0_col8" class="col_heading level0 col8" >n_structures</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td id="T_8d5fd_row0_col0" class="data row0 col0" >molsysmt.MolSys</td>
      <td id="T_8d5fd_row0_col1" class="data row0 col1" >62</td>
      <td id="T_8d5fd_row0_col2" class="data row0 col2" >7</td>
      <td id="T_8d5fd_row0_col3" class="data row0 col3" >1</td>
      <td id="T_8d5fd_row0_col4" class="data row0 col4" >1</td>
      <td id="T_8d5fd_row0_col5" class="data row0 col5" >1</td>
      <td id="T_8d5fd_row0_col6" class="data row0 col6" >1</td>
      <td id="T_8d5fd_row0_col7" class="data row0 col7" >1</td>
      <td id="T_8d5fd_row0_col8" class="data row0 col8" >5000</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>Let see how <code class="docutils literal notranslate"><span class="pre">structure_indices_1</span></code> and <code class="docutils literal notranslate"><span class="pre">structure_indices_2</span></code> works in this context:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">distances</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">structure</span><span class="o">.</span><span class="n">get_distances</span><span class="p">(</span><span class="n">molecular_system</span><span class="p">,</span>
                         <span class="n">selection</span><span class="o">=</span><span class="s2">&quot;group_index==0&quot;</span><span class="p">,</span> <span class="n">center_of_atoms</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                         <span class="n">structure_indices</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
                         <span class="n">selection_2</span><span class="o">=</span><span class="s2">&quot;group_index==6&quot;</span><span class="p">,</span> <span class="n">center_of_atoms_2</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                         <span class="n">structure_indices_2</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">distances</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(1, 1, 1)
</pre></div>
</div>
</div>
</div>
<p>The physical meaning of this former example is clear but not really useful, unless <code class="docutils literal notranslate"><span class="pre">selection</span></code> is the same as <code class="docutils literal notranslate"><span class="pre">selection_2</span></code> as we can see in the following section.</p>
</section>
<section id="displacement-distances-of-atom-groups">
<h3>Displacement distances of atom groups<a class="headerlink" href="#displacement-distances-of-atom-groups" title="Link to this heading">#</a></h3>
<p>The possibility to get the distance between the coordinates of an object at two different structures makes the obtention of atom groups displacements straightforward. Lets plot the distance walked by the 0-th group of the former pentalanine peptide between consecutive structures of the trajectory store in <code class="docutils literal notranslate"><span class="pre">pentalanine.h5</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">molecular_system</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">systems</span><span class="p">[</span><span class="s1">&#39;pentalanine&#39;</span><span class="p">][</span><span class="s1">&#39;traj_pentalanine.h5&#39;</span><span class="p">]</span>
<span class="n">molecular_system</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span><span class="n">molecular_system</span><span class="p">,</span> <span class="n">to_form</span><span class="o">=</span><span class="s1">&#39;molsysmt.MolSys&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">n_structures</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">molecular_system</span><span class="p">,</span> <span class="n">n_structures</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">all_structure_indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">n_structures</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">displacements</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">structure</span><span class="o">.</span><span class="n">get_distances</span><span class="p">(</span><span class="n">molecular_system</span><span class="p">,</span> <span class="n">selection</span><span class="o">=</span><span class="s2">&quot;group_index==0&quot;</span><span class="p">,</span> <span class="n">center_of_atoms</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                             <span class="n">structure_indices</span><span class="o">=</span><span class="n">all_structure_indices</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">structure_indices_2</span><span class="o">=</span><span class="n">all_structure_indices</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">time</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">molecular_system</span><span class="p">,</span> <span class="n">element</span><span class="o">=</span><span class="s1">&#39;system&#39;</span><span class="p">,</span> <span class="n">structure_indices</span><span class="o">=</span><span class="n">all_structure_indices</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">time</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">puw</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span><span class="n">time</span><span class="p">,</span><span class="s1">&#39;ns&#39;</span><span class="p">),</span> <span class="n">displacements</span><span class="p">[:,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/home/runner/micromamba/envs/docs/lib/python3.12/site-packages/matplotlib/cbook.py:1345: UnitStrippedWarning: The unit of the quantity is stripped when downcasting to ndarray.
  return np.asarray(x, float)
</pre></div>
</div>
<img alt="../../../../_images/33a139a25407eb4eddbf29a493140e4483a8e3cb6c0101d1f856ad4e8fcb3957.png" src="../../../../_images/33a139a25407eb4eddbf29a493140e4483a8e3cb6c0101d1f856ad4e8fcb3957.png" />
</div>
</div>
<p>Or we can, for instance, get the distance of the center of mass of the whole molecule from the initial configuration to every time step along the trajectory:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">displacements</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">structure</span><span class="o">.</span><span class="n">get_distances</span><span class="p">(</span><span class="n">molecular_system</span><span class="p">,</span> <span class="n">selection</span><span class="o">=</span><span class="s2">&quot;all&quot;</span><span class="p">,</span>
                                            <span class="n">structure_indices</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_structures</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">),</span>
                                            <span class="n">structure_indices_2</span><span class="o">=</span><span class="n">all_structure_indices</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">displacements</span><span class="p">[</span><span class="mi">1000</span><span class="p">,</span><span class="mi">30</span><span class="p">,</span><span class="mi">30</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">0.45176813186030235 nanometer</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">time</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">molecular_system</span><span class="p">,</span> <span class="n">element</span><span class="o">=</span><span class="s1">&#39;system&#39;</span><span class="p">,</span> <span class="n">time</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">puw</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="s1">&#39;ns&#39;</span><span class="p">),</span> <span class="n">displacements</span><span class="p">[:,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../../_images/e323937aeaaa820fe9b09a43e4ce6d7e5f8ee947ec217fc22f86616306759877.png" src="../../../../_images/e323937aeaaa820fe9b09a43e4ce6d7e5f8ee947ec217fc22f86616306759877.png" />
</div>
</div>
</section>
<section id="distance-between-pairs-of-groups-of-atoms">
<h3>Distance between pairs of groups of atoms<a class="headerlink" href="#distance-between-pairs-of-groups-of-atoms" title="Link to this heading">#</a></h3>
<p>Lets see the following example where all distances betweeen the geometric center of the residues of pentalanine is computed along a short trajectory:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">molecular_system</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">systems</span><span class="p">[</span><span class="s1">&#39;pentalanine&#39;</span><span class="p">][</span><span class="s1">&#39;traj_pentalanine.h5&#39;</span><span class="p">]</span>
<span class="n">molecular_system</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span><span class="n">molecular_system</span><span class="p">,</span> <span class="n">to_form</span><span class="o">=</span><span class="s1">&#39;molsysmt.MolSys&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">list_atom_groups</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">molecular_system</span><span class="p">,</span> <span class="n">element</span><span class="o">=</span><span class="s1">&#39;group&#39;</span><span class="p">,</span> <span class="n">selection</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="n">atom_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">list_atom_groups</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[0, 1, 2, 3, 4, 5],
 [6, 7, 8, 9, 10, 11, 12, 13, 14, 15],
 [16, 17, 18, 19, 20, 21, 22, 23, 24, 25],
 [26, 27, 28, 29, 30, 31, 32, 33, 34, 35],
 [36, 37, 38, 39, 40, 41, 42, 43, 44, 45],
 [46, 47, 48, 49, 50, 51, 52, 53, 54, 55],
 [56, 57, 58, 59, 60, 61]]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">distances</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">structure</span><span class="o">.</span><span class="n">get_distances</span><span class="p">(</span><span class="n">molecular_system</span><span class="p">,</span> <span class="n">selection</span><span class="o">=</span><span class="n">list_atom_groups</span><span class="p">,</span>
                         <span class="n">center_of_atoms</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">distances</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(5000, 7, 7)
</pre></div>
</div>
</div>
</div>
<p>The method worked needlessly computing the distances between different groups twice, as well as getting the distance between a geometric center to the its self for every residue. This can be avoided thanks to the input argument <code class="docutils literal notranslate"><span class="pre">pairs=True</span></code>. Using <code class="docutils literal notranslate"><span class="pre">pairs=True</span></code>, as it can be seen in the corresponding section about distances of atoms pairs, the distances between atom groups pairs made by consecutive elements of two zipped lists are obtained. Lets see this with a pratical case:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">itertools</span><span class="w"> </span><span class="kn">import</span> <span class="n">combinations</span> 

<span class="n">list_atom_groups_1</span><span class="o">=</span><span class="p">[]</span>
<span class="n">list_atom_groups_2</span><span class="o">=</span><span class="p">[]</span>
<span class="n">aux_list_1</span><span class="o">=</span><span class="p">[]</span>
<span class="n">aux_list_2</span><span class="o">=</span><span class="p">[]</span>

<span class="k">for</span> <span class="n">ii</span><span class="p">,</span><span class="n">jj</span> <span class="ow">in</span> <span class="n">combinations</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">7</span><span class="p">),</span> <span class="mi">2</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">.vs.</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ii</span><span class="p">,</span><span class="n">jj</span><span class="p">))</span>
    <span class="n">aux_list_1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ii</span><span class="p">)</span>
    <span class="n">aux_list_2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">jj</span><span class="p">)</span>
    <span class="n">list_atom_groups_1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">list_atom_groups</span><span class="p">[</span><span class="n">ii</span><span class="p">])</span>
    <span class="n">list_atom_groups_2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">list_atom_groups</span><span class="p">[</span><span class="n">jj</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.vs.1
0.vs.2
0.vs.3
0.vs.4
0.vs.5
0.vs.6
1.vs.2
1.vs.3
1.vs.4
1.vs.5
1.vs.6
2.vs.3
2.vs.4
2.vs.5
2.vs.6
3.vs.4
3.vs.5
3.vs.6
4.vs.5
4.vs.6
5.vs.6
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">distances</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">structure</span><span class="o">.</span><span class="n">get_distances</span><span class="p">(</span><span class="n">molecular_system</span><span class="p">,</span> <span class="n">selection</span><span class="o">=</span><span class="n">list_atom_groups_1</span><span class="p">,</span> <span class="n">center_of_atoms</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                         <span class="n">selection_2</span><span class="o">=</span><span class="n">list_atom_groups_2</span><span class="p">,</span> <span class="n">center_of_atoms_2</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">pairs</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">distances</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(5000, 21)
</pre></div>
</div>
</div>
</div>
<p>Lets plot the distance of a given pair, 12-th p.e., defined by the groups:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The 12-th pair is made by groups </span><span class="si">{}</span><span class="s1">-th and </span><span class="si">{}</span><span class="s1">-th, and its distance along the trajectory is:&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">aux_list_1</span><span class="p">[</span><span class="mi">12</span><span class="p">],</span> <span class="n">aux_list_2</span><span class="p">[</span><span class="mi">12</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The 12-th pair is made by groups 2-th and 4-th, and its distance along the trajectory is:
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">time</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">molecular_system</span><span class="p">,</span> <span class="n">element</span><span class="o">=</span><span class="s1">&#39;system&#39;</span><span class="p">,</span> <span class="n">time</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">puw</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="s1">&#39;ns&#39;</span><span class="p">),</span> <span class="n">distances</span><span class="p">[:,</span><span class="mi">12</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/home/runner/micromamba/envs/docs/lib/python3.12/site-packages/matplotlib/cbook.py:1345: UnitStrippedWarning: The unit of the quantity is stripped when downcasting to ndarray.
  return np.asarray(x, float)
</pre></div>
</div>
<img alt="../../../../_images/fb4180f72d3864ef25ac410bd500c086489d68bc546ff19019eb63a97de9c513.png" src="../../../../_images/fb4180f72d3864ef25ac410bd500c086489d68bc546ff19019eb63a97de9c513.png" />
</div>
</div>
</section>
</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="get_dihedral_angles.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Get dihedral angles</p>
      </div>
    </a>
    <a class="right-next"
       href="get_least_rmsd.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Get least RMSD</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-xyz-molecular-system-form">The XYZ molecular system form</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#distance-between-atoms-in-space">Distance between atoms in space</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#distance-between-atoms-of-a-system">Distance between atoms of a system</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#distances-between-atoms-positions-in-different-structures">Distances between atoms positions in different structures</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#displacement-distances-of-atoms">Displacement distances of atoms</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#distance-between-atoms-pairs">Distance between atoms pairs</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#distance-between-atom-groups-in-space">Distance between atom groups in space</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#distance-between-atom-groups-of-a-system">Distance between atom groups of a system</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#distances-between-atom-groups-positions-in-different-structures">Distances between atom groups positions in different structures</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#displacement-distances-of-atom-groups">Displacement distances of atom groups</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#distance-between-pairs-of-groups-of-atoms">Distance between pairs of groups of atoms</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../../../../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="../../../../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item"><div>
	&copy; 2024, <a href=contents/about/who.html>Liliana M. Moreno Vargas, Diego Prada Gracia
		and contributors</a> | <a href="https://www.uibcdf.org/">UIBCDF Lab</a> 
	at the <a href="http://himfg.com.mx">Children's Hospital of Mexico Federico Gómez</a><br />
	<a href="https://github.com/uibcdf/MolSysMT">MolSysMT is an open source project</a> shared
	under <a href="https://github.com/uibcdf/MolSysMT/blob/main/LICENSE">an MIT license</a>
	with a structure based on the
	<a href="https://github.com/MolSSI/cookiecutter-cms">Computational Molecular Science
		Python Cookiecutter</a> version 1.5
</div></div>
      
        <div class="footer-item">
  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.1.3
     | 
    Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.16.1
    <br/>
  </p>

</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item"><a href= "mailto:uibcdf@gmail.com">Contact us</a><br /></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>