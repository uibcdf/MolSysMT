{
 "cells": [
  {
   "cell_type": "markdown",
   "id": "c79a89ab-fd57-44e9-a29f-5b2ff55c8303",
   "metadata": {},
   "source": [
    "# Add hbonds"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "d0d2d63c-477b-4b98-b1ad-c5539cb6bfaf",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "application/vnd.jupyter.widget-view+json": {
       "model_id": "620141822e554805a52b8e21160f3951",
       "version_major": 2,
       "version_minor": 0
      },
      "text/plain": []
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "import molsysmt as msm"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "cdfb9b86-bb28-43bc-8ce1-b8e18fef057c",
   "metadata": {},
   "outputs": [],
   "source": [
    "molsys = msm.convert(msm.systems['Barnase-Barstar']['barnase_barstar.h5msm'])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "14302ba3-9022-4af6-ae11-18121d80dec0",
   "metadata": {},
   "outputs": [],
   "source": [
    "hbonds, distance, angles = msm.hbonds.get_luzard_chandler_hbonds(molsys, selection='molecule_name==\"BARNASE\"',\n",
    "                                              selection_2='molecule_name==\"BARSTAR\"')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "c7a2c6fe-7dd5-4930-a1b4-74d5bc24ca1a",
   "metadata": {},
   "outputs": [],
   "source": [
    "view = msm.view(molsys)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "id": "a7838a1a-18e6-4a1d-be9f-99f02bfb1a1e",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[[ -6.74937189  18.93098593  20.18462181]\n",
      " [ -5.31830668  19.23341274  19.44942117]\n",
      " [ -6.29009306   6.66234791  20.24798155]\n",
      " [ -4.26222116  26.65435076  27.10973024]\n",
      " [ -9.37235057  23.44877958  29.9128747 ]\n",
      " [-10.13223648  22.89703846  28.17741156]\n",
      " [ -1.98783845  27.12180138  27.98150539]\n",
      " [  0.84155507  24.71710443  29.89280462]\n",
      " [ -3.14098775  15.18958688  17.9880619 ]\n",
      " [ -3.35058331  16.81069136  18.64335895]\n",
      " [ -2.98885018  18.49961758  17.65735149]\n",
      " [ -0.93936294  19.91364837  18.09915543]\n",
      " [ -0.13282725  17.96996713  18.54157329]\n",
      " [  7.86216021  21.18884802  27.20354557]\n",
      " [  6.02977633  20.68663359  27.2490406 ]\n",
      " [  0.63050255  22.86063671  30.06663084]\n",
      " [ -3.83645624  25.17705441  26.06848717]\n",
      " [ -2.0955196   26.49522305  26.19250059]\n",
      " [ -3.75274658  18.40765834  19.43321109]\n",
      " [ -1.58523053  18.47001672  19.42898273]\n",
      " [ -7.35389948  17.91380286  21.6544652 ]\n",
      " [ -3.60220134  13.51149201  18.65883827]\n",
      " [ -6.3363713    7.96069682  21.78743124]\n",
      " [-11.10049009  23.26285601  29.62808371]]\n"
     ]
    }
   ],
   "source": [
    "msm.thirds.nglview.add_hbonds(view, hbonds)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "id": "a6b4197f-e624-40fa-ad45-ecf3c5ad4498",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "application/vnd.jupyter.widget-view+json": {
       "model_id": "3c8c2b91edac49918a07bfc561f310b0",
       "version_major": 2,
       "version_minor": 0
      },
      "text/plain": [
       "NGLWidget()"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "view"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "1d9b5604-c965-4a5c-9d38-f431d19fb439",
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3 (ipykernel)",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.10.14"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
