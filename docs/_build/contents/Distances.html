

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Getting distances, neighbor lists and contact maps. &mdash; MolSysMT 0.1 documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
        <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.18.0/dist/embed-amd.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Periodic Boundary Conditions" href="PBC.html" />
    <link rel="prev" title="Geometrical transformations" href="Geometrical_transformations.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home" alt="Documentation Home"> MolSysMT
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Installation and Quick Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="Quickstart.html">Quick Guide</a><ul>
<li class="toctree-l2"><a class="reference internal" href="Quickstart.html#Fetching-molecular-systems-from-web-databases">Fetching molecular systems from web databases</a></li>
<li class="toctree-l2"><a class="reference internal" href="Quickstart.html#Loading-molecular-systems-and-trajectories">Loading molecular systems and trajectories</a></li>
<li class="toctree-l2"><a class="reference internal" href="Quickstart.html#Converting-molecular-systems-and-trajectories">Converting molecular systems and trajectories</a></li>
<li class="toctree-l2"><a class="reference internal" href="Quickstart.html#Working-with-id-codes">Working with id codes</a></li>
<li class="toctree-l2"><a class="reference internal" href="Quickstart.html#Working-with-sequences">Working with sequences</a></li>
<li class="toctree-l2"><a class="reference internal" href="Quickstart.html#Writting-molecular-systems-or-trajectories-as-files">Writting molecular systems or trajectories as files</a></li>
<li class="toctree-l2"><a class="reference internal" href="Quickstart.html#Atoms-selection">Atoms selection</a></li>
<li class="toctree-l2"><a class="reference internal" href="Quickstart.html#Viewing-molecular-systems-and-trajectories">Viewing molecular systems and trajectories</a></li>
<li class="toctree-l2"><a class="reference internal" href="Quickstart.html#Molecular-systems-as-MolSysMT’s-forms">Molecular systems as MolSysMT’s forms</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Forms and elements</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Forms.html">Molecular systems forms</a><ul>
<li class="toctree-l2"><a class="reference internal" href="Forms.html#Files">Files</a></li>
<li class="toctree-l2"><a class="reference internal" href="Forms.html#Classes">Classes</a></li>
<li class="toctree-l2"><a class="reference internal" href="Forms.html#Ids">Ids</a></li>
<li class="toctree-l2"><a class="reference internal" href="Forms.html#Sequences">Sequences</a></li>
<li class="toctree-l2"><a class="reference internal" href="Forms.html#Viewers">Viewers</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Elements.html">Molecular system elements</a></li>
<li class="toctree-l1"><a class="reference internal" href="Elements.html#elements">Elements</a><ul>
<li class="toctree-l2"><a class="reference internal" href="Elements.html#atom">Atom</a></li>
<li class="toctree-l2"><a class="reference internal" href="Elements.html#group">Group</a></li>
<li class="toctree-l2"><a class="reference internal" href="Elements.html#component">Component</a></li>
<li class="toctree-l2"><a class="reference internal" href="Elements.html#molecule">Molecule</a></li>
<li class="toctree-l2"><a class="reference internal" href="Elements.html#chains">Chains</a></li>
<li class="toctree-l2"><a class="reference internal" href="Elements.html#entities">Entities</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="MolSys.html">The MolSys form</a></li>
<li class="toctree-l1"><a class="reference internal" href="MolSys.html#topology">Topology</a><ul>
<li class="toctree-l2"><a class="reference internal" href="MolSys.html#elements">Elements</a><ul>
<li class="toctree-l3"><a class="reference internal" href="MolSys.html#atom">Atom</a></li>
<li class="toctree-l3"><a class="reference internal" href="MolSys.html#group">Group</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="MolSys.html#component">Component</a></li>
<li class="toctree-l2"><a class="reference internal" href="MolSys.html#molecule">Molecule</a></li>
<li class="toctree-l2"><a class="reference internal" href="MolSys.html#chains">Chains</a></li>
<li class="toctree-l2"><a class="reference internal" href="MolSys.html#entities">Entities</a></li>
<li class="toctree-l2"><a class="reference internal" href="MolSys.html#bioassemblies">Bioassemblies</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="MolSys.html#trajectory">Trajectory</a></li>
</ul>
<p class="caption"><span class="caption-text">Basic tools</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Convert.html">How to convert a form into other form</a><ul>
<li class="toctree-l2"><a class="reference internal" href="Convert.html#How-to-convert-just-a-selection">How to convert just a selection</a></li>
<li class="toctree-l2"><a class="reference internal" href="Convert.html#How-to-combine-multiple-forms-into-one">How to combine multiple forms into one</a></li>
<li class="toctree-l2"><a class="reference internal" href="Convert.html#How-to-convert-a-form-into-multiple-ones-at-once">How to convert a form into multiple ones at once</a></li>
<li class="toctree-l2"><a class="reference internal" href="Convert.html#Some-examples-with-files">Some examples with files</a></li>
<li class="toctree-l2"><a class="reference internal" href="Convert.html#Some-examples-with-IDs">Some examples with IDs</a></li>
<li class="toctree-l2"><a class="reference internal" href="Convert.html#Conversions-implemented-in-MolSysMT">Conversions implemented in MolSysMT</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Selection.html">Elements selection</a><ul>
<li class="toctree-l2"><a class="reference internal" href="Selection.html#MolSysMT-selection-syntaxis">MolSysMT selection syntaxis</a><ul>
<li class="toctree-l3"><a class="reference internal" href="Selection.html#Simple-atoms-selection-by-their-attributes-or-properties">Simple atoms selection by their attributes or properties</a></li>
<li class="toctree-l3"><a class="reference internal" href="Selection.html#Including-other-elements-attributes">Including other elements attributes</a></li>
<li class="toctree-l3"><a class="reference internal" href="Selection.html#Including-external-variables">Including external variables</a></li>
<li class="toctree-l3"><a class="reference internal" href="Selection.html#Including-mask-filters">Including mask filters</a></li>
<li class="toctree-l3"><a class="reference internal" href="Selection.html#Selection-of-other-elements">Selection of other elements</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="Selection.html#Syntaxis-translation">Syntaxis translation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="Selection.html#Output-syntaxis-supported">Output syntaxis supported</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="Selection.html#Using-your-favourite-selection-syntaxis">Using your favourite selection syntaxis</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Get.html">How to get attributes from a molecular system</a><ul>
<li class="toctree-l2"><a class="reference internal" href="Get.html#Table-with-attributes-you-can-get">Table with attributes you can get</a></li>
<li class="toctree-l2"><a class="reference internal" href="Get.html#Some-other-examples-involving-atoms,-groups,-components,-chains,-molecules-or-entities">Some other examples involving atoms, groups, components, chains, molecules or entities</a></li>
<li class="toctree-l2"><a class="reference internal" href="Get.html#Some-other-examples-involving-systems">Some other examples involving systems</a></li>
<li class="toctree-l2"><a class="reference internal" href="Get.html#Some-other-examples-involving-bonds">Some other examples involving bonds</a></li>
<li class="toctree-l2"><a class="reference internal" href="Get.html#Getting-trajectory-times,-coordinates-and-pbc-box-attributes">Getting trajectory times, coordinates and pbc box attributes</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Info.html">Printing out a summary information of a molecular system</a><ul>
<li class="toctree-l2"><a class="reference internal" href="Info.html#As-a-DataFrame">As a DataFrame</a><ul>
<li class="toctree-l3"><a class="reference internal" href="Info.html#Summary-information-on-atoms">Summary information on atoms</a></li>
<li class="toctree-l3"><a class="reference internal" href="Info.html#Summary-information-on-groups">Summary information on groups</a></li>
<li class="toctree-l3"><a class="reference internal" href="Info.html#Summary-information-on-components">Summary information on components</a></li>
<li class="toctree-l3"><a class="reference internal" href="Info.html#Summary-information-on-chains">Summary information on chains</a></li>
<li class="toctree-l3"><a class="reference internal" href="Info.html#Summary-information-on-molecules">Summary information on molecules</a></li>
<li class="toctree-l3"><a class="reference internal" href="Info.html#Summary-information-on-entities">Summary information on entities</a></li>
<li class="toctree-l3"><a class="reference internal" href="Info.html#Summary-information-on-a-molecular-system">Summary information on a molecular system</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="Info.html#As-a-string">As a string</a><ul>
<li class="toctree-l3"><a class="reference internal" href="Info.html#id1">Summary information on atoms</a></li>
<li class="toctree-l3"><a class="reference internal" href="Info.html#id2">Summary information on groups</a></li>
<li class="toctree-l3"><a class="reference internal" href="Info.html#id3">Summary information on components</a></li>
<li class="toctree-l3"><a class="reference internal" href="Info.html#id4">Summary information on chains</a></li>
<li class="toctree-l3"><a class="reference internal" href="Info.html#id5">Summary information on molecules</a></li>
<li class="toctree-l3"><a class="reference internal" href="Info.html#id6">Summary information on entities</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Copy.html">Copying a molecular system</a></li>
<li class="toctree-l1"><a class="reference internal" href="Extract.html">Extracting a molecular subsystem</a><ul>
<li class="toctree-l2"><a class="reference internal" href="Extract.html#How-to-extract-a-molecular-subsystem">How to extract a molecular subsystem</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Remove.html">Removing atoms and frames from a molecular system</a><ul>
<li class="toctree-l2"><a class="reference internal" href="Remove.html#Removing-frames">Removing frames</a></li>
<li class="toctree-l2"><a class="reference internal" href="Remove.html#Removing-atoms">Removing atoms</a></li>
<li class="toctree-l2"><a class="reference internal" href="Remove.html#Removing-hydrogen-atoms">Removing hydrogen atoms</a></li>
<li class="toctree-l2"><a class="reference internal" href="Remove.html#Removing-the-solvent">Removing the solvent</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Merge.html">Merging Molecular Systems</a></li>
<li class="toctree-l1"><a class="reference internal" href="Add.html">Adding to a molecular systems</a></li>
<li class="toctree-l1"><a class="reference internal" href="Concatenate.html">Concatenate Molecular Systems</a></li>
<li class="toctree-l1"><a class="reference internal" href="Append.html">Append to a molecular systems</a></li>
<li class="toctree-l1"><a class="reference internal" href="View.html">Viewing a molecular system</a><ul>
<li class="toctree-l2"><a class="reference internal" href="View.html#NGLView">NGLView</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Building tools</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Fix.html">Fixing</a></li>
<li class="toctree-l1"><a class="reference internal" href="Solvation.html">Adding solvent</a><ul>
<li class="toctree-l2"><a class="reference internal" href="Solvation.html#Octahedral">Octahedral</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Protonation.html">Protonation</a></li>
<li class="toctree-l1"><a class="reference internal" href="Build_peptide.html">Building a peptide from its sequence</a><ul>
<li class="toctree-l2"><a class="reference internal" href="Build_peptide.html#Alanine-dipeptide-in-implicit-solvent">Alanine dipeptide in implicit solvent</a></li>
<li class="toctree-l2"><a class="reference internal" href="Build_peptide.html#Alanine-dipeptide-in-explicit-solvent">Alanine dipeptide in explicit solvent</a></li>
<li class="toctree-l2"><a class="reference internal" href="Build_peptide.html#Alanine-pentapeptide-in-implicit-solvent">Alanine pentapeptide in implicit solvent</a></li>
<li class="toctree-l2"><a class="reference internal" href="Build_peptide.html#Alanine-pentapeptide-in-explicit-solvent">Alanine pentapeptide in explicit solvent</a></li>
<li class="toctree-l2"><a class="reference internal" href="Build_peptide.html#Met-enkephalin-in-implicit-solvent">Met-enkephalin in implicit solvent</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Terminal_capping.html">Terminal capping</a></li>
<li class="toctree-l1"><a class="reference internal" href="Model_loop.html">Modeling loops</a></li>
<li class="toctree-l1"><a class="reference internal" href="Energy_minimization.html">Potential energy and energy minimization</a><ul>
<li class="toctree-l2"><a class="reference internal" href="Energy_minimization.html#Some-examples:">Some examples:</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Structural tools</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="Geometrical_transformations.html">Geometrical transformations</a><ul>
<li class="toctree-l2"><a class="reference internal" href="Geometrical_transformations.html#Translation">Translation</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Getting distances, neighbor lists and contact maps.</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#The-XYZ-molecular-system-form">The XYZ molecular system form</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Distance-between-atoms-in-space">Distance between atoms in space</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Distance-between-atoms-of-a-system">Distance between atoms of a system</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Distance-between-atoms-of-two-systems">Distance between atoms of two systems</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Distances-between-atoms-positions-in-different-frames">Distances between atoms positions in different frames</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Displacement-distances-of-atoms">Displacement distances of atoms</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Distance-between-atoms-pairs">Distance between atoms pairs</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Minimum-and-Maximum-distance">Minimum and Maximum distance</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#Distance-between-atom-groups-in-space">Distance between atom groups in space</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Distance-between-atom-groups-of-a-system">Distance between atom groups of a system</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Distance-between-atom-groups-of-two-systems">Distance between atom groups of two systems</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Distances-between-atom-groups-positions-in-different-frames">Distances between atom groups positions in different frames</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Displacement-distances-of-atom-groups">Displacement distances of atom groups</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Distance-between-atom-groups-pairs">Distance between atom groups pairs</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Minimum-and-Maximum-distance-of-atom-groups">Minimum and Maximum distance of atom groups</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#Neighbor-lists">Neighbor lists</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#First-closest-neighbor-atoms-or-groups">First closest neighbor atoms or groups</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Closest-neighbor-atoms-or-groups-below-a-distance-threshold">Closest neighbor atoms or groups below a distance threshold</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#Contact-maps">Contact maps</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="PBC.html">Periodic Boundary Conditions</a></li>
<li class="toctree-l1"><a class="reference internal" href="Centers.html">Getting the center and recentering</a></li>
<li class="toctree-l1"><a class="reference internal" href="RMSD.html">RMSD, Least RMSD and Least RMSD fit</a><ul>
<li class="toctree-l2"><a class="reference internal" href="RMSD.html#RMSD">RMSD</a></li>
<li class="toctree-l2"><a class="reference internal" href="RMSD.html#Least-RMSD">Least RMSD</a></li>
<li class="toctree-l2"><a class="reference internal" href="RMSD.html#Least-RMSD-fit">Least RMSD fit</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Rg.html">Radius of gyration</a></li>
<li class="toctree-l1"><a class="reference internal" href="Dihedral_angles.html">Dihedral angles</a><ul>
<li class="toctree-l2"><a class="reference internal" href="Dihedral_angles.html#How-to-get-any-dihedral-angle">How to get any dihedral angle</a></li>
<li class="toctree-l2"><a class="reference internal" href="Dihedral_angles.html#How-to-get-the-Ramachandran-angles">How to get the Ramachandran angles</a></li>
<li class="toctree-l2"><a class="reference internal" href="Dihedral_angles.html#How-to-change-the-dihedral-angles-of-a-molecular-system">How to change the dihedral angles of a molecular system</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="SASA.html">Solvent Accessible Surface Area</a></li>
</ul>
<p class="caption"><span class="caption-text">Topological tools</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Bondgraph.html">Bondgraph</a></li>
<li class="toctree-l1"><a class="reference internal" href="Covalent_chains.html">Covalent chains and blocks</a><ul>
<li class="toctree-l2"><a class="reference internal" href="Covalent_chains.html#How-to-get-covalent-chains">How to get covalent chains</a></li>
<li class="toctree-l2"><a class="reference internal" href="Covalent_chains.html#How-to-get-the-atoms-quartets-defining-the-dihedral-angles">How to get the atoms quartets defining the dihedral angles</a><ul>
<li class="toctree-l3"><a class="reference internal" href="Covalent_chains.html#\phi-(phi)"><span class="math notranslate nohighlight">\(\phi\)</span> (<code class="docutils literal notranslate"><span class="pre">phi</span></code>)</a></li>
<li class="toctree-l3"><a class="reference internal" href="Covalent_chains.html#\psi-(psi)"><span class="math notranslate nohighlight">\(\psi\)</span> (<code class="docutils literal notranslate"><span class="pre">psi</span></code>)</a></li>
<li class="toctree-l3"><a class="reference internal" href="Covalent_chains.html#\omega-(omega)"><span class="math notranslate nohighlight">\(\omega\)</span> (<code class="docutils literal notranslate"><span class="pre">omega</span></code>)</a></li>
<li class="toctree-l3"><a class="reference internal" href="Covalent_chains.html#\chi_{1}-(chi1)"><span class="math notranslate nohighlight">\(\chi_{1}\)</span> (<code class="docutils literal notranslate"><span class="pre">chi1</span></code>)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="Covalent_chains.html#\chi_{2}-(chi2)"><span class="math notranslate nohighlight">\(\chi_{2}\)</span> (<code class="docutils literal notranslate"><span class="pre">chi2</span></code>)</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="Covalent_chains.html#\chi_{3}-(chi3)"><span class="math notranslate nohighlight">\(\chi_{3}\)</span> (<code class="docutils literal notranslate"><span class="pre">chi3</span></code>)</a></li>
<li class="toctree-l3"><a class="reference internal" href="Covalent_chains.html#\chi_{4}-(chi4)"><span class="math notranslate nohighlight">\(\chi_{4}\)</span> (<code class="docutils literal notranslate"><span class="pre">chi4</span></code>)</a></li>
<li class="toctree-l3"><a class="reference internal" href="Covalent_chains.html#\chi_{5}-(chi5)"><span class="math notranslate nohighlight">\(\chi_{5}\)</span> (<code class="docutils literal notranslate"><span class="pre">chi5</span></code>)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="Covalent_chains.html#How-to-get-covalent-blocks">How to get covalent blocks</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Alignment.html">Sequence alignment</a></li>
<li class="toctree-l1"><a class="reference internal" href="Mutations.html">Mutations</a></li>
</ul>
<p class="caption"><span class="caption-text">PhysChem and ADMET tools</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Mass.html">How to get chemical and physical properties</a><ul>
<li class="toctree-l2"><a class="reference internal" href="Mass.html#Atoms">Atoms</a><ul>
<li class="toctree-l3"><a class="reference internal" href="Mass.html#Mass">Mass</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Volume_and_radii.html">How to get chemical and physical properties</a><ul>
<li class="toctree-l2"><a class="reference internal" href="Volume_and_radii.html#Atoms">Atoms</a><ul>
<li class="toctree-l3"><a class="reference internal" href="Volume_and_radii.html#Mass">Mass</a></li>
<li class="toctree-l3"><a class="reference internal" href="Volume_and_radii.html#Radii">Radii</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Charge.html">Charge of a molecular system</a><ul>
<li class="toctree-l2"><a class="reference internal" href="Charge.html#Charge-of-a-molecular-system-given-by-a-forcefield">Charge of a molecular system given by a forcefield</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Polarity.html">How to get chemical and physical properties</a><ul>
<li class="toctree-l2"><a class="reference internal" href="Polarity.html#Atoms">Atoms</a><ul>
<li class="toctree-l3"><a class="reference internal" href="Polarity.html#Mass">Mass</a></li>
<li class="toctree-l3"><a class="reference internal" href="Polarity.html#Radii">Radii</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">API Documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../api/index.html">Basic manipulations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/index.html#geometric-observables-and-transformations">Geometric observables and transformations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/index.html#topological-observables-and-transformations">Topological observables and transformations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/index.html#physical-or-chemical-observables-and-transformations">Physical or chemical observables and transformations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/index_elements.html">Elements</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">MolSysMT</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Getting distances, neighbor lists and contact maps.</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/contents/Distances.ipynb.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container,
div.nbinput.container div.prompt,
div.nbinput.container div.input_area,
div.nbinput.container div[class*=highlight],
div.nbinput.container div[class*=highlight] pre,
div.nboutput.container,
div.nboutput.container div.prompt,
div.nboutput.container div.output_area,
div.nboutput.container div[class*=highlight],
div.nboutput.container div[class*=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    background: #f5f5f5;
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="o">%</span><span class="k">load_ext</span> autoreload
<span class="o">%</span><span class="k">autoreload</span> 2
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">molsysmt</span> <span class="k">as</span> <span class="nn">msm</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">simtk</span> <span class="kn">import</span> <span class="n">unit</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "4d95bb0569d5429ab6b5ffe6e3743034", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="section" id="Getting-distances,-neighbor-lists-and-contact-maps.">
<h1>Getting distances, neighbor lists and contact maps.<a class="headerlink" href="#Getting-distances,-neighbor-lists-and-contact-maps." title="Permalink to this headline">¶</a></h1>
<p>MolSysMT includes a very versatile method to calculate distances between points in space, atoms and/or groups of atoms. As many other methods of this multitool, the method <code class="docutils literal notranslate"><span class="pre">molsysmt.distance()</span></code> has an input argument to choose the engine in charge of getting the result. For instance, <code class="docutils literal notranslate"><span class="pre">molsysmt.distance()</span></code> currently offers two engines <code class="docutils literal notranslate"><span class="pre">MolSysMT</span></code> and <code class="docutils literal notranslate"><span class="pre">MDTraj</span></code>. At this moment only <code class="docutils literal notranslate"><span class="pre">MolSysMT</span></code> will be reported in this guide.</p>
<p>The different options of the method <code class="docutils literal notranslate"><span class="pre">molsysmt.distance()</span></code> will be shown, little by little, along with the following examples.</p>
<div class="section" id="The-XYZ-molecular-system-form">
<h2>The XYZ molecular system form<a class="headerlink" href="#The-XYZ-molecular-system-form" title="Permalink to this headline">¶</a></h2>
<p>The first case, and the most simple one, is getting distances from a points distribution in space. MolSysMT accepts a molecular system form where only spatial coordinates are described, with out topological information: the <code class="docutils literal notranslate"><span class="pre">XYZ</span></code> form.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">molecular_system</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="mi">6</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;float64&#39;</span><span class="p">)</span> <span class="o">*</span> <span class="n">unit</span><span class="o">.</span><span class="n">nanometers</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">msm</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">molecular_system</span><span class="p">,</span> <span class="n">target</span><span class="o">=</span><span class="s1">&#39;system&#39;</span><span class="p">,</span> <span class="n">form</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&#39;XYZ&#39;
</pre></div></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">XYZ</span></code> form accepts numpy arrays with length units of the shape <span class="math notranslate nohighlight">\([n\_frames, n\_atoms, 3]\)</span> or <span class="math notranslate nohighlight">\([n\_atoms, 3]\)</span>. In case of having an array of rank 2, MolSysMT always understands <span class="math notranslate nohighlight">\(n\_frames=1\)</span> and the first rank as the number of atoms:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">msm</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">molecular_system</span><span class="p">,</span> <span class="n">n_frames</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">n_atoms</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[1, 6]
</pre></div></div>
</div>
<p>Lets create a couple of <code class="docutils literal notranslate"><span class="pre">XYZ</span></code> molecular systems with more than a frame. These two systems will help us illustrate the firts distance calculations:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Molecular system A with three atoms and three frames.</span>

<span class="n">molecular_system_A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;float64&#39;</span><span class="p">)</span> <span class="o">*</span> <span class="n">unit</span><span class="o">.</span><span class="n">nanometers</span>

<span class="c1">## First atom</span>
<span class="n">molecular_system_A</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,:]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">unit</span><span class="o">.</span><span class="n">nanometers</span>
<span class="n">molecular_system_A</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,:]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">unit</span><span class="o">.</span><span class="n">nanometers</span>
<span class="n">molecular_system_A</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,:]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">unit</span><span class="o">.</span><span class="n">nanometers</span>

<span class="c1">## Second atom</span>
<span class="n">molecular_system_A</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,:]</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">unit</span><span class="o">.</span><span class="n">nanometers</span>
<span class="n">molecular_system_A</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,:]</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">unit</span><span class="o">.</span><span class="n">nanometers</span>
<span class="n">molecular_system_A</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,:]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">unit</span><span class="o">.</span><span class="n">nanometers</span>

<span class="c1">## Third atom</span>
<span class="n">molecular_system_A</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,:]</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">unit</span><span class="o">.</span><span class="n">nanometers</span>
<span class="n">molecular_system_A</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,:]</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">unit</span><span class="o">.</span><span class="n">nanometers</span>
<span class="n">molecular_system_A</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,:]</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">unit</span><span class="o">.</span><span class="n">nanometers</span>



<span class="c1"># Molecular system B with two atoms and three frames.</span>

<span class="n">molecular_system_B</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;float64&#39;</span><span class="p">)</span> <span class="o">*</span> <span class="n">unit</span><span class="o">.</span><span class="n">nanometers</span>

<span class="c1">## First atom of B</span>
<span class="n">molecular_system_B</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,:]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">unit</span><span class="o">.</span><span class="n">nanometers</span>
<span class="n">molecular_system_B</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,:]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">unit</span><span class="o">.</span><span class="n">nanometers</span>
<span class="n">molecular_system_B</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,:]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">unit</span><span class="o">.</span><span class="n">nanometers</span>

<span class="c1">## Second atom of B</span>
<span class="n">molecular_system_B</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,:]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">unit</span><span class="o">.</span><span class="n">nanometers</span>
<span class="n">molecular_system_B</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,:]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">unit</span><span class="o">.</span><span class="n">nanometers</span>
<span class="n">molecular_system_B</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,:]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">unit</span><span class="o">.</span><span class="n">nanometers</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Distance-between-atoms-in-space">
<h2>Distance between atoms in space<a class="headerlink" href="#Distance-between-atoms-in-space" title="Permalink to this headline">¶</a></h2>
<div class="section" id="Distance-between-atoms-of-a-system">
<h3>Distance between atoms of a system<a class="headerlink" href="#Distance-between-atoms-of-a-system" title="Permalink to this headline">¶</a></h3>
<p>The first case shows how to get the distance between all points of a system at every frame</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">distances</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">distance</span><span class="p">(</span><span class="n">molecular_system_A</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>The result is an array of rank 3. Where the first axe or rank corresponds to the number of frames and the other two, the second and third axe, accounts for the point or atom indices:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">distances</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(3, 3, 3)
</pre></div></div>
</div>
<p>This way every distance between atoms at each frame is stored. Lets print out the distance between the 0-th and the 2-th atom at frame 1-th:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Distance at frame 1-th between atoms 0-th and 2-th: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">distances</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Distance at frame 1-th between atoms 0-th and 2-th: 3.7416573867739413 nm
</pre></div></div>
</div>
<p>If only the distance between atoms 0-th and 2-th at every frame is required, there is no need to compute <span class="math notranslate nohighlight">\(n\_atoms x n\_atoms\)</span> distances. The input arguments <code class="docutils literal notranslate"><span class="pre">selection_1</span></code> and <code class="docutils literal notranslate"><span class="pre">selection_2</span></code> help us to define the range of elements of the output distance matrix:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">distances</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">distance</span><span class="p">(</span><span class="n">molecular_system_A</span><span class="p">,</span> <span class="n">selection_1</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">selection_2</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>This time the output is an array of rank 3 with shape <span class="math notranslate nohighlight">\([3,1,1]\)</span>. The distance for just a pair of atoms was computed for three frames:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">distances</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(3, 1, 1)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Distance at frame </span><span class="si">{}</span><span class="s1">-th between atoms 0-th and 2-th: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ii</span><span class="p">,</span><span class="n">distances</span><span class="p">[</span><span class="n">ii</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Distance at frame 0-th between atoms 0-th and 2-th: 3.4641016151377544 nm
Distance at frame 1-th between atoms 0-th and 2-th: 3.7416573867739413 nm
Distance at frame 2-th between atoms 0-th and 2-th: 1.7320508075688772 nm
</pre></div></div>
</div>
<p>Lets try now to get the distance between the atom 1-th and the atoms 0-th and 2-th at every frame:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">distances</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">distance</span><span class="p">(</span><span class="n">molecular_system_A</span><span class="p">,</span> <span class="n">selection_1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">selection_2</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
</pre></div>
</div>
</div>
<p>As you will guess, the output matrix is an array of rank three this time with shape <span class="math notranslate nohighlight">\([3,1,2]\)</span>:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">distances</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(3, 1, 2)
</pre></div></div>
</div>
<p>If we want now to print out the distance between atoms 1-th and 2-th for frame 0-th:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Distance at frame 0-th between atoms 1-th and 2-th: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">distances</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Distance at frame 0-th between atoms 1-th and 2-th: 1.4142135623730951 nm
</pre></div></div>
</div>
<p>The position of each atom in lists <code class="docutils literal notranslate"><span class="pre">selection_1</span></code> and <code class="docutils literal notranslate"><span class="pre">selection_2</span></code> is used to locate the corresponding distance in the output array. If instead, you want to use the original atom indices to locate a distance, the input argument <code class="docutils literal notranslate"><span class="pre">output_form='dict'</span></code> can help:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">distances</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">distance</span><span class="p">(</span><span class="n">molecular_system_A</span><span class="p">,</span> <span class="n">selection_1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">selection_2</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="n">output_form</span><span class="o">=</span><span class="s1">&#39;dict&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>This way the output is no longer a numpy array of rank 3, the output object is now a dictionary of dictionaries of dictionaries. Where the set keys of the first dictionary corresponds to the atom indices of <code class="docutils literal notranslate"><span class="pre">selection_1</span></code>:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">distances</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
dict_keys([1])
</pre></div></div>
</div>
<p>The second nested dictionary has the atom indices of <code class="docutils literal notranslate"><span class="pre">selection_2</span></code> as keys:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">distances</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
dict_keys([0, 2])
</pre></div></div>
</div>
<p>And the third and last nested dictionary is defined with the frame indices as keys:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">distances</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
dict_keys([0, 1, 2])
</pre></div></div>
</div>
<p>Thus, the distance now between atoms 0-th and 2-th in frame 1-th is:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Distance at frame 0-th between atoms 1-th and 2-th: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">distances</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Distance at frame 0-th between atoms 1-th and 2-th: 1.4142135623730951 nm
</pre></div></div>
</div>
<p>Just like <code class="docutils literal notranslate"><span class="pre">selection_1</span></code> and <code class="docutils literal notranslate"><span class="pre">selection_2</span></code> can limit the range of atom indices of the calculation, <code class="docutils literal notranslate"><span class="pre">frame_indices_1</span></code> can be used to define the list of frames where the method applies:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">distances</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">distance</span><span class="p">(</span><span class="n">molecular_system_A</span><span class="p">,</span> <span class="n">selection_1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">selection_2</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="n">frame_indices_1</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Distance at frame 2-th between atoms 1-th and 2-th: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">distances</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Distance at frame 2-th between atoms 1-th and 2-th: 1.7320508075688772 nm
</pre></div></div>
</div>
<p>You can check again that with <code class="docutils literal notranslate"><span class="pre">output_form='dict'</span></code> the original indics for atoms and frames work to locate a distance:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">distances</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">distance</span><span class="p">(</span><span class="n">molecular_system_A</span><span class="p">,</span> <span class="n">selection_1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">selection_2</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="n">frame_indices_1</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="n">output_form</span><span class="o">=</span><span class="s1">&#39;dict&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Distance at frame 2-th between atoms 1-th and 2-th: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">distances</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">][</span><span class="mi">2</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Distance at frame 2-th between atoms 1-th and 2-th: 1.7320508075688772 nm
</pre></div></div>
</div>
</div>
<div class="section" id="Distance-between-atoms-of-two-systems">
<h3>Distance between atoms of two systems<a class="headerlink" href="#Distance-between-atoms-of-two-systems" title="Permalink to this headline">¶</a></h3>
<p>The second case shows how to get the distance between atoms of two systems at every frame</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">distances</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">distance</span><span class="p">(</span><span class="n">item_1</span><span class="o">=</span><span class="n">molecular_system_A</span><span class="p">,</span> <span class="n">item_2</span><span class="o">=</span><span class="n">molecular_system_B</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>As it was shown previously, the result is an array of rank 3. Again, where the first axe or rank corresponds to the number of frames and the other two, the second and third axe, accounts for the atom indices -this time in each system-:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[26]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">distances</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[26]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(3, 3, 2)
</pre></div></div>
</div>
<p>Lets print out the distance between atom 1-th of <code class="docutils literal notranslate"><span class="pre">molecular_system_A</span></code> and atom 0-th of <code class="docutils literal notranslate"><span class="pre">molecular_system_B</span></code> at every frame:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[27]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Distance at frame </span><span class="si">{}</span><span class="s1">-th between atom 1-th of A and atom 0-th of B: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ii</span><span class="p">,</span><span class="n">distances</span><span class="p">[</span><span class="n">ii</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Distance at frame 0-th between atom 1-th of A and atom 0-th of B: 5.916079783099616 nm
Distance at frame 1-th between atom 1-th of A and atom 0-th of B: 6.6332495807108 nm
Distance at frame 2-th between atom 1-th of A and atom 0-th of B: 5.477225575051661 nm
</pre></div></div>
</div>
<p>Now that <code class="docutils literal notranslate"><span class="pre">item_1</span></code> and <code class="docutils literal notranslate"><span class="pre">item_2</span></code> contain different systems, <code class="docutils literal notranslate"><span class="pre">selection_1</span></code> and <code class="docutils literal notranslate"><span class="pre">selection_2</span></code> do not work over the same system as in previous subsection, but over each molecular system (<code class="docutils literal notranslate"><span class="pre">selection_1</span></code> over <code class="docutils literal notranslate"><span class="pre">item_1</span></code> and <code class="docutils literal notranslate"><span class="pre">selection_2</span></code> over <code class="docutils literal notranslate"><span class="pre">item_2</span></code>). Lets get the distance only between atom 1-th of <code class="docutils literal notranslate"><span class="pre">molecular_system_A</span></code> and atom 0-th of <code class="docutils literal notranslate"><span class="pre">molecular_system_B</span></code> for every frame:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[28]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">distances</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">distance</span><span class="p">(</span><span class="n">item_1</span><span class="o">=</span><span class="n">molecular_system_A</span><span class="p">,</span> <span class="n">selection_1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">item_2</span><span class="o">=</span><span class="n">molecular_system_B</span><span class="p">,</span> <span class="n">selection_2</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[29]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">distances</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[29]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(3, 1, 1)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[30]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Distance at frame </span><span class="si">{}</span><span class="s1">-th between atom 1-th of A and atom 0-th of B: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ii</span><span class="p">,</span><span class="n">distances</span><span class="p">[</span><span class="n">ii</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Distance at frame 0-th between atom 1-th of A and atom 0-th of B: 5.916079783099616 nm
Distance at frame 1-th between atom 1-th of A and atom 0-th of B: 6.6332495807108 nm
Distance at frame 2-th between atom 1-th of A and atom 0-th of B: 5.477225575051661 nm
</pre></div></div>
</div>
<p>Again, the input argument <code class="docutils literal notranslate"><span class="pre">output_form='dict'</span></code> lets us play with the original indices in the output object. As it was described in the previous subsection, this dictionary of dictionaries of dictionaries has three keys: the first one corresponds to the atom indices of <code class="docutils literal notranslate"><span class="pre">item_1</span></code>, the second one corresponds to the atom indices of <code class="docutils literal notranslate"><span class="pre">item_2</span></code> and the third one to the frame indices. This way the distance now between atom 1-th of <code class="docutils literal notranslate"><span class="pre">molecular_system_A</span></code> and atom 0-th of <code class="docutils literal notranslate"><span class="pre">molecular_system_B</span></code> at
frame 1-th:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[31]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">distances</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">distance</span><span class="p">(</span><span class="n">item_1</span><span class="o">=</span><span class="n">molecular_system_A</span><span class="p">,</span> <span class="n">selection_1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">frame_indices_1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                         <span class="n">item_2</span><span class="o">=</span><span class="n">molecular_system_B</span><span class="p">,</span> <span class="n">selection_2</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">output_form</span><span class="o">=</span><span class="s1">&#39;dict&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[32]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Distance at frame 1-th between atom 1-th of A and atom 0-th of B: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">distances</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Distance at frame 1-th between atom 1-th of A and atom 0-th of B: 6.6332495807108 nm
</pre></div></div>
</div>
<p>Notice that <code class="docutils literal notranslate"><span class="pre">frame_indices_1</span></code> was used to define the frame indices where the distance is computed. If only <code class="docutils literal notranslate"><span class="pre">frame_indices_1</span></code> is used, the same list of indices is used sequentially for both systems <code class="docutils literal notranslate"><span class="pre">item_1</span></code> and <code class="docutils literal notranslate"><span class="pre">item_2</span></code>:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[33]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">distances_1</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">distance</span><span class="p">(</span><span class="n">item_1</span><span class="o">=</span><span class="n">molecular_system_A</span><span class="p">,</span> <span class="n">selection_1</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="n">frame_indices_1</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span>
                           <span class="n">item_2</span><span class="o">=</span><span class="n">molecular_system_B</span><span class="p">,</span> <span class="n">selection_2</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[34]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">distances_2</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">distance</span><span class="p">(</span><span class="n">item_1</span><span class="o">=</span><span class="n">molecular_system_A</span><span class="p">,</span> <span class="n">selection_1</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="n">frame_indices_1</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span>
                           <span class="n">item_2</span><span class="o">=</span><span class="n">molecular_system_B</span><span class="p">,</span> <span class="n">selection_2</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">frame_indices_2</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[35]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">distances_1</span> <span class="o">==</span> <span class="n">distances_2</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[35]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([[[ True,  True],
        [ True,  True]],

       [[ True,  True],
        [ True,  True]]])
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[36]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Distance at frame 2-th between atom 2-th of A and atom 1-th of B: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">distances_1</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Distance at frame 2-th between atom 2-th of A and atom 1-th of B: 5.0990195135927845 nm
</pre></div></div>
</div>
</div>
<div class="section" id="Distances-between-atoms-positions-in-different-frames">
<h3>Distances between atoms positions in different frames<a class="headerlink" href="#Distances-between-atoms-positions-in-different-frames" title="Permalink to this headline">¶</a></h3>
<p>At the end of last subsection we saw how, in addition to the input arguments <code class="docutils literal notranslate"><span class="pre">selection_1</span></code> and <code class="docutils literal notranslate"><span class="pre">selection_2</span></code>, the input arguments <code class="docutils literal notranslate"><span class="pre">frame_indices_1</span></code> and <code class="docutils literal notranslate"><span class="pre">frame_indices_2</span></code> alter the way distances are computed. Lets use the four arguments in the next example to revisit their function:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[37]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">distances</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">distance</span><span class="p">(</span><span class="n">item_1</span><span class="o">=</span><span class="n">molecular_system_A</span><span class="p">,</span> <span class="n">selection_1</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="n">frame_indices_1</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span>
                         <span class="n">item_2</span><span class="o">=</span><span class="n">molecular_system_B</span><span class="p">,</span> <span class="n">selection_2</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">frame_indices_2</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
</pre></div>
</div>
</div>
<p>The distance between atoms 1-th and 2-th of <code class="docutils literal notranslate"><span class="pre">molecular_system_A</span></code> and atom 1-th of <code class="docutils literal notranslate"><span class="pre">molecular_system_B</span></code> are computed. But, these distances are not between spatial positions in the same frame index. When two frame indices lists are provided by means of <code class="docutils literal notranslate"><span class="pre">frame_indices_1</span></code> and <code class="docutils literal notranslate"><span class="pre">frame_indices_2</span></code>, pairs of frames are taken sequentially. In this case positions of <code class="docutils literal notranslate"><span class="pre">item_1</span></code> at frame 0-th are confronted againts positions of <code class="docutils literal notranslate"><span class="pre">item_2</span></code> at frame 1-th, and the results are stored in the first frame
of the distances output. Then, according to the last cell frame indices, positions of <code class="docutils literal notranslate"><span class="pre">item_1</span></code> at frame 1-th are confronted againts positions of <code class="docutils literal notranslate"><span class="pre">item_2</span></code> at frame 2-th. Thus, lets print out for example the distance between the position of atom 2-th of <code class="docutils literal notranslate"><span class="pre">item_1</span></code> in frame 1-th and the position of atom 1-th of <code class="docutils literal notranslate"><span class="pre">item_2</span></code> in frame 2-th:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[38]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The distance between atom 2-th of A at frame 1-th and atom 1-th of B at frame 2-th is: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">distances</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
The distance between atom 2-th of A at frame 1-th and atom 1-th of B at frame 2-th is: 6.164414002968976 nm
</pre></div></div>
</div>
<p>In this case, when the output object is a dictionary of dictionaries of dictionaries, the last nested keys correspond to the frame indices in <code class="docutils literal notranslate"><span class="pre">frame_indices_1</span></code>. Lets compute de same distances as before printing out the same specific distance:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[39]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">distances</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">distance</span><span class="p">(</span><span class="n">item_1</span><span class="o">=</span><span class="n">molecular_system_A</span><span class="p">,</span> <span class="n">selection_1</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="n">frame_indices_1</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span>
                         <span class="n">item_2</span><span class="o">=</span><span class="n">molecular_system_B</span><span class="p">,</span> <span class="n">selection_2</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">frame_indices_2</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="n">output_form</span><span class="o">=</span><span class="s1">&#39;dict&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[40]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The distance between atom 2-th of A at frame 1-th and atom 1-th of B at frame 2-th is: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">distances</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
The distance between atom 2-th of A at frame 1-th and atom 1-th of B at frame 2-th is: 6.164414002968976 nm
</pre></div></div>
</div>
<p>The possibility to calculate distances between crossing frame indices opens the door to get displacement lengths as it is shown in next subsection.</p>
</div>
<div class="section" id="Displacement-distances-of-atoms">
<h3>Displacement distances of atoms<a class="headerlink" href="#Displacement-distances-of-atoms" title="Permalink to this headline">¶</a></h3>
<p>When both input arguments <code class="docutils literal notranslate"><span class="pre">frame_indices_1</span></code> and <code class="docutils literal notranslate"><span class="pre">frame_indices_2</span></code> are used over a unique set of atoms of the same molecular system, the distances computed acquired a simple physical meaning: displacements. Lets see the following case:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[41]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">distances</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">distance</span><span class="p">(</span><span class="n">item_1</span><span class="o">=</span><span class="n">molecular_system_A</span><span class="p">,</span> <span class="n">selection_1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">frame_indices_1</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">frame_indices_2</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
</pre></div>
</div>
</div>
<p>The shape of the output object is:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[42]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">distances</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[42]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(2, 1, 1)
</pre></div></div>
</div>
<p>The length of the distance walked by atom 1-th of <code class="docutils literal notranslate"><span class="pre">molecular_system_A</span></code> between frames 0-th and 1-th is:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[43]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The displacement length of atom 1-th between frames 0-th and 1th is: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">distances</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
The displacement length of atom 1-th between frames 0-th and 1th is: 1.0 nm
</pre></div></div>
</div>
<p>While the displacement length of the same atom between the next two consecutive frames is:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[44]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The displacement length of atom 1-th between frames 1-th and 2-th is: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">distances</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
The displacement length of atom 1-th between frames 1-th and 2-th is: 1.0 nm
</pre></div></div>
</div>
<p>If we want to get the length distance an atom moves between a fixed frame, 0-th for instance, and the rest of frames we can invoke the command <code class="docutils literal notranslate"><span class="pre">molsysmt.distance()</span></code> this way:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[45]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">distances</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">distance</span><span class="p">(</span><span class="n">item_1</span><span class="o">=</span><span class="n">molecular_system_A</span><span class="p">,</span> <span class="n">selection_1</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">frame_indices_1</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="n">frame_indices_2</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
                         <span class="n">output_form</span><span class="o">=</span><span class="s1">&#39;dict&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>The displacement length of atom 1-th between its position at frame 0-th and all other frames is:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[46]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The displacement length of atom 1-th between frames 0-th and </span><span class="si">{}</span><span class="s1">-th is: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ii</span><span class="p">,</span> <span class="n">distances</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="n">ii</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
The displacement length of atom 1-th between frames 0-th and 0-th is: 0.0 nm
The displacement length of atom 1-th between frames 0-th and 1-th is: 1.0 nm
The displacement length of atom 1-th between frames 0-th and 2-th is: 1.4142135623730951 nm
</pre></div></div>
</div>
</div>
<div class="section" id="Distance-between-atoms-pairs">
<h3>Distance between atoms pairs<a class="headerlink" href="#Distance-between-atoms-pairs" title="Permalink to this headline">¶</a></h3>
<p>When the method <code class="docutils literal notranslate"><span class="pre">molsysmt.distance()</span></code> is invoked to calculate the distances between a set of <span class="math notranslate nohighlight">\(N\)</span> atoms of <code class="docutils literal notranslate"><span class="pre">item_1</span></code> and a set of <span class="math notranslate nohighlight">\(M\)</span> atoms of <code class="docutils literal notranslate"><span class="pre">item_2</span></code>, the result is an object, a numpy array or a dictionary, with <span class="math notranslate nohighlight">\(N x M\)</span> distances per frame. Sometimes all these different distances are not needed, but only those between specific atom pairs. These atom pairs can be given by the elements in <code class="docutils literal notranslate"><span class="pre">selection_1</span></code> and <code class="docutils literal notranslate"><span class="pre">selection_2</span></code> coupled sequantially one to one. This option is
activated when the input argument <code class="docutils literal notranslate"><span class="pre">pairs=True</span></code>:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[47]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">distances</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">distance</span><span class="p">(</span><span class="n">item_1</span><span class="o">=</span><span class="n">molecular_system_A</span><span class="p">,</span> <span class="n">selection_1</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">selection_2</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span>
                         <span class="n">frame_indices_1</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="n">pairs</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>When <code class="docutils literal notranslate"><span class="pre">pairs=True</span></code> the shape of the output numpy array is <span class="math notranslate nohighlight">\([n\_frames, N]\)</span>, where <span class="math notranslate nohighlight">\(N\)</span> is the number of pairs: [0,1], [0,2] and [1,2], in this case.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[48]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">distances</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[48]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(2, 3)
</pre></div></div>
</div>
<p>Lets print out the distance between atoms 0-th and 2-th in frame 1-th:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[49]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The distance between the pair of atoms 0-th and 2-th in frame 1-th: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">distances</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
The distance between the pair of atoms 0-th and 2-th in frame 1-th: 3.7416573867739413 nm
</pre></div></div>
</div>
<p>The dictionary output form also works for atom pairs in the same way as with <code class="docutils literal notranslate"><span class="pre">pairs=False</span></code>:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[50]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">distances</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">distance</span><span class="p">(</span><span class="n">item_1</span><span class="o">=</span><span class="n">molecular_system_A</span><span class="p">,</span> <span class="n">selection_1</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">selection_2</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span>
                         <span class="n">frame_indices_1</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="n">pairs</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">output_form</span><span class="o">=</span><span class="s1">&#39;dict&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[51]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The distance between the pair of atoms 0-th and 2-th in frame 1-th: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">distances</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">][</span><span class="mi">1</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
The distance between the pair of atoms 0-th and 2-th in frame 1-th: 3.7416573867739413 nm
</pre></div></div>
</div>
</div>
<div class="section" id="Minimum-and-Maximum-distance">
<h3>Minimum and Maximum distance<a class="headerlink" href="#Minimum-and-Maximum-distance" title="Permalink to this headline">¶</a></h3>
<p>Sometimes the minimum and maximum distance between two sets of atoms needs to be obtained. Although this step could be done with the method <code class="docutils literal notranslate"><span class="pre">molsysmt.distance()</span></code> and a little coding, MolSysMT includes two methods to make it even easier: <code class="docutils literal notranslate"><span class="pre">molsysmt.minimum_distance()</span></code> and <code class="docutils literal notranslate"><span class="pre">molsysmt.maximum_distance()</span></code>. Lets see in the following cells how they work.</p>
<p>As first example, lets get the minimum distance between both molecular systems A and B:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[52]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">min_pairs</span><span class="p">,</span> <span class="n">min_distances</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">minimum_distance</span><span class="p">(</span><span class="n">item_1</span><span class="o">=</span><span class="n">molecular_system_A</span><span class="p">,</span> <span class="n">item_2</span><span class="o">=</span><span class="n">molecular_system_B</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>The result is offered as two numpy arrays: the list of atoms pairs minimizing the distance for each frame, and the corresponding value of the minimum distance (for each frame also).</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[53]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">min_pairs</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[53]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(3, 2)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[54]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">min_pairs</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[54]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([[0, 1],
       [0, 1],
       [1, 1]])
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[55]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">min_distances</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[55]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(3,)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[56]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">min_distances</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[56]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Quantity(value=array([3.60555128, 2.44948974, 4.12310563]), unit=nanometer)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[57]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The minimum distance in frame 2-th is given by atom </span><span class="si">{}</span><span class="s1">-th of A and atom </span><span class="si">{}</span><span class="s1">-th of B: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">min_pairs</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">min_pairs</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">min_distances</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
The minimum distance in frame 2-th is given by atom 1-th of A and atom 1-th of B: 4.123105625617661 nm
</pre></div></div>
</div>
<p>All input arguments described in previous subsections can also be used with <code class="docutils literal notranslate"><span class="pre">molsysmt.minimum_distance()</span></code> and <code class="docutils literal notranslate"><span class="pre">molsysmt.maximum_distance()</span></code>. Lets see an example:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[58]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">min_pairs</span><span class="p">,</span> <span class="n">min_distances</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">minimum_distance</span><span class="p">(</span><span class="n">item_1</span><span class="o">=</span><span class="n">molecular_system_A</span><span class="p">,</span> <span class="n">selection_1</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="n">selection_2</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span>
                                               <span class="n">frame_indices_1</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">frame_indices_2</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="n">pairs</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Remember that with <code class="docutils literal notranslate"><span class="pre">pairs=True</span></code>, the output does not longer refer atoms indices but pairs indices. That is the reason why the shape of min_pairs is now:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[59]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">min_pairs</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[59]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(2,)
</pre></div></div>
</div>
<p>While,</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[60]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">min_distances</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[60]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(2,)
</pre></div></div>
</div>
<p>Which means that the minimum displacement between consecutive frames was observed for:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[61]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Atom </span><span class="si">{}</span><span class="s1">-th had the minimum displacement of A between frames </span><span class="si">{}</span><span class="s1">-th and </span><span class="si">{}</span><span class="s1">-th: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">min_pairs</span><span class="p">[</span><span class="n">ii</span><span class="p">],</span> <span class="n">ii</span><span class="p">,</span> <span class="n">ii</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">min_distances</span><span class="p">[</span><span class="n">ii</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Atom 0-th had the minimum displacement of A between frames 0-th and 1-th: 1.0 nm
Atom 0-th had the minimum displacement of A between frames 1-th and 2-th: 1.0 nm
</pre></div></div>
</div>
<p>There are situations in which we have a list of atoms of a set A and the minimum distance with a second set of atoms B needs to be known for every single atom of A. In this case the first set has to be considered not as entity (as set) in view of getting a single minimum distance. Lets illustrate this with an example:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[62]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">min_pairs</span><span class="p">,</span> <span class="n">min_distances</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">minimum_distance</span><span class="p">(</span><span class="n">item_1</span><span class="o">=</span><span class="n">molecular_system_A</span><span class="p">,</span> <span class="n">selection_1</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="n">frame_indices_1</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span>
                                                <span class="n">item_2</span><span class="o">=</span><span class="n">molecular_system_B</span><span class="p">,</span> <span class="n">selection_2</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span>
                                                <span class="n">as_entity_1</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">as_entity_2</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>The output corresponds to the minimum distance of atom 1-th of A to any atom of B and the minimum distance of atom 2-th of A to any atom of B, at every frame:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[63]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">min_pairs</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[63]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(3, 2)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[64]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">min_distances</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[64]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(3, 2)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[65]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">selection_2</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Atom 1-th of A has the minimum distance to B with its atom </span><span class="si">{}</span><span class="s1">-th in frame 1-th: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">selection_2</span><span class="p">[</span><span class="n">min_pairs</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]],</span> <span class="n">min_distances</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Atom 1-th of A has the minimum distance to B with its atom 1-th in frame 1-th: 4.242640687119285 nm
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[66]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The </span><span class="si">{}</span><span class="s1">-th is the closest atom of B to atom 1-th of A at frame </span><span class="si">{}</span><span class="s1">-th with </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">selection_2</span><span class="p">[</span><span class="n">min_pairs</span><span class="p">[</span><span class="n">ii</span><span class="p">,</span><span class="mi">0</span><span class="p">]],</span><span class="n">ii</span><span class="p">,</span> <span class="n">min_distances</span><span class="p">[</span><span class="n">ii</span><span class="p">,</span><span class="mi">0</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
The 1-th is the closest atom of B to atom 1-th of A at frame 0-th with 4.58257569495584 nm
The 1-th is the closest atom of B to atom 1-th of A at frame 1-th with 4.242640687119285 nm
The 1-th is the closest atom of B to atom 1-th of A at frame 2-th with 4.123105625617661 nm
</pre></div></div>
</div>
</div>
</div>
<div class="section" id="Distance-between-atom-groups-in-space">
<h2>Distance between atom groups in space<a class="headerlink" href="#Distance-between-atom-groups-in-space" title="Permalink to this headline">¶</a></h2>
<p>Imagine the distance between geometric centers of atoms groups needs to be obtained. There is no reason why MolSysMT should have new functions to do that. Every method introduced in the previous section, about getting distances between atoms, has the possibility to do it over groups of atoms.</p>
<div class="section" id="Distance-between-atom-groups-of-a-system">
<h3>Distance between atom groups of a system<a class="headerlink" href="#Distance-between-atom-groups-of-a-system" title="Permalink to this headline">¶</a></h3>
<p>Lets load a new molecular system to illustrate how <code class="docutils literal notranslate"><span class="pre">molsysmt.distance()</span></code> can get distances between atom groups:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[67]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">molecular_system</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span><span class="s1">&#39;mmtf:1TCD&#39;</span><span class="p">,</span> <span class="s1">&#39;molsysmt.MolSys&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[68]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">msm</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">molecular_system</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[68]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<style  type="text/css" >
</style><table id="T_a1f60086_c881_11ea_85df_49c12f88b3e2" ><thead>    <tr>        <th class="col_heading level0 col0" >form</th>        <th class="col_heading level0 col1" >n_atoms</th>        <th class="col_heading level0 col2" >n_groups</th>        <th class="col_heading level0 col3" >n_components</th>        <th class="col_heading level0 col4" >n_chains</th>        <th class="col_heading level0 col5" >n_molecules</th>        <th class="col_heading level0 col6" >n_entities</th>        <th class="col_heading level0 col7" >n_waters</th>        <th class="col_heading level0 col8" >n_proteins</th>        <th class="col_heading level0 col9" >n_frames</th>    </tr></thead><tbody>
                <tr>
                                <td id="T_a1f60086_c881_11ea_85df_49c12f88b3e2row0_col0" class="data row0 col0" >molsysmt.MolSys</td>
                        <td id="T_a1f60086_c881_11ea_85df_49c12f88b3e2row0_col1" class="data row0 col1" >3983</td>
                        <td id="T_a1f60086_c881_11ea_85df_49c12f88b3e2row0_col2" class="data row0 col2" >662</td>
                        <td id="T_a1f60086_c881_11ea_85df_49c12f88b3e2row0_col3" class="data row0 col3" >167</td>
                        <td id="T_a1f60086_c881_11ea_85df_49c12f88b3e2row0_col4" class="data row0 col4" >4</td>
                        <td id="T_a1f60086_c881_11ea_85df_49c12f88b3e2row0_col5" class="data row0 col5" >166</td>
                        <td id="T_a1f60086_c881_11ea_85df_49c12f88b3e2row0_col6" class="data row0 col6" >2</td>
                        <td id="T_a1f60086_c881_11ea_85df_49c12f88b3e2row0_col7" class="data row0 col7" >165</td>
                        <td id="T_a1f60086_c881_11ea_85df_49c12f88b3e2row0_col8" class="data row0 col8" >1</td>
                        <td id="T_a1f60086_c881_11ea_85df_49c12f88b3e2row0_col9" class="data row0 col9" >1</td>
            </tr>
    </tbody></table></div>
</div>
<p>Lets revisit how to get the distances between two atoms selections to start with, then the effect of input arguments <code class="docutils literal notranslate"><span class="pre">group_behavior_1</span></code> and <code class="docutils literal notranslate"><span class="pre">group_behavior_2</span></code> will be shown:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[69]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">distances</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">distance</span><span class="p">(</span><span class="n">molecular_system</span><span class="p">,</span> <span class="n">selection_1</span><span class="o">=</span><span class="s2">&quot;group_index==0&quot;</span><span class="p">,</span>
                         <span class="n">selection_2</span><span class="o">=</span><span class="s2">&quot;group_index==1&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>This molecular system has onle a single frame, so the shape of the output array is <span class="math notranslate nohighlight">\([1, n\_atoms\_1, n\_atoms\_2]\)</span> where <span class="math notranslate nohighlight">\(n\_atoms\_1\)</span> and <span class="math notranslate nohighlight">\(n\_atoms\_2\)</span> is the number of atoms in <code class="docutils literal notranslate"><span class="pre">selection_1</span></code> and <code class="docutils literal notranslate"><span class="pre">selection_2</span></code>, respectively:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[70]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">n_atoms_1</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">molecular_system</span><span class="p">,</span> <span class="n">selection</span><span class="o">=</span><span class="s2">&quot;group_index==0&quot;</span><span class="p">,</span> <span class="n">n_atoms</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">n_atoms_2</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">molecular_system</span><span class="p">,</span> <span class="n">selection</span><span class="o">=</span><span class="s2">&quot;group_index==1&quot;</span><span class="p">,</span> <span class="n">n_atoms</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">n_atoms_1</span><span class="p">,</span> <span class="n">n_atoms_2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
9 7
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[71]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">distances</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[71]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(1, 9, 7)
</pre></div></div>
</div>
<p>Now, lets use <code class="docutils literal notranslate"><span class="pre">group_behavior_1=&quot;geometric_center&quot;</span></code> to obtain the distance between the geometric center of the set of atoms in <code class="docutils literal notranslate"><span class="pre">selection_1</span></code> to every atom in <code class="docutils literal notranslate"><span class="pre">selection_2</span></code>.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[72]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">distances</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">distance</span><span class="p">(</span><span class="n">molecular_system</span><span class="p">,</span> <span class="n">selection_1</span><span class="o">=</span><span class="s2">&quot;group_index==0&quot;</span><span class="p">,</span>
                         <span class="n">group_behavior_1</span><span class="o">=</span><span class="s2">&quot;geometric_center&quot;</span><span class="p">,</span>
                         <span class="n">selection_2</span><span class="o">=</span><span class="s2">&quot;group_index==1&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[73]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">distances</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[73]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(1, 1, 7)
</pre></div></div>
</div>
<p>And with <code class="docutils literal notranslate"><span class="pre">group_behavior_2=&quot;geometric_center&quot;</span></code> the distance between both geometric centers can be obtain:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[74]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">distances</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">distance</span><span class="p">(</span><span class="n">molecular_system</span><span class="p">,</span> <span class="n">selection_1</span><span class="o">=</span><span class="s2">&quot;group_index==0&quot;</span><span class="p">,</span>
                         <span class="n">group_behavior_1</span><span class="o">=</span><span class="s2">&quot;geometric_center&quot;</span><span class="p">,</span>
                         <span class="n">selection_2</span><span class="o">=</span><span class="s2">&quot;group_index==1&quot;</span><span class="p">,</span>
                         <span class="n">group_behavior_2</span><span class="o">=</span><span class="s2">&quot;geometric_center&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[75]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">distances</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[75]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(1, 1, 1)
</pre></div></div>
</div>
<p>The input arguments <code class="docutils literal notranslate"><span class="pre">group_behavior_1</span></code> and <code class="docutils literal notranslate"><span class="pre">group_behavior_2</span></code> allow us to work with a unique position of a group of atoms, either the geometric center or the center of mass. But what happens then if we have several groups of atoms? The arguments <code class="docutils literal notranslate"><span class="pre">selection_1</span></code> and <code class="docutils literal notranslate"><span class="pre">selection_2</span></code> do work with just a list of atom indices or a selection sentence. Thats why we have to use two new input arguments: <code class="docutils literal notranslate"><span class="pre">groups_of_atoms_1</span></code> and <code class="docutils literal notranslate"><span class="pre">groups_of_atoms_2</span></code>. Lets define a couple of list of lists of atom
indices to illustrate their use.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[76]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">list_groups_1</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">molecular_system</span><span class="p">,</span> <span class="n">target</span><span class="o">=</span><span class="s2">&quot;group&quot;</span><span class="p">,</span>
                        <span class="n">selection</span><span class="o">=</span><span class="s2">&quot;group_index in [0,1,2,3]&quot;</span><span class="p">,</span> <span class="n">atom_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">list_groups_2</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">molecular_system</span><span class="p">,</span> <span class="n">target</span><span class="o">=</span><span class="s2">&quot;group&quot;</span><span class="p">,</span>
                        <span class="n">selection</span><span class="o">=</span><span class="s2">&quot;group_index in [4,5,6,7,8]&quot;</span><span class="p">,</span> <span class="n">atom_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[77]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="n">list_groups_1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[array([0, 1, 2, 3, 4, 5, 6, 7, 8]) array([ 9, 10, 11, 12, 13, 14, 15])
 array([16, 17, 18, 19, 20, 21, 22, 23, 24])
 array([25, 26, 27, 28, 29, 30, 31])]
</pre></div></div>
</div>
<p>First, lets compute the distance between every single atom in <code class="docutils literal notranslate"><span class="pre">selection_1</span></code> to the geometric center of the atoms groups defined in <code class="docutils literal notranslate"><span class="pre">list_groups_2</span></code>:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[78]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">distances</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">distance</span><span class="p">(</span><span class="n">molecular_system</span><span class="p">,</span> <span class="n">selection_1</span><span class="o">=</span><span class="s2">&quot;group_index==0&quot;</span><span class="p">,</span>
                         <span class="n">groups_of_atoms_2</span><span class="o">=</span><span class="n">list_groups_2</span><span class="p">,</span> <span class="n">group_behavior_2</span><span class="o">=</span><span class="s2">&quot;geometric_center&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[79]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">distances</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[79]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(1, 9, 5)
</pre></div></div>
</div>
<p>Now, the distance between the geometric center of the set of atoms in <code class="docutils literal notranslate"><span class="pre">selection_1</span></code> and every geometric center of the atoms groups given by <code class="docutils literal notranslate"><span class="pre">list_groups_2</span></code>:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[80]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">distances</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">distance</span><span class="p">(</span><span class="n">molecular_system</span><span class="p">,</span> <span class="n">selection_1</span><span class="o">=</span><span class="s2">&quot;group_index==0&quot;</span><span class="p">,</span>
                         <span class="n">groups_of_atoms_2</span><span class="o">=</span><span class="n">list_groups_2</span><span class="p">,</span> <span class="n">group_behavior_1</span><span class="o">=</span><span class="s2">&quot;geometric_center&quot;</span><span class="p">,</span>
                         <span class="n">group_behavior_2</span><span class="o">=</span><span class="s2">&quot;geometric_center&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[81]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">distances</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[81]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(1, 1, 5)
</pre></div></div>
</div>
<p>And finnally, the distance between every geometric center of the atoms groups in <code class="docutils literal notranslate"><span class="pre">list_groups_1</span></code> to every geometric center of the atoms groups defined in <code class="docutils literal notranslate"><span class="pre">list_groups_2</span></code>:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[82]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">distances</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">distance</span><span class="p">(</span><span class="n">molecular_system</span><span class="p">,</span> <span class="n">groups_of_atoms_1</span><span class="o">=</span><span class="n">list_groups_1</span><span class="p">,</span>
                         <span class="n">groups_of_atoms_2</span><span class="o">=</span><span class="n">list_groups_2</span><span class="p">,</span> <span class="n">group_behavior_1</span><span class="o">=</span><span class="s2">&quot;geometric_center&quot;</span><span class="p">,</span>
                         <span class="n">group_behavior_2</span><span class="o">=</span><span class="s2">&quot;geometric_center&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[83]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">distances</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[83]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(1, 4, 5)
</pre></div></div>
</div>
<p>Just like with atoms, if only a list of atoms groups is used, the distance between its centers is obtained:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[84]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">distances</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">distance</span><span class="p">(</span><span class="n">molecular_system</span><span class="p">,</span> <span class="n">groups_of_atoms_1</span><span class="o">=</span><span class="n">list_groups_1</span><span class="p">,</span>
                         <span class="n">group_behavior_1</span><span class="o">=</span><span class="s2">&quot;geometric_center&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[85]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">distances</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[85]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(1, 4, 4)
</pre></div></div>
</div>
<p>Finnally, lets proof that the distance between groups can be computed all along a trajectory as well as only at specific frames. Lets load the whole trajectory ‘pentalanine.h5’:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[86]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">molecular_system</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">demo_systems</span><span class="o">.</span><span class="n">files</span><span class="p">[</span><span class="s1">&#39;pentalanine.h5&#39;</span><span class="p">]</span>
<span class="n">molecular_system</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span><span class="n">molecular_system</span><span class="p">,</span> <span class="n">to_form</span><span class="o">=</span><span class="s1">&#39;molsysmt.MolSys&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[87]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">msm</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">molecular_system</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[87]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<style  type="text/css" >
</style><table id="T_a294524a_c881_11ea_85df_49c12f88b3e2" ><thead>    <tr>        <th class="col_heading level0 col0" >form</th>        <th class="col_heading level0 col1" >n_atoms</th>        <th class="col_heading level0 col2" >n_groups</th>        <th class="col_heading level0 col3" >n_components</th>        <th class="col_heading level0 col4" >n_chains</th>        <th class="col_heading level0 col5" >n_molecules</th>        <th class="col_heading level0 col6" >n_entities</th>        <th class="col_heading level0 col7" >n_peptides</th>        <th class="col_heading level0 col8" >n_frames</th>    </tr></thead><tbody>
                <tr>
                                <td id="T_a294524a_c881_11ea_85df_49c12f88b3e2row0_col0" class="data row0 col0" >molsysmt.MolSys</td>
                        <td id="T_a294524a_c881_11ea_85df_49c12f88b3e2row0_col1" class="data row0 col1" >62</td>
                        <td id="T_a294524a_c881_11ea_85df_49c12f88b3e2row0_col2" class="data row0 col2" >7</td>
                        <td id="T_a294524a_c881_11ea_85df_49c12f88b3e2row0_col3" class="data row0 col3" >1</td>
                        <td id="T_a294524a_c881_11ea_85df_49c12f88b3e2row0_col4" class="data row0 col4" >1</td>
                        <td id="T_a294524a_c881_11ea_85df_49c12f88b3e2row0_col5" class="data row0 col5" >1</td>
                        <td id="T_a294524a_c881_11ea_85df_49c12f88b3e2row0_col6" class="data row0 col6" >1</td>
                        <td id="T_a294524a_c881_11ea_85df_49c12f88b3e2row0_col7" class="data row0 col7" >1</td>
                        <td id="T_a294524a_c881_11ea_85df_49c12f88b3e2row0_col8" class="data row0 col8" >5000</td>
            </tr>
    </tbody></table></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[88]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">msm</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">molecular_system</span><span class="p">,</span> <span class="n">target</span><span class="o">=</span><span class="s1">&#39;group&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[88]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<style  type="text/css" >
</style><table id="T_a29c9b80_c881_11ea_85df_49c12f88b3e2" ><thead>    <tr>        <th class="col_heading level0 col0" >index</th>        <th class="col_heading level0 col1" >id</th>        <th class="col_heading level0 col2" >name</th>        <th class="col_heading level0 col3" >type</th>        <th class="col_heading level0 col4" >n atoms</th>        <th class="col_heading level0 col5" >component index</th>        <th class="col_heading level0 col6" >chain index</th>        <th class="col_heading level0 col7" >molecule index</th>        <th class="col_heading level0 col8" >molecule type</th>        <th class="col_heading level0 col9" >entity index</th>        <th class="col_heading level0 col10" >entity name</th>    </tr></thead><tbody>
                <tr>
                                <td id="T_a29c9b80_c881_11ea_85df_49c12f88b3e2row0_col0" class="data row0 col0" >0</td>
                        <td id="T_a29c9b80_c881_11ea_85df_49c12f88b3e2row0_col1" class="data row0 col1" >1</td>
                        <td id="T_a29c9b80_c881_11ea_85df_49c12f88b3e2row0_col2" class="data row0 col2" >ACE</td>
                        <td id="T_a29c9b80_c881_11ea_85df_49c12f88b3e2row0_col3" class="data row0 col3" >aminoacid</td>
                        <td id="T_a29c9b80_c881_11ea_85df_49c12f88b3e2row0_col4" class="data row0 col4" >[6]</td>
                        <td id="T_a29c9b80_c881_11ea_85df_49c12f88b3e2row0_col5" class="data row0 col5" >0</td>
                        <td id="T_a29c9b80_c881_11ea_85df_49c12f88b3e2row0_col6" class="data row0 col6" >0</td>
                        <td id="T_a29c9b80_c881_11ea_85df_49c12f88b3e2row0_col7" class="data row0 col7" >0</td>
                        <td id="T_a29c9b80_c881_11ea_85df_49c12f88b3e2row0_col8" class="data row0 col8" >peptide</td>
                        <td id="T_a29c9b80_c881_11ea_85df_49c12f88b3e2row0_col9" class="data row0 col9" >0</td>
                        <td id="T_a29c9b80_c881_11ea_85df_49c12f88b3e2row0_col10" class="data row0 col10" >Peptide0</td>
            </tr>
            <tr>
                                <td id="T_a29c9b80_c881_11ea_85df_49c12f88b3e2row1_col0" class="data row1 col0" >1</td>
                        <td id="T_a29c9b80_c881_11ea_85df_49c12f88b3e2row1_col1" class="data row1 col1" >2</td>
                        <td id="T_a29c9b80_c881_11ea_85df_49c12f88b3e2row1_col2" class="data row1 col2" >ALA</td>
                        <td id="T_a29c9b80_c881_11ea_85df_49c12f88b3e2row1_col3" class="data row1 col3" >aminoacid</td>
                        <td id="T_a29c9b80_c881_11ea_85df_49c12f88b3e2row1_col4" class="data row1 col4" >[10]</td>
                        <td id="T_a29c9b80_c881_11ea_85df_49c12f88b3e2row1_col5" class="data row1 col5" >0</td>
                        <td id="T_a29c9b80_c881_11ea_85df_49c12f88b3e2row1_col6" class="data row1 col6" >0</td>
                        <td id="T_a29c9b80_c881_11ea_85df_49c12f88b3e2row1_col7" class="data row1 col7" >0</td>
                        <td id="T_a29c9b80_c881_11ea_85df_49c12f88b3e2row1_col8" class="data row1 col8" >peptide</td>
                        <td id="T_a29c9b80_c881_11ea_85df_49c12f88b3e2row1_col9" class="data row1 col9" >0</td>
                        <td id="T_a29c9b80_c881_11ea_85df_49c12f88b3e2row1_col10" class="data row1 col10" >Peptide0</td>
            </tr>
            <tr>
                                <td id="T_a29c9b80_c881_11ea_85df_49c12f88b3e2row2_col0" class="data row2 col0" >2</td>
                        <td id="T_a29c9b80_c881_11ea_85df_49c12f88b3e2row2_col1" class="data row2 col1" >3</td>
                        <td id="T_a29c9b80_c881_11ea_85df_49c12f88b3e2row2_col2" class="data row2 col2" >ALA</td>
                        <td id="T_a29c9b80_c881_11ea_85df_49c12f88b3e2row2_col3" class="data row2 col3" >aminoacid</td>
                        <td id="T_a29c9b80_c881_11ea_85df_49c12f88b3e2row2_col4" class="data row2 col4" >[10]</td>
                        <td id="T_a29c9b80_c881_11ea_85df_49c12f88b3e2row2_col5" class="data row2 col5" >0</td>
                        <td id="T_a29c9b80_c881_11ea_85df_49c12f88b3e2row2_col6" class="data row2 col6" >0</td>
                        <td id="T_a29c9b80_c881_11ea_85df_49c12f88b3e2row2_col7" class="data row2 col7" >0</td>
                        <td id="T_a29c9b80_c881_11ea_85df_49c12f88b3e2row2_col8" class="data row2 col8" >peptide</td>
                        <td id="T_a29c9b80_c881_11ea_85df_49c12f88b3e2row2_col9" class="data row2 col9" >0</td>
                        <td id="T_a29c9b80_c881_11ea_85df_49c12f88b3e2row2_col10" class="data row2 col10" >Peptide0</td>
            </tr>
            <tr>
                                <td id="T_a29c9b80_c881_11ea_85df_49c12f88b3e2row3_col0" class="data row3 col0" >3</td>
                        <td id="T_a29c9b80_c881_11ea_85df_49c12f88b3e2row3_col1" class="data row3 col1" >4</td>
                        <td id="T_a29c9b80_c881_11ea_85df_49c12f88b3e2row3_col2" class="data row3 col2" >ALA</td>
                        <td id="T_a29c9b80_c881_11ea_85df_49c12f88b3e2row3_col3" class="data row3 col3" >aminoacid</td>
                        <td id="T_a29c9b80_c881_11ea_85df_49c12f88b3e2row3_col4" class="data row3 col4" >[10]</td>
                        <td id="T_a29c9b80_c881_11ea_85df_49c12f88b3e2row3_col5" class="data row3 col5" >0</td>
                        <td id="T_a29c9b80_c881_11ea_85df_49c12f88b3e2row3_col6" class="data row3 col6" >0</td>
                        <td id="T_a29c9b80_c881_11ea_85df_49c12f88b3e2row3_col7" class="data row3 col7" >0</td>
                        <td id="T_a29c9b80_c881_11ea_85df_49c12f88b3e2row3_col8" class="data row3 col8" >peptide</td>
                        <td id="T_a29c9b80_c881_11ea_85df_49c12f88b3e2row3_col9" class="data row3 col9" >0</td>
                        <td id="T_a29c9b80_c881_11ea_85df_49c12f88b3e2row3_col10" class="data row3 col10" >Peptide0</td>
            </tr>
            <tr>
                                <td id="T_a29c9b80_c881_11ea_85df_49c12f88b3e2row4_col0" class="data row4 col0" >4</td>
                        <td id="T_a29c9b80_c881_11ea_85df_49c12f88b3e2row4_col1" class="data row4 col1" >5</td>
                        <td id="T_a29c9b80_c881_11ea_85df_49c12f88b3e2row4_col2" class="data row4 col2" >ALA</td>
                        <td id="T_a29c9b80_c881_11ea_85df_49c12f88b3e2row4_col3" class="data row4 col3" >aminoacid</td>
                        <td id="T_a29c9b80_c881_11ea_85df_49c12f88b3e2row4_col4" class="data row4 col4" >[10]</td>
                        <td id="T_a29c9b80_c881_11ea_85df_49c12f88b3e2row4_col5" class="data row4 col5" >0</td>
                        <td id="T_a29c9b80_c881_11ea_85df_49c12f88b3e2row4_col6" class="data row4 col6" >0</td>
                        <td id="T_a29c9b80_c881_11ea_85df_49c12f88b3e2row4_col7" class="data row4 col7" >0</td>
                        <td id="T_a29c9b80_c881_11ea_85df_49c12f88b3e2row4_col8" class="data row4 col8" >peptide</td>
                        <td id="T_a29c9b80_c881_11ea_85df_49c12f88b3e2row4_col9" class="data row4 col9" >0</td>
                        <td id="T_a29c9b80_c881_11ea_85df_49c12f88b3e2row4_col10" class="data row4 col10" >Peptide0</td>
            </tr>
            <tr>
                                <td id="T_a29c9b80_c881_11ea_85df_49c12f88b3e2row5_col0" class="data row5 col0" >5</td>
                        <td id="T_a29c9b80_c881_11ea_85df_49c12f88b3e2row5_col1" class="data row5 col1" >6</td>
                        <td id="T_a29c9b80_c881_11ea_85df_49c12f88b3e2row5_col2" class="data row5 col2" >ALA</td>
                        <td id="T_a29c9b80_c881_11ea_85df_49c12f88b3e2row5_col3" class="data row5 col3" >aminoacid</td>
                        <td id="T_a29c9b80_c881_11ea_85df_49c12f88b3e2row5_col4" class="data row5 col4" >[10]</td>
                        <td id="T_a29c9b80_c881_11ea_85df_49c12f88b3e2row5_col5" class="data row5 col5" >0</td>
                        <td id="T_a29c9b80_c881_11ea_85df_49c12f88b3e2row5_col6" class="data row5 col6" >0</td>
                        <td id="T_a29c9b80_c881_11ea_85df_49c12f88b3e2row5_col7" class="data row5 col7" >0</td>
                        <td id="T_a29c9b80_c881_11ea_85df_49c12f88b3e2row5_col8" class="data row5 col8" >peptide</td>
                        <td id="T_a29c9b80_c881_11ea_85df_49c12f88b3e2row5_col9" class="data row5 col9" >0</td>
                        <td id="T_a29c9b80_c881_11ea_85df_49c12f88b3e2row5_col10" class="data row5 col10" >Peptide0</td>
            </tr>
            <tr>
                                <td id="T_a29c9b80_c881_11ea_85df_49c12f88b3e2row6_col0" class="data row6 col0" >6</td>
                        <td id="T_a29c9b80_c881_11ea_85df_49c12f88b3e2row6_col1" class="data row6 col1" >7</td>
                        <td id="T_a29c9b80_c881_11ea_85df_49c12f88b3e2row6_col2" class="data row6 col2" >NME</td>
                        <td id="T_a29c9b80_c881_11ea_85df_49c12f88b3e2row6_col3" class="data row6 col3" >aminoacid</td>
                        <td id="T_a29c9b80_c881_11ea_85df_49c12f88b3e2row6_col4" class="data row6 col4" >[6]</td>
                        <td id="T_a29c9b80_c881_11ea_85df_49c12f88b3e2row6_col5" class="data row6 col5" >0</td>
                        <td id="T_a29c9b80_c881_11ea_85df_49c12f88b3e2row6_col6" class="data row6 col6" >0</td>
                        <td id="T_a29c9b80_c881_11ea_85df_49c12f88b3e2row6_col7" class="data row6 col7" >0</td>
                        <td id="T_a29c9b80_c881_11ea_85df_49c12f88b3e2row6_col8" class="data row6 col8" >peptide</td>
                        <td id="T_a29c9b80_c881_11ea_85df_49c12f88b3e2row6_col9" class="data row6 col9" >0</td>
                        <td id="T_a29c9b80_c881_11ea_85df_49c12f88b3e2row6_col10" class="data row6 col10" >Peptide0</td>
            </tr>
    </tbody></table></div>
</div>
<p>Lets represent the distance between the geometric center of the terminal groups vs. the simulation time:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[89]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">distances</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">distance</span><span class="p">(</span><span class="n">item_1</span><span class="o">=</span><span class="n">molecular_system</span><span class="p">,</span> <span class="n">selection_1</span><span class="o">=</span><span class="s2">&quot;group_index==0&quot;</span><span class="p">,</span>
                         <span class="n">group_behavior_1</span><span class="o">=</span><span class="s2">&quot;geometric_center&quot;</span><span class="p">,</span> <span class="n">selection_2</span><span class="o">=</span><span class="s2">&quot;group_index==6&quot;</span><span class="p">,</span>
                         <span class="n">group_behavior_2</span><span class="o">=</span><span class="s2">&quot;geometric_center&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[90]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">times</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">molecular_system</span><span class="p">,</span> <span class="n">target</span><span class="o">=</span><span class="s2">&quot;system&quot;</span><span class="p">,</span> <span class="n">time</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[91]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">times</span><span class="o">.</span><span class="n">in_units_of</span><span class="p">(</span><span class="n">unit</span><span class="o">.</span><span class="n">nanoseconds</span><span class="p">),</span> <span class="n">distances</span><span class="p">[:,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/contents_Distances_151_0.png" src="../_images/contents_Distances_151_0.png" />
</div>
</div>
<p>Or lets just get the distance between the geometric centers of all residues at the 3000-th frame:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[92]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">list_groups_1</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">molecular_system</span><span class="p">,</span> <span class="n">target</span><span class="o">=</span><span class="s2">&quot;group&quot;</span><span class="p">,</span> <span class="n">selection</span><span class="o">=</span><span class="s2">&quot;all&quot;</span><span class="p">,</span> <span class="n">atom_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">distances</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">distance</span><span class="p">(</span><span class="n">item_1</span><span class="o">=</span><span class="n">molecular_system</span><span class="p">,</span> <span class="n">groups_of_atoms_1</span><span class="o">=</span><span class="n">list_groups_1</span><span class="p">,</span>
                         <span class="n">group_behavior_1</span><span class="o">=</span><span class="s2">&quot;geometric_center&quot;</span><span class="p">,</span>
                         <span class="n">frame_indices_1</span><span class="o">=</span><span class="mi">3000</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[93]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">distances</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[93]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(1, 7, 7)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[94]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The distance between geometric_center of group 2-th and group 4-th at frame 3000-th is: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">distances</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
The distance between geometric_center of group 2-th and group 4-th at frame 3000-th is: 0.6818505282832528 nm
</pre></div></div>
</div>
</div>
<div class="section" id="Distance-between-atom-groups-of-two-systems">
<h3>Distance between atom groups of two systems<a class="headerlink" href="#Distance-between-atom-groups-of-two-systems" title="Permalink to this headline">¶</a></h3>
<p>The method <code class="docutils literal notranslate"><span class="pre">molsysmt.distance()</span></code> can work with two different systems as it was shown in the section about getting distances from atoms. The same option works for atom groups. Lets just see this with a case:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[95]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">molecular_system</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span><span class="s1">&#39;mmtf:1TCD&#39;</span><span class="p">,</span> <span class="s1">&#39;molsysmt.MolSys&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[96]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">molecular_system_A</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">extract</span><span class="p">(</span><span class="n">molecular_system</span><span class="p">,</span>
                                 <span class="n">selection</span><span class="o">=</span><span class="s2">&quot;chain_index==0 and molecule_type==&#39;protein&#39;&quot;</span><span class="p">)</span>
<span class="n">molecular_system_B</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">extract</span><span class="p">(</span><span class="n">molecular_system</span><span class="p">,</span>
                                 <span class="n">selection</span><span class="o">=</span><span class="s2">&quot;chain_index==1 and molecule_type==&#39;protein&#39;&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[97]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">msm</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">molecular_system_A</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[97]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<style  type="text/css" >
</style><table id="T_a36d2534_c881_11ea_85df_49c12f88b3e2" ><thead>    <tr>        <th class="col_heading level0 col0" >form</th>        <th class="col_heading level0 col1" >n_atoms</th>        <th class="col_heading level0 col2" >n_groups</th>        <th class="col_heading level0 col3" >n_components</th>        <th class="col_heading level0 col4" >n_chains</th>        <th class="col_heading level0 col5" >n_molecules</th>        <th class="col_heading level0 col6" >n_entities</th>        <th class="col_heading level0 col7" >n_proteins</th>        <th class="col_heading level0 col8" >n_frames</th>    </tr></thead><tbody>
                <tr>
                                <td id="T_a36d2534_c881_11ea_85df_49c12f88b3e2row0_col0" class="data row0 col0" >molsysmt.MolSys</td>
                        <td id="T_a36d2534_c881_11ea_85df_49c12f88b3e2row0_col1" class="data row0 col1" >1906</td>
                        <td id="T_a36d2534_c881_11ea_85df_49c12f88b3e2row0_col2" class="data row0 col2" >248</td>
                        <td id="T_a36d2534_c881_11ea_85df_49c12f88b3e2row0_col3" class="data row0 col3" >1</td>
                        <td id="T_a36d2534_c881_11ea_85df_49c12f88b3e2row0_col4" class="data row0 col4" >1</td>
                        <td id="T_a36d2534_c881_11ea_85df_49c12f88b3e2row0_col5" class="data row0 col5" >1</td>
                        <td id="T_a36d2534_c881_11ea_85df_49c12f88b3e2row0_col6" class="data row0 col6" >1</td>
                        <td id="T_a36d2534_c881_11ea_85df_49c12f88b3e2row0_col7" class="data row0 col7" >1</td>
                        <td id="T_a36d2534_c881_11ea_85df_49c12f88b3e2row0_col8" class="data row0 col8" >1</td>
            </tr>
    </tbody></table></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[98]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">msm</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">molecular_system_B</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[98]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<style  type="text/css" >
</style><table id="T_b335df60_c881_11ea_85df_49c12f88b3e2" ><thead>    <tr>        <th class="col_heading level0 col0" >form</th>        <th class="col_heading level0 col1" >n_atoms</th>        <th class="col_heading level0 col2" >n_groups</th>        <th class="col_heading level0 col3" >n_components</th>        <th class="col_heading level0 col4" >n_chains</th>        <th class="col_heading level0 col5" >n_molecules</th>        <th class="col_heading level0 col6" >n_entities</th>        <th class="col_heading level0 col7" >n_proteins</th>        <th class="col_heading level0 col8" >n_frames</th>    </tr></thead><tbody>
                <tr>
                                <td id="T_b335df60_c881_11ea_85df_49c12f88b3e2row0_col0" class="data row0 col0" >molsysmt.MolSys</td>
                        <td id="T_b335df60_c881_11ea_85df_49c12f88b3e2row0_col1" class="data row0 col1" >1912</td>
                        <td id="T_b335df60_c881_11ea_85df_49c12f88b3e2row0_col2" class="data row0 col2" >249</td>
                        <td id="T_b335df60_c881_11ea_85df_49c12f88b3e2row0_col3" class="data row0 col3" >1</td>
                        <td id="T_b335df60_c881_11ea_85df_49c12f88b3e2row0_col4" class="data row0 col4" >1</td>
                        <td id="T_b335df60_c881_11ea_85df_49c12f88b3e2row0_col5" class="data row0 col5" >1</td>
                        <td id="T_b335df60_c881_11ea_85df_49c12f88b3e2row0_col6" class="data row0 col6" >1</td>
                        <td id="T_b335df60_c881_11ea_85df_49c12f88b3e2row0_col7" class="data row0 col7" >1</td>
                        <td id="T_b335df60_c881_11ea_85df_49c12f88b3e2row0_col8" class="data row0 col8" >1</td>
            </tr>
    </tbody></table></div>
</div>
<p>Distance between groups belonging to different groups can be computed. All input arguments introduced to work with atoms remain valid in this context:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[99]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">list_groups_A</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">molecular_system_A</span><span class="p">,</span> <span class="n">target</span><span class="o">=</span><span class="s2">&quot;group&quot;</span><span class="p">,</span>
                        <span class="n">selection</span><span class="o">=</span><span class="s2">&quot;group_index in [0,1,2,3]&quot;</span><span class="p">,</span> <span class="n">atom_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">list_groups_B</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">molecular_system_B</span><span class="p">,</span> <span class="n">target</span><span class="o">=</span><span class="s2">&quot;group&quot;</span><span class="p">,</span>
                        <span class="n">selection</span><span class="o">=</span><span class="s2">&quot;group_index in [10,11,12,13]&quot;</span><span class="p">,</span> <span class="n">atom_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[100]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">distances</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">distance</span><span class="p">(</span><span class="n">item_1</span><span class="o">=</span><span class="n">molecular_system_A</span><span class="p">,</span> <span class="n">groups_of_atoms_1</span><span class="o">=</span><span class="n">list_groups_A</span><span class="p">,</span>
                         <span class="n">group_behavior_1</span><span class="o">=</span><span class="s2">&quot;geometric_center&quot;</span><span class="p">,</span>
                         <span class="n">item_2</span><span class="o">=</span><span class="n">molecular_system_B</span><span class="p">,</span> <span class="n">groups_of_atoms_2</span><span class="o">=</span><span class="n">list_groups_B</span><span class="p">,</span>
                         <span class="n">group_behavior_2</span><span class="o">=</span><span class="s2">&quot;geometric_center&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[101]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">distances</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[101]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(1, 4, 4)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[102]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The distance between geometric_center of group 0-th of A and group 10-th of B is: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">distances</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
The distance between geometric_center of group 0-th of A and group 10-th of B is: 4.5790732402700085 nm
</pre></div></div>
</div>
</div>
<div class="section" id="Distances-between-atom-groups-positions-in-different-frames">
<h3>Distances between atom groups positions in different frames<a class="headerlink" href="#Distances-between-atom-groups-positions-in-different-frames" title="Permalink to this headline">¶</a></h3>
<p>The method <code class="docutils literal notranslate"><span class="pre">molsysmt.distance()</span></code> works with atom groups just like with only atoms. There are two input arguments to select the coordinates of a set of atoms at two different frames:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[104]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">molecular_system</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">demo_systems</span><span class="o">.</span><span class="n">files</span><span class="p">[</span><span class="s1">&#39;pentalanine.h5&#39;</span><span class="p">]</span>
<span class="n">molecular_system</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span><span class="n">molecular_system</span><span class="p">,</span> <span class="n">to_form</span><span class="o">=</span><span class="s1">&#39;molsysmt.MolSys&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[105]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">msm</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">molecular_system</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[105]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<style  type="text/css" >
</style><table id="T_d02bac58_c881_11ea_85df_49c12f88b3e2" ><thead>    <tr>        <th class="col_heading level0 col0" >form</th>        <th class="col_heading level0 col1" >n_atoms</th>        <th class="col_heading level0 col2" >n_groups</th>        <th class="col_heading level0 col3" >n_components</th>        <th class="col_heading level0 col4" >n_chains</th>        <th class="col_heading level0 col5" >n_molecules</th>        <th class="col_heading level0 col6" >n_entities</th>        <th class="col_heading level0 col7" >n_peptides</th>        <th class="col_heading level0 col8" >n_frames</th>    </tr></thead><tbody>
                <tr>
                                <td id="T_d02bac58_c881_11ea_85df_49c12f88b3e2row0_col0" class="data row0 col0" >molsysmt.MolSys</td>
                        <td id="T_d02bac58_c881_11ea_85df_49c12f88b3e2row0_col1" class="data row0 col1" >62</td>
                        <td id="T_d02bac58_c881_11ea_85df_49c12f88b3e2row0_col2" class="data row0 col2" >7</td>
                        <td id="T_d02bac58_c881_11ea_85df_49c12f88b3e2row0_col3" class="data row0 col3" >1</td>
                        <td id="T_d02bac58_c881_11ea_85df_49c12f88b3e2row0_col4" class="data row0 col4" >1</td>
                        <td id="T_d02bac58_c881_11ea_85df_49c12f88b3e2row0_col5" class="data row0 col5" >1</td>
                        <td id="T_d02bac58_c881_11ea_85df_49c12f88b3e2row0_col6" class="data row0 col6" >1</td>
                        <td id="T_d02bac58_c881_11ea_85df_49c12f88b3e2row0_col7" class="data row0 col7" >1</td>
                        <td id="T_d02bac58_c881_11ea_85df_49c12f88b3e2row0_col8" class="data row0 col8" >5000</td>
            </tr>
    </tbody></table></div>
</div>
<p>Let see how <code class="docutils literal notranslate"><span class="pre">frame_indices_1</span></code> and <code class="docutils literal notranslate"><span class="pre">frame_indices_2</span></code> works in this context:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[106]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">distances</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">distance</span><span class="p">(</span><span class="n">item_1</span><span class="o">=</span><span class="n">molecular_system</span><span class="p">,</span>
                         <span class="n">selection_1</span><span class="o">=</span><span class="s2">&quot;group_index==0&quot;</span><span class="p">,</span> <span class="n">group_behavior_1</span><span class="o">=</span><span class="s2">&quot;geometric_center&quot;</span><span class="p">,</span>
                         <span class="n">frame_indices_1</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
                         <span class="n">selection_2</span><span class="o">=</span><span class="s2">&quot;group_index==6&quot;</span><span class="p">,</span> <span class="n">group_behavior_2</span><span class="o">=</span><span class="s2">&quot;geometric_center&quot;</span><span class="p">,</span>
                         <span class="n">frame_indices_2</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[107]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">distances</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[107]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(1, 1, 1)
</pre></div></div>
</div>
<p>The physical meaning of this former example is clear but not really useful, unless <code class="docutils literal notranslate"><span class="pre">selection_1</span></code> is the same as <code class="docutils literal notranslate"><span class="pre">selection_2</span></code> as we can see in the following section.</p>
</div>
<div class="section" id="Displacement-distances-of-atom-groups">
<h3>Displacement distances of atom groups<a class="headerlink" href="#Displacement-distances-of-atom-groups" title="Permalink to this headline">¶</a></h3>
<p>The possibility to get the distance between the coordinates of an object at two different frames makes the obtention of atom groups displacements straightforward. Lets plot the distance walked by the 0-th group of the former pentalanine peptide between consecutive frames of the trajectory store in <code class="docutils literal notranslate"><span class="pre">pentalanine.h5</span></code>:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[109]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">molecular_system</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">demo_systems</span><span class="o">.</span><span class="n">files</span><span class="p">[</span><span class="s1">&#39;pentalanine.h5&#39;</span><span class="p">]</span>
<span class="n">molecular_system</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span><span class="n">molecular_system</span><span class="p">,</span> <span class="n">to_form</span><span class="o">=</span><span class="s1">&#39;molsysmt.MolSys&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[110]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">n_frames</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">molecular_system</span><span class="p">,</span> <span class="n">n_frames</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[111]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">all_frame_indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">n_frames</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[112]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">displacements</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">distance</span><span class="p">(</span><span class="n">item_1</span><span class="o">=</span><span class="n">molecular_system</span><span class="p">,</span> <span class="n">selection_1</span><span class="o">=</span><span class="s2">&quot;group_index==0&quot;</span><span class="p">,</span>
                             <span class="n">group_behavior_1</span><span class="o">=</span><span class="s2">&quot;geometric_center&quot;</span><span class="p">,</span>
                             <span class="n">frame_indices_1</span><span class="o">=</span><span class="n">all_frame_indices</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
                             <span class="n">frame_indices_2</span><span class="o">=</span><span class="n">all_frame_indices</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[113]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">time</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">molecular_system</span><span class="p">,</span> <span class="n">target</span><span class="o">=</span><span class="s1">&#39;system&#39;</span><span class="p">,</span> <span class="n">frame_indices</span><span class="o">=</span><span class="n">all_frame_indices</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">time</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[114]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">in_units_of</span><span class="p">(</span><span class="n">unit</span><span class="o">.</span><span class="n">nanoseconds</span><span class="p">),</span> <span class="n">displacements</span><span class="p">[:,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/contents_Distances_181_0.png" src="../_images/contents_Distances_181_0.png" />
</div>
</div>
<p>Or we can, for instance, get the distance of the center of mass of the whole molecule from the initial configuration to every time step along the trajectory:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[115]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">displacements</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">distance</span><span class="p">(</span><span class="n">item_1</span><span class="o">=</span><span class="n">molecular_system</span><span class="p">,</span> <span class="n">selection_1</span><span class="o">=</span><span class="s2">&quot;all&quot;</span><span class="p">,</span>
                             <span class="n">frame_indices_1</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_frames</span><span class="p">),</span> <span class="n">frame_indices_2</span><span class="o">=</span><span class="n">all_frame_indices</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[116]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">time</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">molecular_system</span><span class="p">,</span> <span class="n">target</span><span class="o">=</span><span class="s1">&#39;system&#39;</span><span class="p">,</span> <span class="n">time</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[117]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">in_units_of</span><span class="p">(</span><span class="n">unit</span><span class="o">.</span><span class="n">nanoseconds</span><span class="p">),</span> <span class="n">displacements</span><span class="p">[:,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/contents_Distances_185_0.png" src="../_images/contents_Distances_185_0.png" />
</div>
</div>
</div>
<div class="section" id="Distance-between-atom-groups-pairs">
<h3>Distance between atom groups pairs<a class="headerlink" href="#Distance-between-atom-groups-pairs" title="Permalink to this headline">¶</a></h3>
<p>Lets see the following example where all distances betweeen the geometric center of the residues of pentalanine is computed along a short trajectory:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[120]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">molecular_system</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">demo_systems</span><span class="o">.</span><span class="n">files</span><span class="p">[</span><span class="s1">&#39;pentalanine.h5&#39;</span><span class="p">]</span>
<span class="n">molecular_system</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span><span class="n">molecular_system</span><span class="p">,</span> <span class="n">to_form</span><span class="o">=</span><span class="s1">&#39;molsysmt.MolSys&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[121]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">list_atom_groups</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">molecular_system</span><span class="p">,</span> <span class="n">target</span><span class="o">=</span><span class="s1">&#39;group&#39;</span><span class="p">,</span> <span class="n">selection</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="n">atom_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[122]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">list_atom_groups</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[122]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([array([0, 1, 2, 3, 4, 5]),
       array([ 6,  7,  8,  9, 10, 11, 12, 13, 14, 15]),
       array([16, 17, 18, 19, 20, 21, 22, 23, 24, 25]),
       array([26, 27, 28, 29, 30, 31, 32, 33, 34, 35]),
       array([36, 37, 38, 39, 40, 41, 42, 43, 44, 45]),
       array([46, 47, 48, 49, 50, 51, 52, 53, 54, 55]),
       array([56, 57, 58, 59, 60, 61])], dtype=object)
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[123]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">distances</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">distance</span><span class="p">(</span><span class="n">molecular_system</span><span class="p">,</span> <span class="n">groups_of_atoms_1</span><span class="o">=</span><span class="n">list_atom_groups</span><span class="p">,</span>
                         <span class="n">group_behavior_1</span><span class="o">=</span><span class="s1">&#39;geometric_center&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[124]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">distances</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[124]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(5000, 7, 7)
</pre></div></div>
</div>
<p>The method worked needlessly computing the distances between different groups twice, as well as getting the distance between a geometric center to the its self for every residue. This can be avoided thanks to the input argument <code class="docutils literal notranslate"><span class="pre">pairs=True</span></code>. Using <code class="docutils literal notranslate"><span class="pre">pairs=True</span></code>, as it can be seen in the corresponding section about distances of atoms pairs, the distances between atom groups pairs made by consecutive elements of two zipped lists are obtained. Lets see this with a pratical case:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[125]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">itertools</span> <span class="kn">import</span> <span class="n">combinations</span>

<span class="n">list_atom_groups_1</span><span class="o">=</span><span class="p">[]</span>
<span class="n">list_atom_groups_2</span><span class="o">=</span><span class="p">[]</span>
<span class="n">aux_list_1</span><span class="o">=</span><span class="p">[]</span>
<span class="n">aux_list_2</span><span class="o">=</span><span class="p">[]</span>

<span class="k">for</span> <span class="n">ii</span><span class="p">,</span><span class="n">jj</span> <span class="ow">in</span> <span class="n">combinations</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">7</span><span class="p">),</span> <span class="mi">2</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">.vs.</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ii</span><span class="p">,</span><span class="n">jj</span><span class="p">))</span>
    <span class="n">aux_list_1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ii</span><span class="p">)</span>
    <span class="n">aux_list_2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">jj</span><span class="p">)</span>
    <span class="n">list_atom_groups_1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">list_atom_groups</span><span class="p">[</span><span class="n">ii</span><span class="p">])</span>
    <span class="n">list_atom_groups_2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">list_atom_groups</span><span class="p">[</span><span class="n">jj</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
0.vs.1
0.vs.2
0.vs.3
0.vs.4
0.vs.5
0.vs.6
1.vs.2
1.vs.3
1.vs.4
1.vs.5
1.vs.6
2.vs.3
2.vs.4
2.vs.5
2.vs.6
3.vs.4
3.vs.5
3.vs.6
4.vs.5
4.vs.6
5.vs.6
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[126]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">distances</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">distance</span><span class="p">(</span><span class="n">molecular_system</span><span class="p">,</span> <span class="n">groups_of_atoms_1</span><span class="o">=</span><span class="n">list_atom_groups_1</span><span class="p">,</span>
                         <span class="n">group_behavior_1</span><span class="o">=</span><span class="s1">&#39;geometric_center&#39;</span><span class="p">,</span> <span class="n">groups_of_atoms_2</span><span class="o">=</span><span class="n">list_atom_groups_2</span><span class="p">,</span>
                         <span class="n">group_behavior_2</span><span class="o">=</span><span class="s1">&#39;geometric_center&#39;</span><span class="p">,</span> <span class="n">pairs</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[127]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">distances</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[127]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(5000, 21)
</pre></div></div>
</div>
<p>Lets plot the distance of a given pair, 12-th p.e., defined by the groups:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[128]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The 12-th pair is made by groups </span><span class="si">{}</span><span class="s1">-th and </span><span class="si">{}</span><span class="s1">-th, and its distance along the trajectory is:&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">aux_list_1</span><span class="p">[</span><span class="mi">12</span><span class="p">],</span> <span class="n">aux_list_2</span><span class="p">[</span><span class="mi">12</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
The 12-th pair is made by groups 2-th and 4-th, and its distance along the trajectory is:
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[129]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">time</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">molecular_system</span><span class="p">,</span> <span class="n">target</span><span class="o">=</span><span class="s1">&#39;system&#39;</span><span class="p">,</span> <span class="n">time</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">in_units_of</span><span class="p">(</span><span class="n">unit</span><span class="o">.</span><span class="n">nanoseconds</span><span class="p">),</span> <span class="n">distances</span><span class="p">[:,</span><span class="mi">12</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/contents_Distances_199_0.png" src="../_images/contents_Distances_199_0.png" />
</div>
</div>
</div>
<div class="section" id="Minimum-and-Maximum-distance-of-atom-groups">
<h3>Minimum and Maximum distance of atom groups<a class="headerlink" href="#Minimum-and-Maximum-distance-of-atom-groups" title="Permalink to this headline">¶</a></h3>
<p>Sometimes the pair of atom groups with the shortest distance between their geometric centers, or centers of mass, needs to be determined. Lets work to illustrate this case with a dimeric protein complex:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[130]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">molecular_system</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span><span class="s1">&#39;mmtf:1TCD&#39;</span><span class="p">,</span> <span class="s1">&#39;molsysmt.MolSys&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[131]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">msm</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">molecular_system</span><span class="p">,</span> <span class="n">target</span><span class="o">=</span><span class="s1">&#39;component&#39;</span><span class="p">,</span> <span class="n">selection</span><span class="o">=</span><span class="s1">&#39;molecule_type==&quot;protein&quot;&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[131]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<style  type="text/css" >
</style><table id="T_f70e3d72_c881_11ea_85df_49c12f88b3e2" ><thead>    <tr>        <th class="col_heading level0 col0" >index</th>        <th class="col_heading level0 col1" >n atoms</th>        <th class="col_heading level0 col2" >n groups</th>        <th class="col_heading level0 col3" >chain index</th>        <th class="col_heading level0 col4" >molecule index</th>        <th class="col_heading level0 col5" >molecule type</th>        <th class="col_heading level0 col6" >entity index</th>        <th class="col_heading level0 col7" >entity name</th>    </tr></thead><tbody>
                <tr>
                                <td id="T_f70e3d72_c881_11ea_85df_49c12f88b3e2row0_col0" class="data row0 col0" >0</td>
                        <td id="T_f70e3d72_c881_11ea_85df_49c12f88b3e2row0_col1" class="data row0 col1" >[1906]</td>
                        <td id="T_f70e3d72_c881_11ea_85df_49c12f88b3e2row0_col2" class="data row0 col2" >[248]</td>
                        <td id="T_f70e3d72_c881_11ea_85df_49c12f88b3e2row0_col3" class="data row0 col3" >0</td>
                        <td id="T_f70e3d72_c881_11ea_85df_49c12f88b3e2row0_col4" class="data row0 col4" >0</td>
                        <td id="T_f70e3d72_c881_11ea_85df_49c12f88b3e2row0_col5" class="data row0 col5" >protein</td>
                        <td id="T_f70e3d72_c881_11ea_85df_49c12f88b3e2row0_col6" class="data row0 col6" >0</td>
                        <td id="T_f70e3d72_c881_11ea_85df_49c12f88b3e2row0_col7" class="data row0 col7" >TRIOSEPHOSPHATE ISOMERASE</td>
            </tr>
            <tr>
                                <td id="T_f70e3d72_c881_11ea_85df_49c12f88b3e2row1_col0" class="data row1 col0" >1</td>
                        <td id="T_f70e3d72_c881_11ea_85df_49c12f88b3e2row1_col1" class="data row1 col1" >[1912]</td>
                        <td id="T_f70e3d72_c881_11ea_85df_49c12f88b3e2row1_col2" class="data row1 col2" >[249]</td>
                        <td id="T_f70e3d72_c881_11ea_85df_49c12f88b3e2row1_col3" class="data row1 col3" >1</td>
                        <td id="T_f70e3d72_c881_11ea_85df_49c12f88b3e2row1_col4" class="data row1 col4" >0</td>
                        <td id="T_f70e3d72_c881_11ea_85df_49c12f88b3e2row1_col5" class="data row1 col5" >protein</td>
                        <td id="T_f70e3d72_c881_11ea_85df_49c12f88b3e2row1_col6" class="data row1 col6" >0</td>
                        <td id="T_f70e3d72_c881_11ea_85df_49c12f88b3e2row1_col7" class="data row1 col7" >TRIOSEPHOSPHATE ISOMERASE</td>
            </tr>
    </tbody></table></div>
</div>
<p>Lets find out the closest pairs of distance from different components:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[132]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">atoms_groups_component_0</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">molecular_system</span><span class="p">,</span> <span class="n">target</span><span class="o">=</span><span class="s1">&#39;group&#39;</span><span class="p">,</span>
                                   <span class="n">selection</span><span class="o">=</span><span class="s1">&#39;component_index==0&#39;</span><span class="p">,</span> <span class="n">atom_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">atoms_groups_component_1</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">molecular_system</span><span class="p">,</span> <span class="n">target</span><span class="o">=</span><span class="s1">&#39;group&#39;</span><span class="p">,</span>
                                   <span class="n">selection</span><span class="o">=</span><span class="s1">&#39;component_index==1&#39;</span><span class="p">,</span> <span class="n">atom_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[133]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">min_pairs</span><span class="p">,</span> <span class="n">min_distances</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">minimum_distance</span><span class="p">(</span><span class="n">molecular_system</span><span class="p">,</span>
                                                <span class="n">groups_of_atoms_1</span><span class="o">=</span><span class="n">atoms_groups_component_0</span><span class="p">,</span>
                                                <span class="n">group_behavior_1</span><span class="o">=</span><span class="s1">&#39;geometric_center&#39;</span><span class="p">,</span>
                                                <span class="n">groups_of_atoms_2</span><span class="o">=</span><span class="n">atoms_groups_component_1</span><span class="p">,</span>
                                                <span class="n">group_behavior_2</span><span class="o">=</span><span class="s1">&#39;geometric_center&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>There is a single frame in our molecular system, thats why the shape of the numpy array with the pair of groups is the following:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[134]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">min_pairs</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[134]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(1, 2)
</pre></div></div>
</div>
<p>Where the indices found in min_pairs correspond to the n-th and m-th atoms group of the first list and the second list respectively:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[135]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">min_pairs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[135]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([69, 12])
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[136]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">group_index_in_component_0</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">molecular_system</span><span class="p">,</span> <span class="n">target</span><span class="o">=</span><span class="s1">&#39;group&#39;</span><span class="p">,</span>
                                     <span class="n">selection</span><span class="o">=</span><span class="s1">&#39;component_index==0&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="mi">69</span><span class="p">]</span>
<span class="n">group_index_in_component_1</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">molecular_system</span><span class="p">,</span> <span class="n">target</span><span class="o">=</span><span class="s1">&#39;group&#39;</span><span class="p">,</span>
                                     <span class="n">selection</span><span class="o">=</span><span class="s1">&#39;component_index==1&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="mi">12</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[137]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">msm</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">molecular_system</span><span class="p">,</span> <span class="n">target</span><span class="o">=</span><span class="s1">&#39;group&#39;</span><span class="p">,</span> <span class="n">indices</span><span class="o">=</span><span class="p">[</span><span class="n">group_index_in_component_0</span><span class="p">,</span>
                                                    <span class="n">group_index_in_component_1</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[137]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<style  type="text/css" >
</style><table id="T_13b59542_c882_11ea_85df_49c12f88b3e2" ><thead>    <tr>        <th class="col_heading level0 col0" >index</th>        <th class="col_heading level0 col1" >id</th>        <th class="col_heading level0 col2" >name</th>        <th class="col_heading level0 col3" >type</th>        <th class="col_heading level0 col4" >n atoms</th>        <th class="col_heading level0 col5" >component index</th>        <th class="col_heading level0 col6" >chain index</th>        <th class="col_heading level0 col7" >molecule index</th>        <th class="col_heading level0 col8" >molecule type</th>        <th class="col_heading level0 col9" >entity index</th>        <th class="col_heading level0 col10" >entity name</th>    </tr></thead><tbody>
                <tr>
                                <td id="T_13b59542_c882_11ea_85df_49c12f88b3e2row0_col0" class="data row0 col0" >69</td>
                        <td id="T_13b59542_c882_11ea_85df_49c12f88b3e2row0_col1" class="data row0 col1" >73</td>
                        <td id="T_13b59542_c882_11ea_85df_49c12f88b3e2row0_col2" class="data row0 col2" >GLY</td>
                        <td id="T_13b59542_c882_11ea_85df_49c12f88b3e2row0_col3" class="data row0 col3" >aminoacid</td>
                        <td id="T_13b59542_c882_11ea_85df_49c12f88b3e2row0_col4" class="data row0 col4" >[4]</td>
                        <td id="T_13b59542_c882_11ea_85df_49c12f88b3e2row0_col5" class="data row0 col5" >0</td>
                        <td id="T_13b59542_c882_11ea_85df_49c12f88b3e2row0_col6" class="data row0 col6" >0</td>
                        <td id="T_13b59542_c882_11ea_85df_49c12f88b3e2row0_col7" class="data row0 col7" >0</td>
                        <td id="T_13b59542_c882_11ea_85df_49c12f88b3e2row0_col8" class="data row0 col8" >protein</td>
                        <td id="T_13b59542_c882_11ea_85df_49c12f88b3e2row0_col9" class="data row0 col9" >0</td>
                        <td id="T_13b59542_c882_11ea_85df_49c12f88b3e2row0_col10" class="data row0 col10" >TRIOSEPHOSPHATE ISOMERASE</td>
            </tr>
            <tr>
                                <td id="T_13b59542_c882_11ea_85df_49c12f88b3e2row1_col0" class="data row1 col0" >260</td>
                        <td id="T_13b59542_c882_11ea_85df_49c12f88b3e2row1_col1" class="data row1 col1" >15</td>
                        <td id="T_13b59542_c882_11ea_85df_49c12f88b3e2row1_col2" class="data row1 col2" >CYS</td>
                        <td id="T_13b59542_c882_11ea_85df_49c12f88b3e2row1_col3" class="data row1 col3" >aminoacid</td>
                        <td id="T_13b59542_c882_11ea_85df_49c12f88b3e2row1_col4" class="data row1 col4" >[6]</td>
                        <td id="T_13b59542_c882_11ea_85df_49c12f88b3e2row1_col5" class="data row1 col5" >1</td>
                        <td id="T_13b59542_c882_11ea_85df_49c12f88b3e2row1_col6" class="data row1 col6" >1</td>
                        <td id="T_13b59542_c882_11ea_85df_49c12f88b3e2row1_col7" class="data row1 col7" >0</td>
                        <td id="T_13b59542_c882_11ea_85df_49c12f88b3e2row1_col8" class="data row1 col8" >protein</td>
                        <td id="T_13b59542_c882_11ea_85df_49c12f88b3e2row1_col9" class="data row1 col9" >0</td>
                        <td id="T_13b59542_c882_11ea_85df_49c12f88b3e2row1_col10" class="data row1 col10" >TRIOSEPHOSPHATE ISOMERASE</td>
            </tr>
    </tbody></table></div>
</div>
<p>And the corresponding minimum distance between both residues from the two components is:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[138]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">min_distances</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[138]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Quantity(value=0.38221311908773786, unit=nanometer)
</pre></div></div>
</div>
<p>On the other hand, if the maximum distance needs to be obtained, the method to be used is <code class="docutils literal notranslate"><span class="pre">molsysmt.maximum_distance()</span></code>. Lets show how this method works with a short trajectory of the pentalanine peptide.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[140]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">molecular_system</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">demo_systems</span><span class="o">.</span><span class="n">files</span><span class="p">[</span><span class="s1">&#39;pentalanine.h5&#39;</span><span class="p">]</span>
<span class="n">molecular_system</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span><span class="n">molecular_system</span><span class="p">,</span> <span class="n">to_form</span><span class="o">=</span><span class="s1">&#39;molsysmt.MolSys&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[141]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">msm</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">molecular_system</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[141]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<style  type="text/css" >
</style><table id="T_1f1710e6_c882_11ea_85df_49c12f88b3e2" ><thead>    <tr>        <th class="col_heading level0 col0" >form</th>        <th class="col_heading level0 col1" >n_atoms</th>        <th class="col_heading level0 col2" >n_groups</th>        <th class="col_heading level0 col3" >n_components</th>        <th class="col_heading level0 col4" >n_chains</th>        <th class="col_heading level0 col5" >n_molecules</th>        <th class="col_heading level0 col6" >n_entities</th>        <th class="col_heading level0 col7" >n_peptides</th>        <th class="col_heading level0 col8" >n_frames</th>    </tr></thead><tbody>
                <tr>
                                <td id="T_1f1710e6_c882_11ea_85df_49c12f88b3e2row0_col0" class="data row0 col0" >molsysmt.MolSys</td>
                        <td id="T_1f1710e6_c882_11ea_85df_49c12f88b3e2row0_col1" class="data row0 col1" >62</td>
                        <td id="T_1f1710e6_c882_11ea_85df_49c12f88b3e2row0_col2" class="data row0 col2" >7</td>
                        <td id="T_1f1710e6_c882_11ea_85df_49c12f88b3e2row0_col3" class="data row0 col3" >1</td>
                        <td id="T_1f1710e6_c882_11ea_85df_49c12f88b3e2row0_col4" class="data row0 col4" >1</td>
                        <td id="T_1f1710e6_c882_11ea_85df_49c12f88b3e2row0_col5" class="data row0 col5" >1</td>
                        <td id="T_1f1710e6_c882_11ea_85df_49c12f88b3e2row0_col6" class="data row0 col6" >1</td>
                        <td id="T_1f1710e6_c882_11ea_85df_49c12f88b3e2row0_col7" class="data row0 col7" >1</td>
                        <td id="T_1f1710e6_c882_11ea_85df_49c12f88b3e2row0_col8" class="data row0 col8" >5000</td>
            </tr>
    </tbody></table></div>
</div>
<p>The trajectory has 5000 frames. Lets see, for each frame, whats the pair of residues with the longest distance between their geometric centers:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[142]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">list_atom_groups</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">molecular_system</span><span class="p">,</span> <span class="n">target</span><span class="o">=</span><span class="s1">&#39;group&#39;</span><span class="p">,</span> <span class="n">selection</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="n">atom_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">max_pairs</span><span class="p">,</span> <span class="n">max_distances</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">maximum_distance</span><span class="p">(</span><span class="n">molecular_system</span><span class="p">,</span> <span class="n">groups_of_atoms_1</span><span class="o">=</span><span class="n">list_atom_groups</span><span class="p">,</span>
                                                <span class="n">group_behavior_1</span><span class="o">=</span><span class="s1">&#39;geometric_center&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>This time we have 5000 pairs of group, one for each frame; and 5000 maximum distances:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[143]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">max_pairs</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[143]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(5000, 2)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[144]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">max_pairs</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[144]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([[0, 6],
       [0, 6],
       [0, 6],
       ...,
       [0, 6],
       [2, 6],
       [2, 6]])
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[145]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">max_distances</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[145]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Quantity(value=array([1.42980221, 1.50600047, 1.6863101 , ..., 1.83006115, 1.24581543,
       1.39260625]), unit=nanometer)
</pre></div></div>
</div>
<p>To give a last example on this methods, lets wonder: what is the residue of the peptide with the largest displacement between each frame and the next one? (at each frame, of course)</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[146]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">list_atom_groups</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">molecular_system</span><span class="p">,</span> <span class="n">target</span><span class="o">=</span><span class="s1">&#39;group&#39;</span><span class="p">,</span> <span class="n">selection</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="n">atom_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">frames</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">msm</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">molecular_system</span><span class="p">,</span> <span class="n">n_frames</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="n">max_group</span><span class="p">,</span> <span class="n">max_distances</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">maximum_distance</span><span class="p">(</span><span class="n">molecular_system</span><span class="p">,</span>
                                                <span class="n">groups_of_atoms_1</span><span class="o">=</span><span class="n">list_atom_groups</span><span class="p">,</span>
                                                <span class="n">group_behavior_1</span><span class="o">=</span><span class="s1">&#39;geometric_center&#39;</span><span class="p">,</span>
                                                <span class="n">groups_of_atoms_2</span><span class="o">=</span><span class="n">list_atom_groups</span><span class="p">,</span>
                                                <span class="n">group_behavior_2</span><span class="o">=</span><span class="s1">&#39;geometric_center&#39;</span><span class="p">,</span>
                                                <span class="n">frame_indices_1</span><span class="o">=</span><span class="n">frames</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
                                                <span class="n">frame_indices_2</span><span class="o">=</span><span class="n">frames</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span>
                                                <span class="n">pairs</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Since we are using the option <code class="docutils literal notranslate"><span class="pre">pairs=True</span></code>, the output this time corresponds to the index of the pair made by the elements in both <code class="docutils literal notranslate"><span class="pre">groups_of_atoms_1</span></code> and <code class="docutils literal notranslate"><span class="pre">groups_of_atoms_2</span></code> with the maximum distance, or displacement in this case, for each i-th frame with the consecutive (i+1)-th frame:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[147]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">max_group</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[147]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(4999,)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[148]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">max_group</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[148]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([2, 0, 6, ..., 6, 6, 6])
</pre></div></div>
</div>
<p>And the value of this maximum displacements are:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[149]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">max_distances</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[149]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Quantity(value=array([0.72087604, 1.2344545 , 0.83900167, ..., 1.31317032, 0.88887944,
       1.26066073]), unit=nanometer)
</pre></div></div>
</div>
<p>This way:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[150]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The </span><span class="si">{}</span><span class="s1">-th is the group with the maximum displacement between frames 200-th and 201-th: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">max_group</span><span class="p">[</span><span class="mi">200</span><span class="p">],</span> <span class="n">max_distances</span><span class="p">[</span><span class="mi">200</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
The 3-th is the group with the maximum displacement between frames 200-th and 201-th: 0.6367210108091421 nm
</pre></div></div>
</div>
</div>
</div>
<div class="section" id="Neighbor-lists">
<h2>Neighbor lists<a class="headerlink" href="#Neighbor-lists" title="Permalink to this headline">¶</a></h2>
<p>With the method <code class="docutils literal notranslate"><span class="pre">molsysmt.distance()</span></code> many questions about a molecular system can be answered. Two of the most common distance related questions are: what are the closest n atoms to a given one? or what are the atoms closest than a given distance threshold? MolSysMT includes a method to provide with this distances processing: <code class="docutils literal notranslate"><span class="pre">molsysmt.neighbors_lists()</span></code>.</p>
<div class="section" id="First-closest-neighbor-atoms-or-groups">
<h3>First closest neighbor atoms or groups<a class="headerlink" href="#First-closest-neighbor-atoms-or-groups" title="Permalink to this headline">¶</a></h3>
<p>There are two ways to compute distance neighbors. The closest n atoms to a given one can be obtained with the option <code class="docutils literal notranslate"><span class="pre">num_neighbors</span></code> or <code class="docutils literal notranslate"><span class="pre">threshold</span></code>. Lets show with a simple example how this first option works:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[152]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">molecular_system</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">demo_systems</span><span class="o">.</span><span class="n">files</span><span class="p">[</span><span class="s1">&#39;pentalanine.h5&#39;</span><span class="p">]</span>
<span class="n">molecular_system</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span><span class="n">molecular_system</span><span class="p">,</span> <span class="n">to_form</span><span class="o">=</span><span class="s1">&#39;molsysmt.MolSys&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[153]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">msm</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">molecular_system</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[153]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<style  type="text/css" >
</style><table id="T_333ffa06_c882_11ea_85df_49c12f88b3e2" ><thead>    <tr>        <th class="col_heading level0 col0" >form</th>        <th class="col_heading level0 col1" >n_atoms</th>        <th class="col_heading level0 col2" >n_groups</th>        <th class="col_heading level0 col3" >n_components</th>        <th class="col_heading level0 col4" >n_chains</th>        <th class="col_heading level0 col5" >n_molecules</th>        <th class="col_heading level0 col6" >n_entities</th>        <th class="col_heading level0 col7" >n_peptides</th>        <th class="col_heading level0 col8" >n_frames</th>    </tr></thead><tbody>
                <tr>
                                <td id="T_333ffa06_c882_11ea_85df_49c12f88b3e2row0_col0" class="data row0 col0" >molsysmt.MolSys</td>
                        <td id="T_333ffa06_c882_11ea_85df_49c12f88b3e2row0_col1" class="data row0 col1" >62</td>
                        <td id="T_333ffa06_c882_11ea_85df_49c12f88b3e2row0_col2" class="data row0 col2" >7</td>
                        <td id="T_333ffa06_c882_11ea_85df_49c12f88b3e2row0_col3" class="data row0 col3" >1</td>
                        <td id="T_333ffa06_c882_11ea_85df_49c12f88b3e2row0_col4" class="data row0 col4" >1</td>
                        <td id="T_333ffa06_c882_11ea_85df_49c12f88b3e2row0_col5" class="data row0 col5" >1</td>
                        <td id="T_333ffa06_c882_11ea_85df_49c12f88b3e2row0_col6" class="data row0 col6" >1</td>
                        <td id="T_333ffa06_c882_11ea_85df_49c12f88b3e2row0_col7" class="data row0 col7" >1</td>
                        <td id="T_333ffa06_c882_11ea_85df_49c12f88b3e2row0_col8" class="data row0 col8" >5000</td>
            </tr>
    </tbody></table></div>
</div>
<p>We can compute the closest 3 CA atoms to each CA atom of the molecular system:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[154]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">CA_atoms_list</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">molecular_system</span><span class="p">,</span> <span class="n">selection</span><span class="o">=</span><span class="s1">&#39;atom_name==&quot;CA&quot;&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[155]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">neighbors</span><span class="p">,</span> <span class="n">distances</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">neighbors_lists</span><span class="p">(</span><span class="n">molecular_system</span><span class="p">,</span> <span class="n">selection_1</span><span class="o">=</span><span class="n">CA_atoms_list</span><span class="p">,</span>
                                           <span class="n">num_neighbors</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Two objects are returned. A numpy array with the list of 3 neighbor atom indices per atom in <code class="docutils literal notranslate"><span class="pre">selection_1</span></code>, per frame:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[156]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">neighbors</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[156]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(5000, 5, 3)
</pre></div></div>
</div>
<p>And the corresponding distances:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[157]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">distances</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[157]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(5000, 5, 3)
</pre></div></div>
</div>
<p>This way, the closest 3 atoms of the first CA atom at frame 2000-th are:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[158]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;3 first neighbor CAs of atom </span><span class="si">{}</span><span class="s2">-th at frame 0-th&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">CA_atoms_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;------------------------------------------&quot;</span><span class="p">)</span>

<span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2">° neighbor is atom </span><span class="si">{}</span><span class="s2">-th with distance: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ii</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">CA_atoms_list</span><span class="p">[</span><span class="n">neighbors</span><span class="p">[</span><span class="mi">2000</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">ii</span><span class="p">]],</span> <span class="n">distances</span><span class="p">[</span><span class="mi">2000</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">ii</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
3 first neighbor CAs of atom 8-th at frame 0-th
------------------------------------------
1° neighbor is atom 18-th with distance: 0.3874317590975941 nm
2° neighbor is atom 28-th with distance: 0.5346208297333755 nm
3° neighbor is atom 48-th with distance: 0.5453396095979958 nm
</pre></div></div>
</div>
<p>Lets see now the 4 closest atoms, any kind, to each CA atom of the molecular system:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[159]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">neighbors</span><span class="p">,</span> <span class="n">distances</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">neighbors_lists</span><span class="p">(</span><span class="n">molecular_system</span><span class="p">,</span> <span class="n">selection_1</span><span class="o">=</span><span class="n">CA_atoms_list</span><span class="p">,</span>
                                           <span class="n">selection_2</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">,</span>
                                           <span class="n">num_neighbors</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[160]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;4 first neighbors of atom </span><span class="si">{}</span><span class="s2">-th at frame 2000-th&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">CA_atoms_list</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;------------------------------------------&quot;</span><span class="p">)</span>

<span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2">° neighbor is atom </span><span class="si">{}</span><span class="s2">-th with distance: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ii</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">neighbors</span><span class="p">[</span><span class="mi">2000</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">ii</span><span class="p">],</span> <span class="n">distances</span><span class="p">[</span><span class="mi">2000</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">ii</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
4 first neighbors of atom 8-th at frame 2000-th
------------------------------------------
1° neighbor is atom 8-th with distance: 0.0 nm
2° neighbor is atom 9-th with distance: 0.10900002347459704 nm
3° neighbor is atom 6-th with distance: 0.14533472683839888 nm
4° neighbor is atom 10-th with distance: 0.1532800898161647 nm
</pre></div></div>
</div>
<p>Notice that, in this case, <code class="docutils literal notranslate"><span class="pre">msm.neighbors_list</span></code> is built to assume that is working with two different set of atoms since <code class="docutils literal notranslate"><span class="pre">selection_1</span></code><span class="math notranslate nohighlight">\(\neq\)</span><code class="docutils literal notranslate"><span class="pre">selection_2</span></code>. Thats the reason why this time the first neighbor atom is the atom itself.</p>
<p>The method <code class="docutils literal notranslate"><span class="pre">msm.neighbors_list()</span></code> was built on top of <code class="docutils literal notranslate"><span class="pre">msm.distance()</span></code>, thus the input arguments are almost the same. If you already had a look to the section about atoms distance, you will be probably wonder if <code class="docutils literal notranslate"><span class="pre">msm.neighbors_list</span></code> can also work with atoms groups. Lets illustrate this case with the following cells:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[161]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">molecular_system</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span><span class="s1">&#39;mmtf:1TCD&#39;</span><span class="p">,</span> <span class="s1">&#39;molsysmt.MolSys&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[162]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">atoms_in_residues_chain_0</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">molecular_system</span><span class="p">,</span> <span class="n">target</span><span class="o">=</span><span class="s1">&#39;group&#39;</span><span class="p">,</span>
                                    <span class="n">selection</span><span class="o">=</span><span class="s2">&quot;molecule_type==&#39;protein&#39; and chain_index==0&quot;</span><span class="p">,</span>
                                    <span class="n">atom_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">atoms_in_residues_chain_1</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">molecular_system</span><span class="p">,</span> <span class="n">target</span><span class="o">=</span><span class="s1">&#39;group&#39;</span><span class="p">,</span>
                                    <span class="n">selection</span><span class="o">=</span><span class="s2">&quot;molecule_type==&#39;protein&#39; and chain_index==1&quot;</span><span class="p">,</span>
                                    <span class="n">atom_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[163]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Number of residues in chain 0:&#39;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">atoms_in_residues_chain_0</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Number of residues in chain 1:&#39;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">atoms_in_residues_chain_1</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Number of residues in chain 0: 248
Number of residues in chain 1: 249
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[164]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">neighbors</span><span class="p">,</span> <span class="n">distances</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">neighbors_lists</span><span class="p">(</span><span class="n">molecular_system</span><span class="p">,</span>
                                           <span class="n">groups_of_atoms_1</span><span class="o">=</span><span class="n">atoms_in_residues_chain_0</span><span class="p">,</span>
                                           <span class="n">group_behavior_1</span><span class="o">=</span> <span class="s1">&#39;geometric_center&#39;</span><span class="p">,</span>
                                           <span class="n">num_neighbors</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[165]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="n">neighbors</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(1, 248, 8)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[166]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;8 first group neighbors of the geometric center of residue 0-th&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;------------------------------------------&quot;</span><span class="p">)</span>

<span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">8</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2">° neighbor is group </span><span class="si">{}</span><span class="s2">-th with distance: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ii</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">neighbors</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">ii</span><span class="p">],</span> <span class="n">distances</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">ii</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
8 first group neighbors of the geometric center of residue 0-th
------------------------------------------
1° neighbor is group 1-th with distance: 0.4370347284513119 nm
2° neighbor is group 226-th with distance: 0.5876214911977264 nm
3° neighbor is group 220-th with distance: 0.7005928267026147 nm
4° neighbor is group 3-th with distance: 0.7546595763407252 nm
5° neighbor is group 224-th with distance: 0.7788646403094585 nm
6° neighbor is group 225-th with distance: 0.7971327058289358 nm
7° neighbor is group 223-th with distance: 0.8302823100919265 nm
8° neighbor is group 2-th with distance: 0.8680783396121026 nm
</pre></div></div>
</div>
<p>The list groups neighbors can be computed also from two molecular systems or two list of groups:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[167]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">neighbors</span><span class="p">,</span> <span class="n">distances</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">neighbors_lists</span><span class="p">(</span><span class="n">molecular_system</span><span class="p">,</span>
                                           <span class="n">groups_of_atoms_1</span><span class="o">=</span><span class="n">atoms_in_residues_chain_0</span><span class="p">,</span>
                                           <span class="n">group_behavior_1</span><span class="o">=</span> <span class="s1">&#39;geometric_center&#39;</span><span class="p">,</span>
                                           <span class="n">groups_of_atoms_2</span><span class="o">=</span><span class="n">atoms_in_residues_chain_1</span><span class="p">,</span>
                                           <span class="n">group_behavior_2</span><span class="o">=</span> <span class="s1">&#39;geometric_center&#39;</span><span class="p">,</span>
                                           <span class="n">num_neighbors</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[168]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;8 first group neighbors from chain 1 of the geometric center of residue 0-th from chain 0&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;------------------------------------------&quot;</span><span class="p">)</span>

<span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">8</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2">° neighbor is group </span><span class="si">{}</span><span class="s2">-th with distance: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ii</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">neighbors</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">ii</span><span class="p">],</span> <span class="n">distances</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">ii</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
8 first group neighbors from chain 1 of the geometric center of residue 0-th from chain 0
------------------------------------------
1° neighbor is group 73-th with distance: 2.773304114113712 nm
2° neighbor is group 71-th with distance: 3.0040410444903585 nm
3° neighbor is group 74-th with distance: 3.049597390003938 nm
4° neighbor is group 70-th with distance: 3.201184539105876 nm
5° neighbor is group 72-th with distance: 3.253631073569913 nm
6° neighbor is group 75-th with distance: 3.3579026367512856 nm
7° neighbor is group 44-th with distance: 3.481955675588245 nm
8° neighbor is group 69-th with distance: 3.565210348182857 nm
</pre></div></div>
</div>
<p>The method <code class="docutils literal notranslate"><span class="pre">molsysmt.neighbors_lists()</span></code> can also mix atoms and atoms groups. Lets, as last example, get the closest geometric centers of residues to a specific atom:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[169]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">neighbors</span><span class="p">,</span> <span class="n">distances</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">neighbors_lists</span><span class="p">(</span><span class="n">molecular_system</span><span class="p">,</span> <span class="n">selection_1</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
                                           <span class="n">groups_of_atoms_2</span><span class="o">=</span><span class="n">atoms_in_residues_chain_1</span><span class="p">,</span>
                                           <span class="n">group_behavior_2</span><span class="o">=</span> <span class="s1">&#39;geometric_center&#39;</span><span class="p">,</span>
                                           <span class="n">num_neighbors</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[170]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;4 closest geometric centers of residues of chain 1 from atom 100-th&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-------------------------------------------------------------------&quot;</span><span class="p">)</span>

<span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2">° closest neighbor is group </span><span class="si">{}</span><span class="s2">-th with distance: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ii</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">neighbors</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">ii</span><span class="p">],</span> <span class="n">distances</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">ii</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
4 closest geometric centers of residues of chain 1 from atom 100-th
-------------------------------------------------------------------
1° closest neighbor is group 80-th with distance: 0.6048272865558402 nm
2° closest neighbor is group 69-th with distance: 0.7263555641389107 nm
3° closest neighbor is group 70-th with distance: 0.7811893184433591 nm
4° closest neighbor is group 77-th with distance: 0.8498448121405588 nm
</pre></div></div>
</div>
</div>
<div class="section" id="Closest-neighbor-atoms-or-groups-below-a-distance-threshold">
<h3>Closest neighbor atoms or groups below a distance threshold<a class="headerlink" href="#Closest-neighbor-atoms-or-groups-below-a-distance-threshold" title="Permalink to this headline">¶</a></h3>
<p>In addition to the input argument <code class="docutils literal notranslate"><span class="pre">num_neighbors</span></code>, <code class="docutils literal notranslate"><span class="pre">molsysmt.neighbors_lists()</span></code> includes the option of getting those neighbors with a distance below a given threshols: <code class="docutils literal notranslate"><span class="pre">threshold</span></code>. Lets get for the following molecular system the list of CA atoms closest than 8 <span class="math notranslate nohighlight">\(\unicode{xC5}\)</span>:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[171]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">molecular_system</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span><span class="s1">&#39;mmtf:1TCD&#39;</span><span class="p">,</span> <span class="s1">&#39;molsysmt.MolSys&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[172]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">CA_atoms</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">molecular_system</span><span class="p">,</span> <span class="n">selection</span><span class="o">=</span><span class="s1">&#39;atom_name==&quot;CA&quot;&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[173]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">neighbors</span><span class="p">,</span> <span class="n">distances</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">neighbors_lists</span><span class="p">(</span><span class="n">molecular_system</span><span class="p">,</span> <span class="n">selection_1</span><span class="o">=</span><span class="n">CA_atoms</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mi">8</span><span class="o">*</span><span class="n">unit</span><span class="o">.</span><span class="n">angstroms</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>In this example, each CA atom has a different number of neighbors. This time the output is not a tensor ranked 3, but a matrix where the elements are not numbers but list of neighbors:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[174]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="n">neighbors</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(1, 497)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[175]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="n">distances</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(1, 497)
</pre></div></div>
</div>
<p>The molecular system had 1 single frame and 497 CA atoms, lets see now the number of CA neighbors of the first 10 CA atoms in our list:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[176]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The </span><span class="si">{}</span><span class="s2">° CA has </span><span class="si">{}</span><span class="s2"> CA neighbors.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ii</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">neighbors</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="n">ii</span><span class="p">])))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
The 1° CA has 7 CA neighbors.
The 2° CA has 8 CA neighbors.
The 3° CA has 9 CA neighbors.
The 4° CA has 12 CA neighbors.
The 5° CA has 13 CA neighbors.
The 6° CA has 15 CA neighbors.
The 7° CA has 12 CA neighbors.
The 8° CA has 12 CA neighbors.
The 9° CA has 14 CA neighbors.
The 10° CA has 14 CA neighbors.
</pre></div></div>
</div>
<p>Lets print out the neighbors of the 20-th CA in the list:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[177]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">for</span> <span class="n">ii</span><span class="p">,</span><span class="n">dd</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">neighbors</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">20</span><span class="p">],</span> <span class="n">distances</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">20</span><span class="p">]):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The </span><span class="si">{}</span><span class="s2">-th CA is </span><span class="si">{}</span><span class="s2"> away from the 20-th CA&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ii</span><span class="p">,</span><span class="n">dd</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
The 21-th CA is 0.3807746183768036 nm away from the 20-th CA
The 19-th CA is 0.388276267623969 nm away from the 20-th CA
The 23-th CA is 0.5117970007727675 nm away from the 20-th CA
The 22-th CA is 0.5541036906572636 nm away from the 20-th CA
The 18-th CA is 0.5639790953572659 nm away from the 20-th CA
The 24-th CA is 0.6343354475354508 nm away from the 20-th CA
The 17-th CA is 0.6452477431188739 nm away from the 20-th CA
The 16-th CA is 0.7399875134081655 nm away from the 20-th CA
</pre></div></div>
</div>
<p>As well as for the input argument <code class="docutils literal notranslate"><span class="pre">num_neighbors</span></code> -previous subsection-, the neighbors closest than a given threshold can also be computed between atoms groups or atoms and atoms groups. Lets show a example where the neighbors of the residues of chain 0 in our molecular system are defined as those residues of chain 1 closest the 1.2 nm:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[178]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">atoms_in_residues_chain_0</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">molecular_system</span><span class="p">,</span> <span class="n">target</span><span class="o">=</span><span class="s1">&#39;group&#39;</span><span class="p">,</span>
                                    <span class="n">selection</span><span class="o">=</span><span class="s2">&quot;molecule_type==&#39;protein&#39; and chain_index==0&quot;</span><span class="p">,</span>
                                    <span class="n">atom_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">atoms_in_residues_chain_1</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">molecular_system</span><span class="p">,</span> <span class="n">target</span><span class="o">=</span><span class="s1">&#39;group&#39;</span><span class="p">,</span>
                                    <span class="n">selection</span><span class="o">=</span><span class="s2">&quot;molecule_type==&#39;protein&#39; and chain_index==1&quot;</span><span class="p">,</span>
                                    <span class="n">atom_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[179]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">neighbors</span><span class="p">,</span> <span class="n">distances</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">neighbors_lists</span><span class="p">(</span><span class="n">molecular_system</span><span class="p">,</span>
                                           <span class="n">groups_of_atoms_1</span><span class="o">=</span> <span class="n">atoms_in_residues_chain_0</span><span class="p">,</span> <span class="n">group_behavior_1</span><span class="o">=</span><span class="s1">&#39;geometric_center&#39;</span><span class="p">,</span>
                                           <span class="n">groups_of_atoms_2</span><span class="o">=</span> <span class="n">atoms_in_residues_chain_1</span><span class="p">,</span> <span class="n">group_behavior_2</span><span class="o">=</span><span class="s1">&#39;geometric_center&#39;</span><span class="p">,</span>
                                           <span class="n">threshold</span><span class="o">=</span><span class="mf">1.2</span><span class="o">*</span><span class="n">unit</span><span class="o">.</span><span class="n">nanometers</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Lets print out the number of contacts in chain 1 per residue of chain 0, if any:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[180]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">atoms_in_residues_chain_0</span><span class="p">)):</span>
    <span class="n">n_contacts</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">neighbors</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="n">ii</span><span class="p">])</span>
    <span class="k">if</span> <span class="n">n_contacts</span> <span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The </span><span class="si">{}</span><span class="s1">-th residue of chain 0 has </span><span class="si">{}</span><span class="s1"> residue contacts in chain 1&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ii</span><span class="p">,</span><span class="n">n_contacts</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
The 7-th residue of chain 0 has 1 residue contacts in chain 1
The 8-th residue of chain 0 has 6 residue contacts in chain 1
The 9-th residue of chain 0 has 5 residue contacts in chain 1
The 10-th residue of chain 0 has 10 residue contacts in chain 1
The 11-th residue of chain 0 has 18 residue contacts in chain 1
The 12-th residue of chain 0 has 14 residue contacts in chain 1
The 13-th residue of chain 0 has 11 residue contacts in chain 1
The 14-th residue of chain 0 has 9 residue contacts in chain 1
The 15-th residue of chain 0 has 9 residue contacts in chain 1
The 16-th residue of chain 0 has 3 residue contacts in chain 1
The 17-th residue of chain 0 has 2 residue contacts in chain 1
The 18-th residue of chain 0 has 3 residue contacts in chain 1
The 39-th residue of chain 0 has 2 residue contacts in chain 1
The 40-th residue of chain 0 has 7 residue contacts in chain 1
The 41-th residue of chain 0 has 17 residue contacts in chain 1
The 42-th residue of chain 0 has 18 residue contacts in chain 1
The 43-th residue of chain 0 has 26 residue contacts in chain 1
The 44-th residue of chain 0 has 11 residue contacts in chain 1
The 45-th residue of chain 0 has 9 residue contacts in chain 1
The 46-th residue of chain 0 has 11 residue contacts in chain 1
The 47-th residue of chain 0 has 6 residue contacts in chain 1
The 48-th residue of chain 0 has 2 residue contacts in chain 1
The 49-th residue of chain 0 has 1 residue contacts in chain 1
The 50-th residue of chain 0 has 1 residue contacts in chain 1
The 59-th residue of chain 0 has 1 residue contacts in chain 1
The 60-th residue of chain 0 has 3 residue contacts in chain 1
The 61-th residue of chain 0 has 4 residue contacts in chain 1
The 62-th residue of chain 0 has 8 residue contacts in chain 1
The 63-th residue of chain 0 has 7 residue contacts in chain 1
The 64-th residue of chain 0 has 6 residue contacts in chain 1
The 65-th residue of chain 0 has 7 residue contacts in chain 1
The 66-th residue of chain 0 has 1 residue contacts in chain 1
The 67-th residue of chain 0 has 2 residue contacts in chain 1
The 68-th residue of chain 0 has 6 residue contacts in chain 1
The 69-th residue of chain 0 has 14 residue contacts in chain 1
The 70-th residue of chain 0 has 16 residue contacts in chain 1
The 71-th residue of chain 0 has 13 residue contacts in chain 1
The 72-th residue of chain 0 has 32 residue contacts in chain 1
The 73-th residue of chain 0 has 32 residue contacts in chain 1
The 74-th residue of chain 0 has 21 residue contacts in chain 1
The 75-th residue of chain 0 has 15 residue contacts in chain 1
The 76-th residue of chain 0 has 9 residue contacts in chain 1
The 77-th residue of chain 0 has 3 residue contacts in chain 1
The 78-th residue of chain 0 has 5 residue contacts in chain 1
The 79-th residue of chain 0 has 14 residue contacts in chain 1
The 80-th residue of chain 0 has 7 residue contacts in chain 1
The 81-th residue of chain 0 has 2 residue contacts in chain 1
The 82-th residue of chain 0 has 9 residue contacts in chain 1
The 83-th residue of chain 0 has 11 residue contacts in chain 1
The 84-th residue of chain 0 has 2 residue contacts in chain 1
The 85-th residue of chain 0 has 1 residue contacts in chain 1
The 88-th residue of chain 0 has 2 residue contacts in chain 1
The 89-th residue of chain 0 has 2 residue contacts in chain 1
The 90-th residue of chain 0 has 2 residue contacts in chain 1
The 91-th residue of chain 0 has 2 residue contacts in chain 1
The 92-th residue of chain 0 has 6 residue contacts in chain 1
The 93-th residue of chain 0 has 4 residue contacts in chain 1
The 94-th residue of chain 0 has 7 residue contacts in chain 1
The 95-th residue of chain 0 has 7 residue contacts in chain 1
The 96-th residue of chain 0 has 1 residue contacts in chain 1
The 97-th residue of chain 0 has 3 residue contacts in chain 1
The 98-th residue of chain 0 has 10 residue contacts in chain 1
The 99-th residue of chain 0 has 14 residue contacts in chain 1
The 100-th residue of chain 0 has 4 residue contacts in chain 1
The 101-th residue of chain 0 has 5 residue contacts in chain 1
The 105-th residue of chain 0 has 2 residue contacts in chain 1
The 123-th residue of chain 0 has 1 residue contacts in chain 1
The 164-th residue of chain 0 has 1 residue contacts in chain 1
The 166-th residue of chain 0 has 1 residue contacts in chain 1
The 169-th residue of chain 0 has 4 residue contacts in chain 1
The 170-th residue of chain 0 has 3 residue contacts in chain 1
The 171-th residue of chain 0 has 1 residue contacts in chain 1
The 229-th residue of chain 0 has 1 residue contacts in chain 1
The 231-th residue of chain 0 has 3 residue contacts in chain 1
The 232-th residue of chain 0 has 2 residue contacts in chain 1
The 235-th residue of chain 0 has 1 residue contacts in chain 1
</pre></div></div>
</div>
<p>This information is usually represented as a contact map. If this is what you are looking for, you will probably find the next section more appropriate to your needs.</p>
</div>
</div>
<div class="section" id="Contact-maps">
<h2>Contact maps<a class="headerlink" href="#Contact-maps" title="Permalink to this headline">¶</a></h2>
<p>A contact map is a logic matrix where the element (i-th,j-th) is True if the distance between i-th and j-th is lower, or equal, than a certain threshold. The contact map is a common tool, simple but effective, used to represent structural motifs from the protein-protein interaface of the protein folding, for example. MolSysMT includes a method, based on <code class="docutils literal notranslate"><span class="pre">molsysmt.distance()</span></code>, to obtain contact maps: <code class="docutils literal notranslate"><span class="pre">molsysmt.contact_map()</span></code>. As such, <code class="docutils literal notranslate"><span class="pre">molsysmt.contact_map</span></code> inherits many input arguments
from <code class="docutils literal notranslate"><span class="pre">molsysmt.distance()</span></code>. Lets see a couple of examples in this section.</p>
<p>Lets get the contact map obtained with the threshold 1.2 nm and the CA atoms from the dimer found in the system with pdb id 1TCD:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[181]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">molecular_system</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span><span class="s1">&#39;mmtf:1TCD&#39;</span><span class="p">,</span> <span class="s1">&#39;molsysmt.MolSys&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[182]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">CA_atoms</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">molecular_system</span><span class="p">,</span> <span class="n">selection</span><span class="o">=</span><span class="s1">&#39;atom_name==&quot;CA&quot;&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[183]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">contact_map</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">contact_map</span><span class="p">(</span><span class="n">molecular_system</span><span class="p">,</span> <span class="n">selection_1</span><span class="o">=</span><span class="n">CA_atoms</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mf">1.2</span><span class="o">*</span><span class="n">unit</span><span class="o">.</span><span class="n">nanometers</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[184]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">contact_map</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[184]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([[[ True,  True,  True, ..., False, False, False],
        [ True,  True,  True, ..., False, False, False],
        [ True,  True,  True, ..., False, False, False],
        ...,
        [False, False, False, ...,  True,  True,  True],
        [False, False, False, ...,  True,  True,  True],
        [False, False, False, ...,  True,  True,  True]]])
</pre></div></div>
</div>
<p>Our molecular system has a single frame. That’s why the shape of the output is the following:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[185]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">contact_map</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[185]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(1, 497, 497)
</pre></div></div>
</div>
<p>Where 497 is the total number of CA atoms in our system:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[186]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="n">msm</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">molecular_system</span><span class="p">,</span> <span class="n">selection</span><span class="o">=</span><span class="s2">&quot;atom_name==&#39;CA&#39;&quot;</span><span class="p">,</span> <span class="n">n_atoms</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
497
</pre></div></div>
</div>
<p>Usually the contact map is represented as a plot. The structural motifs can be then easily identify:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[187]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">contact_map</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Greys&#39;</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/contents_Distances_289_0.png" src="../_images/contents_Distances_289_0.png" />
</div>
</div>
<p>The contact map can also be computed among elements from different sets. Lets get the contact map with the same threshold but this time between the CA atoms from both chains:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[188]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">CA_atoms_chain_0</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">molecular_system</span><span class="p">,</span> <span class="n">selection</span><span class="o">=</span><span class="s2">&quot;atom_name==&#39;CA&#39; and chain_index==0&quot;</span><span class="p">,</span> <span class="n">atom_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">CA_atoms_chain_1</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">molecular_system</span><span class="p">,</span> <span class="n">selection</span><span class="o">=</span><span class="s2">&quot;atom_name==&#39;CA&#39; and chain_index==1&quot;</span><span class="p">,</span> <span class="n">atom_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[189]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">contact_map</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">contact_map</span><span class="p">(</span><span class="n">molecular_system</span><span class="p">,</span> <span class="n">selection_1</span><span class="o">=</span><span class="n">CA_atoms_chain_0</span><span class="p">,</span> <span class="n">selection_2</span><span class="o">=</span><span class="n">CA_atoms_chain_1</span><span class="p">,</span>
                              <span class="n">threshold</span><span class="o">=</span><span class="mf">1.2</span><span class="o">*</span><span class="n">unit</span><span class="o">.</span><span class="n">nanometers</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[190]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">contact_map</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Greys&#39;</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/contents_Distances_293_0.png" src="../_images/contents_Distances_293_0.png" />
</div>
</div>
<p>The molecular system is homodimeric, thereby the interface is symmetric as it can see in this last plot.</p>
<p>Finnally, <code class="docutils literal notranslate"><span class="pre">molsysmt.contact_map()</span></code> can also work with atoms groups. Instead of getting the contact map between CA atoms, lets do it now with the geometric centers of the residues:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[191]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">atoms_in_residues_chain_0</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">molecular_system</span><span class="p">,</span> <span class="n">target</span><span class="o">=</span><span class="s1">&#39;group&#39;</span><span class="p">,</span>
                                    <span class="n">selection</span><span class="o">=</span><span class="s2">&quot;molecule_type==&#39;protein&#39; and chain_index==0&quot;</span><span class="p">,</span> <span class="n">atom_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">atoms_in_residues_chain_1</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">molecular_system</span><span class="p">,</span> <span class="n">target</span><span class="o">=</span><span class="s1">&#39;group&#39;</span><span class="p">,</span>
                                    <span class="n">selection</span><span class="o">=</span><span class="s2">&quot;molecule_type==&#39;protein&#39; and chain_index==1&quot;</span><span class="p">,</span> <span class="n">atom_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[192]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">contact_map</span> <span class="o">=</span> <span class="n">msm</span><span class="o">.</span><span class="n">contact_map</span><span class="p">(</span><span class="n">molecular_system</span><span class="p">,</span>
                              <span class="n">groups_of_atoms_1</span><span class="o">=</span><span class="n">atoms_in_residues_chain_0</span><span class="p">,</span> <span class="n">group_behavior_1</span><span class="o">=</span><span class="s1">&#39;geometric_center&#39;</span><span class="p">,</span>
                              <span class="n">groups_of_atoms_2</span><span class="o">=</span><span class="n">atoms_in_residues_chain_1</span><span class="p">,</span> <span class="n">group_behavior_2</span><span class="o">=</span><span class="s1">&#39;geometric_center&#39;</span><span class="p">,</span>
                              <span class="n">threshold</span><span class="o">=</span><span class="mf">1.2</span><span class="o">*</span><span class="n">unit</span><span class="o">.</span><span class="n">nanometers</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[193]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">contact_map</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Greys&#39;</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/contents_Distances_298_0.png" src="../_images/contents_Distances_298_0.png" />
</div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="PBC.html" class="btn btn-neutral float-right" title="Periodic Boundary Conditions" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="Geometrical_transformations.html" class="btn btn-neutral float-left" title="Geometrical transformations" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2020, UIBCDF Lab at the Mexico City Childrens Hospital Federico Gomez and authors

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>